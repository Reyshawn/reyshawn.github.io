<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>reyshawn.C</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://reyshawn.com/"/>
  <updated>2019-06-12T12:19:49.718Z</updated>
  <id>http://reyshawn.com/</id>
  
  <author>
    <name>Reyshawn</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Test for rss</title>
    <link href="http://reyshawn.com/2019/06/12/Test-for-rss/"/>
    <id>http://reyshawn.com/2019/06/12/Test-for-rss/</id>
    <published>2019-06-12T12:19:10.000Z</published>
    <updated>2019-06-12T12:19:49.718Z</updated>
    
    <content type="html"><![CDATA[<p>This is a test for rss output.</p><p>ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;This is a test for rss output.&lt;/p&gt;
&lt;p&gt;ğŸ˜†ğŸ˜†ğŸ˜†ğŸ˜†&lt;/p&gt;

      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>JSON Web Token çš„äº§ç”Ÿå’Œè®¤è¯</title>
    <link href="http://reyshawn.com/2019/06/12/JSON-Web-Token-%E7%9A%84%E4%BA%A7%E7%94%9F%E5%92%8C%E8%AE%A4%E8%AF%81/"/>
    <id>http://reyshawn.com/2019/06/12/JSON-Web-Token-çš„äº§ç”Ÿå’Œè®¤è¯/</id>
    <published>2019-06-12T05:49:07.000Z</published>
    <updated>2019-06-12T08:28:54.564Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Cookie-based-vs-Token-based"><a href="#Cookie-based-vs-Token-based" class="headerlink" title="Cookie-based vs Token-based"></a>Cookie-based vs Token-based</h2><p>æœ‰ä¸¤ç§è®¤è¯æ–¹å¼ï¼Œä¸€ç§æ˜¯åŸºäº cookie çš„è®¤è¯ï¼Œå¦ä¸€ç§æ˜¯åŸºäº token çš„è®¤è¯ã€‚åè€…å®ç°å¾€å¾€æ˜¯é€šè¿‡ JSON Web Token ï¼ˆä»¥ä¸‹ç®€ç§° JWTï¼‰å®ç°çš„ã€‚é¦–å…ˆè¦è¯´æ˜ä¸€ä¸‹ä¸¤ç§è®¤è¯æ–¹å¼çš„åŒºåˆ«ï¼š</p><p>cookie-based authentication çš„è®¤è¯æµç¨‹æ˜¯:</p><ol><li>ç”¨æˆ·å¡«å†™ credentialsï¼ŒåŒ…æ‹¬ç”¨æˆ·åï¼Œé‚®ç®±ï¼Œå¯†ç è¿™äº›å†…å®¹ï¼›</li><li>Server æœåŠ¡å™¨éªŒè¯è¿™äº› credentials æ˜¯å¦æ­£ç¡®ï¼Œå¦‚æœæ­£ç¡®ï¼Œåˆ™<strong>è®¤è¯æˆåŠŸ</strong>ï¼Œåˆ›å»ºä¸€ä¸ª session å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼›</li><li>å°†è¿™ä¸ª session çš„ session id å­˜å‚¨åœ¨æµè§ˆå™¨ç«¯çš„ cookie é‡Œï¼›</li><li>æ¥ä¸‹æ¥çš„æ¯ä¸€ä¸ªè¯·æ±‚ï¼Œéƒ½ä¼šå¸¦ç€è¿™ä¸ª session idï¼ŒServer åœ¨æ¥æ”¶è¯·æ±‚åä¹Ÿä¼šéªŒè¯ session id ä¸ session æ˜¯å¦åŒ¹é…ï¼›</li><li>ä¸€æ—¦ç”¨æˆ·ç™»å‡ºï¼Œclient ç«¯å’Œ server ç«¯çš„ session å‡è¢«æ‘§æ¯ï¼›</li></ol><p>token-based authentication:</p><ol><li>ç”¨æˆ·å¡«å†™ credentialsï¼ŒåŒ…æ‹¬ç”¨æˆ·åï¼Œé‚®ç®±ï¼Œå¯†ç ï¼›</li><li>Server æœåŠ¡å™¨éªŒè¯è¿™äº› credentials æ˜¯å¦æ­£ç¡®ï¼Œå¦‚æœ<strong>è®¤è¯æˆåŠŸ</strong>ï¼Œåˆ™è¿”å›ä¸€ä¸ª signed tokenï¼›</li><li>è¿™ä¸ª token ä¼šè¢«å­˜å‚¨åœ¨ client ç«¯ï¼Œå¤§éƒ¨åˆ†æ˜¯åœ¨ localStorageï¼Œä½†ä¹Ÿä¼šå­˜å‚¨åœ¨ session storage æˆ–æ˜¯ cookie é‡Œï¼›</li><li>æ¥ä¸‹æ¥çš„æ¯ä¸€ä¸ªè¯·æ±‚ï¼Œéƒ½ä¼šå¸¦ç€ token ä½œä¸ºé¢å¤–çš„ authentication ä¿¡æ¯ã€‚</li><li>Server æ”¶åˆ°è¯·æ±‚åï¼Œé¦–å…ˆ decode è¿™ä¸ª token å¹¶å¯¹ token é‡Œçš„ signature è¿›è¡ŒéªŒè¯ï¼›</li></ol><p><img src="/images/auto01.png" alt="auto01"></p><p>ä¸ºä»€ä¹ˆä¼šè¯´ token-based æ›´å¥½ï¼š</p><ol><li>statelessï¼Œä¹Ÿå°±æ˜¯ä¸éœ€è¦å†åœ¨ server ç«¯ä¿å­˜ä¸€ä»½çºªå½•ï¼Œä½† server ç«¯è¦ä¿å­˜ç”¨äºç­¾åæ—¶ç”¨çš„ã€Œsecret keyã€ï¼›</li><li>cookie å¯¹è·¨åŸŸ CORS æ“ä½œä¸å‹å¥½ï¼Œtoken åˆ™æ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼›</li></ol><a id="more"></a><h2 id="JWT-å¦‚ä½•äº§ç”Ÿçš„"><a href="#JWT-å¦‚ä½•äº§ç”Ÿçš„" class="headerlink" title="JWT å¦‚ä½•äº§ç”Ÿçš„"></a>JWT å¦‚ä½•äº§ç”Ÿçš„</h2><p>ä¸€æ¡å®Œæ•´çš„ JWT æ ¼å¼æ˜¯è¿™æ ·çš„ï¼š<code>header.payload.signature</code>ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼Œåˆ›å»ºä¸€ä¸ª JSON æ ¼å¼çš„ headerã€‚header é‡ŒåŒ…å«çš„ä¿¡æ¯éœ€è¦æœ‰è¿™ä¸ª JSON ä½¿ç”¨çš„ hash ç®—æ³•ï¼Œä¾‹å¦‚ï¼š</p><pre><code class="javascript">const header = {    typ: &quot;JWT&quot;,    alg: &quot;HS256&quot;}</code></pre><p><code>&quot;typ&quot;</code> å£°æ˜è¿™æ˜¯ä¸€ä¸ª JWTï¼Œ<code>&quot;alg&quot;</code> å£°æ˜æ‰€æœ‰æ˜¯ç”¨çš„ hash ç®—æ³•ï¼›</p><p>ç¬¬äºŒæ­¥ï¼Œåˆ›å»º payloadã€‚è¿™é‡Œçš„ payload å°±æ˜¯ä½ æƒ³åœ¨ JWT é‡Œå­˜å‚¨çš„ä»»ä½•æ•°æ®ä¿¡æ¯ï¼Œä½†æœ€å¥½ä¸è¦æŠŠæ•æ„Ÿä¿¡æ¯ï¼Œæ¯”å¦‚å¯†ç æ”¾åœ¨é‡Œé¢ï¼Œ</p><pre><code class="javascript">const payload = {    userId: &quot;b08f86af-35da-48f2-8fab-cef3904660bd&quot;}</code></pre><p>å¯¹äº JWT çš„ payloadï¼Œä¼šæœ‰ä¸€äº›æ ‡å‡†ï¼Œæ¯”å¦‚ <code>iss</code> ä»£è¡¨ issuerï¼Œ<code>sub</code> ä»£è¡¨ subjectï¼Œ<code>exp</code> ä»£è¡¨ expiration timeã€‚</p><p>ç¬¬ä¸‰æ­¥ï¼Œåˆ›å»º signature ç­¾åã€‚</p><pre><code class="javascript">const encodedHeader = Buffer.from(JSON.stringify(header)).toString(&#39;base64&#39;)const encodedPayload = Buffer.from(JSON.stringify(payload)).toString(&#39;base64&#39;)</code></pre><p>å°† header å’Œ payload éƒ½ä½¿ç”¨ base64 ç¼–ç ã€‚</p><pre><code class="javascript">const crypto = require(&#39;crypto&#39;)const jwtSecret = &#39;secretKey&#39;const signature = crypto.createHmac(&#39;sha256&#39;, jwtSecret).update(encodedHeader + &#39;.&#39; + encodedPayload).digest(&#39;base64&#39;)</code></pre><p>base64 ç¼–ç åçš„æ–‡æœ¬ä½¿ç”¨ <code>.</code> è¿æ¥ï¼Œå†è¿›è¡Œ hashï¼Œhash åçš„æ–‡æœ¬å†è¿›è¡Œ base64 ç¼–ç ã€‚</p><p>æœ€ç»ˆ JWT ä¸ºï¼š</p><pre><code class="javascript">const jwt = `${encodedHeader}.${encodedPayload}.${signature}`</code></pre><h2 id="JWT-çš„è®¤è¯"><a href="#JWT-çš„è®¤è¯" class="headerlink" title="JWT çš„è®¤è¯"></a>JWT çš„è®¤è¯</h2><blockquote><p>The <strong>very</strong> important thing to note here is that this token is signed by the HMACSHA256 algorithm, and the header and payload are Base64URL encoded, it is <strong>not</strong> encrypted. If I go to <a href="https://jwt.io/" target="_blank" rel="noopener">jwt.io</a>, paste this token and select the HMACSHA256 algorithm, I could decode the token and read its contents. Therefore, it should go without saying that sensitive data, such as passwords, should never be stored in the payload.</p><p>â€” <a href="https://dzone.com/articles/cookies-vs-tokens-the-definitive-guide" target="_blank" rel="noopener">Cookies vs. Tokens: The Definitive Guide</a></p></blockquote><p>ä¸€å®šè¦åŒºåˆ†è®¤è¯å’ŒåŠ å¯†ï¼ŒJWT ä¸ä¼šåŠ å¯†æ··æ·†æ•°æ®ã€‚å½“ç”¨æˆ·æˆåŠŸç™»å½•ï¼ŒæœåŠ¡å™¨ç«¯æŒ‰ç…§ä¸Šè¿°è¿‡ç¨‹ç”Ÿæˆä¸€æ¡ JWT è¿”å›ç»™äº†å®¢æˆ·ç«¯ã€‚å› ä¸º JWT æ¶‰åŠåˆ°äº†èº«ä»½è®¤è¯ï¼Œè¿˜æ˜¯å¾ˆæ•æ„Ÿçš„ï¼Œå®¢æˆ·ç«¯æŠŠè¿™ä¸ª JWT å­˜å‚¨åœ¨ <code>HttpOnly Cookie</code>ï¼Œä¸åŒäºä¼ ç»Ÿ cookieï¼Œæ ‡æœ‰ <code>HttpOnly</code> çš„ cookie åªèƒ½ç”± Server ç«¯è·å–ã€‚</p><p>ç™»å½•æˆåŠŸåï¼Œå½“éœ€è¦è¯·æ±‚æŸä¸ªéœ€è¦æƒé™çš„ api æˆ–æ˜¯è¿›å…¥æŸä¸ª route æ—¶ï¼Œclient ç«¯åœ¨å‘é€ request è¯·æ±‚å°±ä¼šæŠŠè¿™ä¸ª JWT ç¨å¸¦ç€ï¼Œé€šå¸¸æ˜¯åœ¨ <code>Authorization</code> é‡Œï¼Œä»¥ Bearer ä½œä¸ºå¼€å¤´ï¼š</p><pre><code class="yaml">Authorization: Bearer &lt;token&gt;</code></pre><p>æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼Œé¦–å…ˆéœ€è¦éªŒè¯è¿™ä¸ª tokenã€‚éªŒè¯ JWT åŒ…å«ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p><ol><li>éªŒè¯ JWT çš„æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼›</li><li>éªŒè¯ signature ç­¾åï¼›</li><li>éªŒè¯åœ¨ payload é‡Œçš„ standard claimsï¼›</li><li>éªŒè¯è®¸å¯æƒé™èŒƒå›´ï¼›</li></ol><p>åœ¨éªŒè¯ signature æ—¶ï¼Œå…·ä½“æ˜¯å…ˆä½¿ç”¨ base64 decode æ•´ä¸ª JWTï¼Œè·å¾— header å’Œ payload  çš„å†…å®¹ã€‚åœ¨ header é‡Œèƒ½æ‰¾åˆ° JWT ä½¿ç”¨çš„ hash ç®—æ³•ã€‚ä½¿ç”¨è¯¥ hash ç®—æ³•å’Œæœ¬æ¥å°±åœ¨æœåŠ¡å™¨ç«¯å­˜å‚¨çš„ secret key ï¼Œé‡å¤ä¸€éä¸Šé¢çš„æµç¨‹ï¼Œæ¯”è¾ƒç»“æœå’Œ JWT ä¸­çš„ signature æ˜¯å¦åŒ¹é…ã€‚</p><blockquote><p>The API needs to check if the algorithm, as specified by the JWT header (property <code>alg</code>), matches the one expected by the API. If not, the token is considered invalid and the request must be rejected.</p><p>To check if the signature matches the APIâ€™s expectations, you have to decode the JWT and retrieve the <code>alg</code> property of the JWT header.</p><p>Remember that the signature is created using the header and the payload of the JWT, a secret and the hashing algorithm being used (as specified in the header: HMAC, SHA256 or RSA). The way to verify it, depends on the hashing algorithm:</p><p>â€” <a href="https://auth0.com/docs/api-auth/tutorials/verify-access-token" target="_blank" rel="noopener">Verify Access Tokens for Custom APIs</a></p></blockquote><h2 id="åœ¨-express-é‡Œå®é™…åº”ç”¨"><a href="#åœ¨-express-é‡Œå®é™…åº”ç”¨" class="headerlink" title="åœ¨ express é‡Œå®é™…åº”ç”¨"></a>åœ¨ express é‡Œå®é™…åº”ç”¨</h2><p><a href="https://www.youtube.com/watch?v=7nafaH9SddU" target="_blank" rel="noopener">Node.js API Authentication With JWT</a></p><p>è¿™ä¸ªè§†é¢‘ step-by-step è®²è§£äº†å¦‚ä½•åœ¨ express é‡Œä½¿ç”¨ jsonwebtoken è¿™ä¸ª packageï¼Œä»¥ä¸‹æ˜¯æœ€ç»ˆå®Œæ•´ä»£ç ï¼š</p><pre><code class="javascript">const express = require(&#39;express&#39;);const jwt = require(&#39;jsonwebtoken&#39;);const app = express();app.get(&#39;/api&#39;, (req, res) =&gt; {  res.json({    messgae: &#39;welcome to the api&#39;  })});app.post(&#39;/api/posts&#39;, verifyToken, (req, res) =&gt; {  jwt.verify(req.token, &#39;secretkey&#39;, (err, authData) =&gt; {    if (err) {      res.sendStatus(403);    } else {      res.json({        message: &#39;post created ...&#39;,        authData      })    }  })})app.post(&#39;/api/login&#39;, (req, res) =&gt; {  // Mock user  const user = {    id: 1,    usernmae: &#39;brad&#39;,    email: &#39;brad@gamil.com&#39;  }  jwt.sign({user}, &#39;secretkey&#39;, (err, token) =&gt; {    res.json({      token    })  });});// Format of Token// Authorization: Bearer &lt;access_token&gt;// Verify Tokenfunction verifyToken(req, res, next) {  // Get auth header value;  const bearerHeader = req.headers[&#39;authorization&#39;];  // Check if bearer is undefined  if (typeof bearerHeader !== &#39;undefined&#39;) {    // Split at the space    const bearer = bearerHeader.split(&#39; &#39;);    // Get token from array    const bearerToken = bearer[1];    // Set the token    req.token = bearerToken;    // Next middleware    next();  } else {    // Forbidden    res.sendStatus(403);  }}app.listen(5000, () =&gt; console.log(&#39;server started on 5000&#39;))</code></pre><p>é€šè¿‡ <code>jwt.sign()</code> è¿›è¡Œç­¾åã€‚</p><p>å‡½æ•° <code>verifyToken</code>  ä»…ä»…æ˜¯ä½œä¸ºä¸€ä¸ª middleware å» retrieve header é‡Œçš„ tokenï¼Œå¹¶æŠŠå®ƒä¿å­˜åœ¨ <code>req.token</code>  é‡Œï¼Œå…·ä½“çš„è®¤è¯æ˜¯é€šè¿‡ <code>jwt.verify()</code> å®ç°çš„ã€‚</p><h2 id="HS256-vs-RS256"><a href="#HS256-vs-RS256" class="headerlink" title="HS256 vs RS256"></a>HS256 vs RS256</h2><p>å‰è€…æ˜¯å¯¹ç§°åŠ å¯†ï¼Œåªæœ‰ä¸€ä¸ª key å€¼ã€‚åè€… RS256 æ˜¯éå¯¹ç§°åŠ å¯†ï¼Œæœ‰ä¸€ä¸ª private key å’Œä¸€ä¸ª public keyã€‚ä¸Šæ–‡ä»…ä»…æåˆ°äº† HS256 çš„è®¤è¯è¿‡ç¨‹ï¼Œä½†å¦‚æœä½¿ç”¨éå¯¹ç§°åŠ å¯†ï¼ˆä¹Ÿæ›´æ¨èè¿™ç§æ–¹å¼ï¼‰æ¥ç”Ÿæˆ JWTï¼Œè®¤è¯æ—¶éœ€è¦ç”¨åˆ° JSON Web Key Setã€‚</p><blockquote><p>For <code>RS256</code>, the tenantâ€™s <a href="https://auth0.com/docs/jwks" target="_blank" rel="noopener">JSON Web Key Set (JWKS)</a> is used. Your tenantâ€™s JWKS is <code>https://YOUR_DOMAIN/.well-known/jwks.json</code>.</p></blockquote><p>é€šè¿‡ private key æ¥ç”Ÿæˆ JWTï¼Œå†é€šè¿‡ public key å¯¹ JWT è¿›è¡ŒéªŒè¯ã€‚åœ¨ä½¿ç”¨ RS256 éå¯¹ç§°åŠ å¯†æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³è±¡æœ‰ä¸¤ä¸ª Server ç«¯ï¼Œä¸€ä¸ªæ˜¯ Authentication Serverï¼Œè¿›è¡Œè®¤è¯ï¼Œå¹¶ä½¿ç”¨ private key äº§ç”Ÿ JWTã€‚å¦ä¸€ä¸ªæ˜¯ Application Serverï¼Œè·å¾—æ¥è‡ª  Authentication Server çš„ public keyï¼Œå¯ä»¥å¯¹ç»è¿‡Authentication Server äº§ç”Ÿçš„ JWT è¿›è¡ŒéªŒè¯ã€‚</p><p><img src="/images/auth02.png" alt="auth02"> </p><p>å‚è€ƒï¼š</p><ul><li><a href="https://jwt.io/introduction/" target="_blank" rel="noopener">Introduction to JSON Web Tokens</a></li><li><a href="https://dzone.com/articles/cookies-vs-tokens-the-definitive-guide" target="_blank" rel="noopener">Cookies vs. Tokens: The Definitive Guide</a></li><li><a href="https://flaviocopes.com/jwt/" target="_blank" rel="noopener">JSON Web Token (JWT) explained</a></li><li><a href="https://medium.com/vandium-software/5-easy-steps-to-understanding-json-web-tokens-jwt-1164c0adfcec" target="_blank" rel="noopener">5 Easy Steps to Understanding JSON Web Tokens (JWT)</a></li><li><a href="https://auth0.com/docs/api-auth/tutorials/verify-access-token" target="_blank" rel="noopener">Verify Access Tokens for Custom APIs</a></li><li><a href="https://auth0.com/docs/jwks" target="_blank" rel="noopener">JSON Web Key Set</a></li><li><a href="https://tools.ietf.org/html/rfc7519#section-7.2" target="_blank" rel="noopener">JSON Web Token (JWT)</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Cookie-based-vs-Token-based&quot;&gt;&lt;a href=&quot;#Cookie-based-vs-Token-based&quot; class=&quot;headerlink&quot; title=&quot;Cookie-based vs Token-based&quot;&gt;&lt;/a&gt;Cookie-based vs Token-based&lt;/h2&gt;&lt;p&gt;æœ‰ä¸¤ç§è®¤è¯æ–¹å¼ï¼Œä¸€ç§æ˜¯åŸºäº cookie çš„è®¤è¯ï¼Œå¦ä¸€ç§æ˜¯åŸºäº token çš„è®¤è¯ã€‚åè€…å®ç°å¾€å¾€æ˜¯é€šè¿‡ JSON Web Token ï¼ˆä»¥ä¸‹ç®€ç§° JWTï¼‰å®ç°çš„ã€‚é¦–å…ˆè¦è¯´æ˜ä¸€ä¸‹ä¸¤ç§è®¤è¯æ–¹å¼çš„åŒºåˆ«ï¼š&lt;/p&gt;
&lt;p&gt;cookie-based authentication çš„è®¤è¯æµç¨‹æ˜¯:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç”¨æˆ·å¡«å†™ credentialsï¼ŒåŒ…æ‹¬ç”¨æˆ·åï¼Œé‚®ç®±ï¼Œå¯†ç è¿™äº›å†…å®¹ï¼›&lt;/li&gt;
&lt;li&gt;Server æœåŠ¡å™¨éªŒè¯è¿™äº› credentials æ˜¯å¦æ­£ç¡®ï¼Œå¦‚æœæ­£ç¡®ï¼Œåˆ™&lt;strong&gt;è®¤è¯æˆåŠŸ&lt;/strong&gt;ï¼Œåˆ›å»ºä¸€ä¸ª session å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼›&lt;/li&gt;
&lt;li&gt;å°†è¿™ä¸ª session çš„ session id å­˜å‚¨åœ¨æµè§ˆå™¨ç«¯çš„ cookie é‡Œï¼›&lt;/li&gt;
&lt;li&gt;æ¥ä¸‹æ¥çš„æ¯ä¸€ä¸ªè¯·æ±‚ï¼Œéƒ½ä¼šå¸¦ç€è¿™ä¸ª session idï¼ŒServer åœ¨æ¥æ”¶è¯·æ±‚åä¹Ÿä¼šéªŒè¯ session id ä¸ session æ˜¯å¦åŒ¹é…ï¼›&lt;/li&gt;
&lt;li&gt;ä¸€æ—¦ç”¨æˆ·ç™»å‡ºï¼Œclient ç«¯å’Œ server ç«¯çš„ session å‡è¢«æ‘§æ¯ï¼›&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;token-based authentication:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç”¨æˆ·å¡«å†™ credentialsï¼ŒåŒ…æ‹¬ç”¨æˆ·åï¼Œé‚®ç®±ï¼Œå¯†ç ï¼›&lt;/li&gt;
&lt;li&gt;Server æœåŠ¡å™¨éªŒè¯è¿™äº› credentials æ˜¯å¦æ­£ç¡®ï¼Œå¦‚æœ&lt;strong&gt;è®¤è¯æˆåŠŸ&lt;/strong&gt;ï¼Œåˆ™è¿”å›ä¸€ä¸ª signed tokenï¼›&lt;/li&gt;
&lt;li&gt;è¿™ä¸ª token ä¼šè¢«å­˜å‚¨åœ¨ client ç«¯ï¼Œå¤§éƒ¨åˆ†æ˜¯åœ¨ localStorageï¼Œä½†ä¹Ÿä¼šå­˜å‚¨åœ¨ session storage æˆ–æ˜¯ cookie é‡Œï¼›&lt;/li&gt;
&lt;li&gt;æ¥ä¸‹æ¥çš„æ¯ä¸€ä¸ªè¯·æ±‚ï¼Œéƒ½ä¼šå¸¦ç€ token ä½œä¸ºé¢å¤–çš„ authentication ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;Server æ”¶åˆ°è¯·æ±‚åï¼Œé¦–å…ˆ decode è¿™ä¸ª token å¹¶å¯¹ token é‡Œçš„ signature è¿›è¡ŒéªŒè¯ï¼›&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;/images/auto01.png&quot; alt=&quot;auto01&quot;&gt;&lt;/p&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆä¼šè¯´ token-based æ›´å¥½ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;statelessï¼Œä¹Ÿå°±æ˜¯ä¸éœ€è¦å†åœ¨ server ç«¯ä¿å­˜ä¸€ä»½çºªå½•ï¼Œä½† server ç«¯è¦ä¿å­˜ç”¨äºç­¾åæ—¶ç”¨çš„ã€Œsecret keyã€ï¼›&lt;/li&gt;
&lt;li&gt;cookie å¯¹è·¨åŸŸ CORS æ“ä½œä¸å‹å¥½ï¼Œtoken åˆ™æ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼›&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://reyshawn.com/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>iPadOS ä½¿ç”¨ä½“éªŒ</title>
    <link href="http://reyshawn.com/2019/06/05/iPadOS-%E4%BD%BF%E7%94%A8%E4%BD%93%E9%AA%8C/"/>
    <id>http://reyshawn.com/2019/06/05/iPadOS-ä½¿ç”¨ä½“éªŒ/</id>
    <published>2019-06-05T03:25:19.000Z</published>
    <updated>2019-06-05T04:09:05.847Z</updated>
    
    <content type="html"><![CDATA[<p>ä»Šæ—©å®‰è£…äº† iPadOS Development Beta ç‰ˆæœ¬ï¼Œä½“éªŒäº†ä¸€ä¼šå„¿ã€‚å› ä¸ºä¸å¤ªæ•¢æ‹¿ mac å‡çº§ Catalinaï¼Œæ®è¯´æ–‡ä»¶ç³»ç»Ÿæ”¹æ‰äº†ã€‚ç›®å‰ mac ä¸å¤ªæ•¢å‡ï¼Œæ‰€ä»¥ Sidecar åŠŸèƒ½æš‚æ—¶è¿˜æ²¡åŠæ³•ä½“éªŒã€‚iPhone å˜åŒ–å…¶å®æ²¡é‚£ä¹ˆå¤§ï¼Œä¹Ÿå°±åªæœ‰ iPad å¯ä»¥å°è¯•äº†ã€‚æå‰åšå¥½å¤‡ä»½ï¼Œåœ¨è‹¹æœçš„å¼€å‘è€…å®˜ç½‘ <a href="https://developer.apple.com/support/beta-software/install-beta/" target="_blank" rel="noopener">Installing Apple Beta Software</a> ä¸‹è½½å®‰è£… Xcode betaï¼Œå®‰è£…å®Œæ¯•è¦æ‰“å¼€è¿è¡Œï¼Œè¿™æ ·åšçš„ç›®çš„æ˜¯å¸®åŠ© iTunes èƒ½å¤Ÿè¯†åˆ« iOS13ã€‚ä¸‹è½½ä½ æ‰€ä½¿ç”¨è®¾å¤‡çš„ ipsw æ–‡ä»¶ã€‚æˆ‘æ˜¯åœ¨<a href="https://www.udid.in/install-beta" target="_blank" rel="noopener">è¿™é‡Œ</a>ä¸‹è½½çš„ã€‚ç„¶ååœ¨ iTunes é‡Œæ›´æ–°å°±è¡Œäº†ï¼Œæ³¨æ„è¦æå‰åšå¥½å¤‡ä»½ã€‚</p><p>å…·ä½“çš„å®‰è£…æ•™ç¨‹ä¹Ÿå¯ä»¥å‚è€ƒè¿™ä¸ª <a href="https://www.youtube.com/watch?v=iPZ6eNc8BvU&amp;frags=pl%2Cwn" target="_blank" rel="noopener">YouTube è§†é¢‘</a>ã€‚</p><p>ä¸‹é¢æŒ‰ç…§ç»™æˆ‘å¸¦æ¥æƒŠå–œçš„é¡ºåºï¼Œæ¥ç®€å•è°ˆä¸€ä¸‹è¿™æ¬¡çš„ iPadOS / iOS13ã€‚</p><a id="more"></a><h2 id="Safari"><a href="#Safari" class="headerlink" title="Safari"></a>Safari</h2><h3 id="Always-Request-Desktop-Page"><a href="#Always-Request-Desktop-Page" class="headerlink" title="Always Request Desktop Page"></a>Always Request Desktop Page</h3><p>æ°¸è¿œè®¿é—®æ¡Œé¢ç½‘é¡µï¼Œè¿™å¯¹äºä½¿ç”¨ iPad è€Œè¨€æ˜¯å·¨å¤§çš„è¿›æ­¥ã€‚åœ¨ç”µè„‘ç«¯ï¼Œæ— è®ºæ˜¯ Safari æˆ–æ˜¯ Chromeï¼Œéƒ½å·²ç»æˆä¸ºäº†æ— æ¯”å¼ºå¤§çš„é€šç”¨å®¢æˆ·ç«¯ï¼Œgeneral clientï¼Œåœ¨æµè§ˆå™¨é‡Œå‡ ä¹å¯ä»¥åšä»»ä½•äº‹æƒ…ã€‚è€Œåœ¨ iPhone ä¸Šï¼Œè‹¹æœå¯¹äºç¬¬ä¸‰æ–¹æµè§ˆå™¨æœ‰å¾ˆå¤šé™åˆ¶ï¼Œå› æ­¤ï¼ŒåŸç”Ÿ Safari çš„å¢å¼ºå°±æ˜¾å¾—æ— æ¯”é‡è¦ã€‚è¿™è®© iPad å˜å¾—æ›´åƒæ˜¯ laptop äº†ã€‚ä¸ä»…å¦‚æ­¤ï¼š</p><ul><li>åœ¨ bilibili.com å¯ä»¥è°ƒæ•´æ›´é«˜æ¸…çš„åˆ†è¾¨ç‡ï¼›</li><li>å¯ä»¥åœ¨ repl.it ä¸Šåœ¨çº¿ coding äº†ï¼›</li></ul><p><img src="/images/repl.png" alt="repl"></p><p>bilibili çš„ iPad app æä¸ºéš¾ç”¨ã€‚è€Œåœ¨ä»¥å‰åœ¨ iPad ä¸Šä½¿ç”¨ Safari æµè§ˆ bilibiliï¼Œæ€»ä¼šè‡ªåŠ¨è·³åˆ°ç§»åŠ¨ç«¯é¡µé¢ï¼Œè€Œä¸”å¯æ¶çš„æ˜¯ç§»åŠ¨ç«¯ä»…æ”¯æŒ 240P çš„åˆ†è¾¨ç‡ã€‚å“ªæ€•ä½ åœ¨ share sheet é‡Œå» request desktop page ä¹Ÿä¸è¡Œã€‚è€Œåœ¨æ–°çš„ iOS13 é‡Œï¼Œä½¿ç”¨ Safari è¿›è¡Œæµè§ˆå°±å’Œç”µè„‘ç«¯ä¸€æ¨¡ä¸€æ ·ï¼Œä½“éªŒéå¸¸å‹å¥½ã€‚</p><p>ç†è®ºä¸Šï¼Œç°åœ¨çš„ iPadOS å¯ä»¥å¼€æ— æ•°ä¸ª Safari çª—å£ï¼Œä½†ç”±äºå†…å­˜é™åˆ¶ï¼Œåªèƒ½åŒæ—¶è¿è¡Œ 2-3 ä¸ª Safariï¼Œå¤šä½™çš„å°±ä¼šè¢«åå° kill æ‰ã€‚ç›®å‰ï¼Œåªæœ‰ 1T å®¹é‡çš„ iPad Pro æ­é…æœ‰ 6G RAM å†…å­˜ï¼Œå…¶ä½™ iPad Pro æ˜¯åªæœ‰ 4G RAMã€‚</p><p>å¯ä»¥é¢„è§çš„æ˜¯ï¼Œæœªæ¥ iPad äº§å“ä¹Ÿå°†é€æ¸åŠ å…¥æ›´å¤§çš„å†…å­˜ï¼Œä»¥æ­¤å®ç°åå°çš„å¤šä»»åŠ¡è¿è¡Œã€‚</p><h3 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h3><p>Safari ç»ˆäºæœ‰äº†åŸç”Ÿçš„ä¸‹è½½åŠŸèƒ½ã€‚å¯ä»¥åœ¨ Settings è®¾ç½®é‡Œé€‰æ‹©ä¸‹è½½ä¿å­˜çš„æ–‡ä»¶å¤¹ï¼Œå¯ä»¥ä¿å­˜åœ¨æœ¬åœ° On My iPadï¼Œæˆ–è€…æ˜¯ iCloud é‡Œã€‚è¿™å¯¹äºæ—¥å¸¸ä½¿ç”¨ï¼Œé€šè¿‡ http æˆ– ftp ä¸‹è½½ä¸€äº›æ–‡ä»¶èµ„æºå·²ç»è¶³å¤Ÿäº†ã€‚ä½†å¦‚æœæƒ³è¦ä½¿ç”¨ã€Œç£åŠ›é“¾ã€æˆ– bitTorrentï¼Œåœ¨ç›®å‰æˆ–å¯ä»¥æƒ³è±¡çš„æœªæ¥çš„ iOS ç³»ç»Ÿä¸­ï¼Œéƒ½ä¸å¤ªå¯èƒ½ã€‚</p><h2 id="æ‰‹åŠ¿äº¤äº’"><a href="#æ‰‹åŠ¿äº¤äº’" class="headerlink" title="æ‰‹åŠ¿äº¤äº’"></a>æ‰‹åŠ¿äº¤äº’</h2><p>æ‰‹åŠ¿äº¤äº’ä¸€ç›´æ˜¯ iPad æœ‰åˆ«äº Mac å’Œ iPhone çš„ä¸€ä¸ªæœ€é‡è¦ç‰¹å¾ã€‚</p><h3 id="æˆªå›¾-é•¿æˆªå›¾"><a href="#æˆªå›¾-é•¿æˆªå›¾" class="headerlink" title="æˆªå›¾ / é•¿æˆªå›¾"></a>æˆªå›¾ / é•¿æˆªå›¾</h3><p>ä¸¤ç§æˆªå›¾æ–¹å¼ï¼š</p><ol><li>power button + volume buttonï¼›</li><li>ä½¿ç”¨ Apple Pencil åœ¨å±å¹•å·¦ä¸‹è§’æˆ–å³ä¸‹è§’å‘ä¸Šæ‹‰ï¼›</li></ol><p>ç¬¬ä¸€ç§æ˜¯ä¸€ç›´ä»¥æ¥å¾ˆä¼ ç»Ÿçš„æˆªå›¾æ–¹å¼ã€‚ç¬¬äºŒç§å¾ˆæœ‰è¶£ï¼Œå¾ˆè‡ªç„¶ï¼Œæˆªå›¾ä¹‹åç›´æ¥è¿›å…¥ç¼–è¾‘é¡µé¢ã€‚</p><h3 id="æ–‡å­—é€‰å–é«˜äº®-å…‰æ ‡ç§»åŠ¨"><a href="#æ–‡å­—é€‰å–é«˜äº®-å…‰æ ‡ç§»åŠ¨" class="headerlink" title="æ–‡å­—é€‰å–é«˜äº® / å…‰æ ‡ç§»åŠ¨"></a>æ–‡å­—é€‰å–é«˜äº® / å…‰æ ‡ç§»åŠ¨</h3><p>åœ¨ä»¥å‰ï¼Œè¦æƒ³é€‰ä¸­æŸæ®µæ–‡å­—ï¼Œéœ€è¦åœ¨æƒ³è¦é€‰ä¸­çš„ä½ç½®ä¸Š touch ä¸¤ä¸‹æ‰ä¼šå‡ºç°å…‰æ ‡ã€‚åœ¨æ–°çš„ iOS 13 ä¸­ï¼Œè‹¹æœæŠŠè¿™ä¸ªæ“ä½œè¿›ä¸€æ­¥ç®€åŒ–ï¼Œæ›´åŠ æ¥è¿‘åœ¨æ¡Œé¢ç«¯çš„äº¤äº’é€»è¾‘ã€‚è€Œä»¥å‰çš„åŒå‡»ï¼Œæ˜¯é€‰ä¸­ä¸€ä¸ªè¯ï¼Œä¸‰å‡»æ˜¯é€‰ä¸­æ•´ä¸ªå¥å­ã€‚</p><h3 id="copy-paste"><a href="#copy-paste" class="headerlink" title="copy / paste"></a>copy / paste</h3><p>æˆ‘ä»¬åœ¨ç”µè„‘ç«¯ç¼–è¾‘æ–‡å­—ï¼Œä½¿ç”¨çš„å¾ˆå¤šçš„å¿«æ·é”®ä¾¿æ˜¯ cmd+c/cmd+vã€‚ç°åœ¨åœ¨ iPadï¼Œå¤åˆ¶æ˜¯ä¸‰æŒ‡ pinch ï¼ˆæåˆï¼‰ï¼Œç²˜è´´æ˜¯ä¸‰æŒ‡ spreadã€‚ç±»ä¼¼çš„æ‰‹åŠ¿åœ¨ mac ä¸Šå¾ˆå¸¸ç”¨ã€‚éœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼Œè¿™é‡Œæ‰‹åŠ¿æ“ä½œçš„å¤åˆ¶ç²˜è´´å¹¶ä¸ä»…ä»…é™äºæ–‡å­—ï¼Œå®ƒå¯ä»¥ç”¨äºæ‰€æœ‰å¯ä»¥è¿›è¡Œå¤åˆ¶ç²˜è´´çš„åœ°æ–¹ï¼Œæ¯”å¦‚æ–‡ä»¶ã€‚</p><p>é€šå¸¸å¦‚æœä½¿ç”¨é”®ç›˜ï¼Œcmd+c/cmd+v æ˜¯æ›´å¥½çš„æ–¹å¼ã€‚ä½†å¦‚æœåœ¨ files é‡Œæ•´ç†æ–‡ä»¶ï¼Œé¦–å…ˆå¤šé€‰ï¼Œå†åˆ©ç”¨æ‰‹åŠ¿è¿›è¡Œæ“ä½œï¼Œå°±éå¸¸æ–¹ä¾¿äº†ã€‚</p><h2 id="å¤–æ¥å­˜å‚¨"><a href="#å¤–æ¥å­˜å‚¨" class="headerlink" title="å¤–æ¥å­˜å‚¨"></a>å¤–æ¥å­˜å‚¨</h2><p>æ˜¯çš„ï¼Œç­‰äº†å¾ˆå¤šå¹´äº†ï¼ŒiPad ç»ˆäºå¯ä»¥å¤–æ¥é—ªå­˜äº†ã€‚è¿™é‡Œä¸ºä»€ä¹ˆå¼ºè°ƒæ˜¯é—ªå­˜ï¼Œå› ä¸ºæˆ‘åœ¨å‘å¸ƒä¼šä¸Šåªå¬åˆ°äº†è¯´ flash driveã€‚è€Œåœ¨æˆ‘è‡ªå·±çš„å®éªŒé‡Œï¼ŒexFAT æ ¼å¼çš„ flash drive å¯ä»¥å‡†ç¡®è¯»å–ï¼Œå—¯ï¼Œè¿™ç‚¹å’Œ mac æ˜¯ä¸€è‡´çš„ã€‚å› ä¸ºä¸€å®šä¼šæœ‰æ–‡ä»¶æ ¼å¼çš„å£å’åœ¨ã€‚ä½†æˆ‘ä½¿ç”¨æˆ‘çš„ APFS æ ¼å¼çš„å¤–æ¥æœºæ¢°ç¡¬ç›˜ï¼Œè¯»å–å¤±è´¥ï¼Œç”šè‡³å‡ºç°äº†ä¸€ä¸ª bugã€‚è¿™é‡Œè¦è¯´æ˜ä¸€ä¸‹ï¼Œæˆ‘çš„è¿™ä¸ªæœºæ¢°ç¡¬ç›˜è¢«åˆ†æˆäº†ä¸¤ä¸ªåŒºï¼Œä¸€ä¸ªç”¨ä½œ time machineï¼Œå¦ä¸€ä¸ªæ˜¯æ­£å¸¸å­˜å‚¨ã€‚ä½†è¿æ¥ iPad åï¼Œä¼¼ä¹è¯†åˆ«æˆäº† image ä»€ä¹ˆçš„ï¼Œè€Œä¸”å‡ºç°çš„å¤–æ¥å­˜å‚¨å›¾æ ‡å†ä¹Ÿæ¶ˆé™¤ä¸æ‰äº†ã€‚</p><p>ä¸æ¸…æ¥šå„ä½æœ‰æ²¡æœ‰è¿æ¥ APFS æ ¼å¼æœºæ¢°ç¡¬ç›˜æˆåŠŸçš„ã€‚</p><p><img src="/images/ipad files bug.png" alt="ipad files bug"></p><h2 id="UI-å˜åŒ–"><a href="#UI-å˜åŒ–" class="headerlink" title="UI å˜åŒ–"></a>UI å˜åŒ–</h2><p>è‹¹æœåœ¨æ¯ä¸€ä»£ç³»ç»Ÿé‡Œï¼Œå¯¹ UI è®¾è®¡éƒ½æœ‰ä¸€äº›ç»†å¾®çš„å˜åŒ–ã€‚æœ€æ˜æ˜¾çš„æ˜¯é¡¶éƒ¨é€‰é¡¹å¡</p><p><img src="/images/iOS13 tab 1.png" alt="iOS13 tab 1"></p><p><img src="/images/iOS13 tab 2.png" alt="iOS13 tab 2"></p><p><img src="/images/iOS13 tab 3.png" alt="iOS13 tab 3"></p><h2 id="å…³äº-iPad-çš„æœªæ¥"><a href="#å…³äº-iPad-çš„æœªæ¥" class="headerlink" title="å…³äº iPad çš„æœªæ¥"></a>å…³äº iPad çš„æœªæ¥</h2><ol><li>Files å’Œ Safari éƒ½ä¼šæŒç»­è¿›åŒ–ã€‚Files ä¼šåŠ å…¥æ›´ä¸°å¯Œçš„æ–‡ä»¶ç¼–è¾‘åŠŸèƒ½ï¼Œèƒ½å¤ŸåŸç”Ÿæ”¯æŒæ›´å¤šæ ¼å¼çš„æ–‡ä»¶ç›´æ¥åœ¨ Files è¯»å–ã€‚</li><li>ä¼šæœ‰ iPad Terminalï¼Œå¹¶ä¸”ä¼šæœ‰ä¸€æ•´å¥—çš„ iPad ä¸Šçš„æœ‰å…³ç¼–ç¨‹çš„ API åŠ editorã€‚</li><li>å†…å­˜ä¼šæ›´å¤šï¼Œå°†æ¥å¯ä»¥åå°å¤šä»»åŠ¡è¿è¡Œçš„æ•°é‡ä¼šå¢å¤šã€‚</li></ol><p>æœ€åï¼Œä» WWDC19 ç»“æŸåï¼Œå°±å¾ˆå¤šäººåœ¨è®¨è®º iPad ä¸Šçš„é¼ æ ‡ã€‚æˆ‘ä¹Ÿçœ‹äº†åˆ«äººåœ¨ iPad ä¸Šä½¿ç”¨é¼ æ ‡çš„æ¼”ç¤ºè§†é¢‘ã€‚æˆ‘èƒ½æƒ³åˆ°æ¯”è¾ƒå¥½çš„ä½¿ç”¨æ–¹å¼æ˜¯è¿›è¡Œ FPS æªæˆ˜æ¸¸æˆã€‚ä½†ç›®å‰æ¥çœ‹ï¼ŒiPad ä¸Šçš„é¼ æ ‡è¿˜ä»…ä»…æ˜¯æ¨¡æ‹Ÿæ‰‹æŒ‡æ“ä½œï¼Œè€Œä¸æ˜¯ç±»ä¼¼ Apple Pencil é‚£ç§æ›´ç²¾ç»†çš„æŒ‡é’ˆï¼Œè€Œä¸”ä¸æ”¯æŒæ»šè½®æ»šåŠ¨ï¼Œæ‰€ä»¥æ•´ä¸ªä¸‹æ¥ä½“éªŒå¹¶ä¸å¥½ã€‚æˆ‘ä¸ªäººæ˜¯å¾ˆå¤šå¹´éƒ½ä¸åœ¨ç”¨é¼ æ ‡äº†ï¼Œç”µè„‘ä¸Šä¸€ç›´ç”¨è§¦æ§æ¿ï¼Œä½“éªŒå¾ˆå¥½ã€‚æˆ‘ä¹Ÿä¸€ç›´è®¤ä¸ºï¼ŒiPad ä¸Šæœ€å¥½çš„ç²¾ç¡®è¾“å…¥æ–¹å¼æ˜¯ Apple Pencilã€‚è€Œé¼ æ ‡çš„ä½œç”¨ï¼Œæƒ³ä¸€æƒ³ï¼Œå®šä½å¯èƒ½æ˜¯å’Œç°åœ¨å·²ç»æ”¯æŒçš„ playstation controller æˆ– Xbox controller é‚£æ ·å§ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä»Šæ—©å®‰è£…äº† iPadOS Development Beta ç‰ˆæœ¬ï¼Œä½“éªŒäº†ä¸€ä¼šå„¿ã€‚å› ä¸ºä¸å¤ªæ•¢æ‹¿ mac å‡çº§ Catalinaï¼Œæ®è¯´æ–‡ä»¶ç³»ç»Ÿæ”¹æ‰äº†ã€‚ç›®å‰ mac ä¸å¤ªæ•¢å‡ï¼Œæ‰€ä»¥ Sidecar åŠŸèƒ½æš‚æ—¶è¿˜æ²¡åŠæ³•ä½“éªŒã€‚iPhone å˜åŒ–å…¶å®æ²¡é‚£ä¹ˆå¤§ï¼Œä¹Ÿå°±åªæœ‰ iPad å¯ä»¥å°è¯•äº†ã€‚æå‰åšå¥½å¤‡ä»½ï¼Œåœ¨è‹¹æœçš„å¼€å‘è€…å®˜ç½‘ &lt;a href=&quot;https://developer.apple.com/support/beta-software/install-beta/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Installing Apple Beta Software&lt;/a&gt; ä¸‹è½½å®‰è£… Xcode betaï¼Œå®‰è£…å®Œæ¯•è¦æ‰“å¼€è¿è¡Œï¼Œè¿™æ ·åšçš„ç›®çš„æ˜¯å¸®åŠ© iTunes èƒ½å¤Ÿè¯†åˆ« iOS13ã€‚ä¸‹è½½ä½ æ‰€ä½¿ç”¨è®¾å¤‡çš„ ipsw æ–‡ä»¶ã€‚æˆ‘æ˜¯åœ¨&lt;a href=&quot;https://www.udid.in/install-beta&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;è¿™é‡Œ&lt;/a&gt;ä¸‹è½½çš„ã€‚ç„¶ååœ¨ iTunes é‡Œæ›´æ–°å°±è¡Œäº†ï¼Œæ³¨æ„è¦æå‰åšå¥½å¤‡ä»½ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“çš„å®‰è£…æ•™ç¨‹ä¹Ÿå¯ä»¥å‚è€ƒè¿™ä¸ª &lt;a href=&quot;https://www.youtube.com/watch?v=iPZ6eNc8BvU&amp;amp;frags=pl%2Cwn&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;YouTube è§†é¢‘&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æŒ‰ç…§ç»™æˆ‘å¸¦æ¥æƒŠå–œçš„é¡ºåºï¼Œæ¥ç®€å•è°ˆä¸€ä¸‹è¿™æ¬¡çš„ iPadOS / iOS13ã€‚&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>é˜…è¯»æ‘˜è¦ | issues #1</title>
    <link href="http://reyshawn.com/2019/05/31/%E9%98%85%E8%AF%BB%E6%91%98%E8%A6%81-issues-1/"/>
    <id>http://reyshawn.com/2019/05/31/é˜…è¯»æ‘˜è¦-issues-1/</id>
    <published>2019-05-31T11:44:37.000Z</published>
    <updated>2019-05-31T12:04:09.194Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Complex-life-may-only-exist-because-of-millions-of-years-of-groundwork-by-ancient-fungi"><a href="#Complex-life-may-only-exist-because-of-millions-of-years-of-groundwork-by-ancient-fungi" class="headerlink" title="Complex life may only exist because of millions of years of groundwork by ancient fungi"></a><a href="https://news.ycombinator.com/item?id=20039980" target="_blank" rel="noopener">Complex life may only exist because of millions of years of groundwork by ancient fungi</a></h3><p>åœ¨ hacker news çœ‹åˆ°è¿™æ ·ä¸€åˆ™è¯„è®ºï¼šå¯¹äº Fermi paradox è´¹ç±³æ‚–è®ºçš„ä¸€ä¸ªè§£é‡Šï¼Œæ­»å»çš„æœ‰æœºç‰©é€šè¿‡æ•°ç™¾ä¸‡å¹´ï¼Œåœ¨è¿™ä¸ªæ˜Ÿçƒä¸Šå½¢æˆäº†ä¸°å¯Œçš„åŒ–çŸ³ç‡ƒæ–™ã€‚å› ä¸ºè¿™äº›çŸ³æ²¹åŒ–çŸ³èµ„æºçš„ä¸°å¯Œï¼Œæˆ‘ä»¬æ‰èƒ½è¿›å…¥å·¥ä¸šæ—¶ä»£ï¼Œæ‰èƒ½è¿›å…¥ç”µæ°”æ—¶ä»£ã€‚ä½†æœ‰äººåé©³ï¼Œå³ä½¿æ²¡æœ‰è¿™äº›åŒ–çŸ³ï¼Œä½†åªè¦å­˜åœ¨äº†ç”Ÿå‘½ï¼Œå°±ä¼šæœ‰èƒ½é‡æºï¼Œä¸ç®¡é‚£æ˜¯ä»€ä¹ˆï¼Œå°±èƒ½å¸®åŠ©æœºå™¨è¿è½¬ã€‚</p><h3 id="Why-specialization-can-be-a-downside-in-our-ever-changing-world"><a href="#Why-specialization-can-be-a-downside-in-our-ever-changing-world" class="headerlink" title="Why specialization can be a downside in our ever-changing world"></a><a href="https://www.theverge.com/2019/5/30/18563322/david-epstein-range-psychology-performance-skills-sports-career-advice-book-interview" target="_blank" rel="noopener">Why specialization can be a downside in our ever-changing world</a></h3><p>ä½œè€…è®¤ä¸ºä¸“ä¸šåŒ–ï¼Œ 10000 å°æ—¶ç†è®ºï¼Œæ›´å€¾å‘äºåœ¨ä¸€ä¸ª kind or simple çš„ç¯å¢ƒé‡Œå‘ç”Ÿã€‚è€Œäº‹å®å¤§å¤šæ•°äººæ‰€é¢ä¸´çš„ç¯å¢ƒéƒ½æ˜¯æå…¶å¤æ‚çš„ï¼Œ wicked ã€‚é‡ç”³äº†è¡ŒåŠ¨è¦ä¼˜å…ˆäºæ€è€ƒï¼Œå¹¶å¼•ç”¨äº† Herminia Ibarra çš„è¯ã€ŒWe learn who we are in practice, not in theoryã€ã€‚æœ€åï¼Œä»–è®¤ä¸ºè®©æˆ‘ä»¬é¿å…é™·å…¥è‡ªæˆ‘çš„ cognitive biases è®¤çŸ¥åè§çš„ï¼Œæ˜¯ã€Œscience curiosityã€ã€‚</p><a id="more"></a><h3 id="https-t-me-yifenshijie-2973"><a href="#https-t-me-yifenshijie-2973" class="headerlink" title="https://t.me/yifenshijie/2973"></a><a href="https://t.me/yifenshijie/2973" target="_blank" rel="noopener">https://t.me/yifenshijie/2973</a></h3><p><a href="https://twitter.com/Scholars_Stage/status/1099238789363294208" target="_blank" rel="noopener">T. Greer</a> ç”¨ä¸€æ•´æ¡ thread æ¥é˜è¿°ï¼Œä¸ºä»€ä¹ˆæ—§çš„ blog æ—¶ä»£æ˜¯ä¼šæ¯”ç°åœ¨çš„ twitterï¼Œredditï¼Œtumbler æ›´å¥½ï¼š</p><ul><li>blog æ›´ä¸“æ³¨å†…å®¹ï¼Œåè€…åªæœŸæœ›äºæŠŠç”¨æˆ·ç•™åœ¨è‡ªå·±çš„å¹³å°é‡Œï¼›</li><li>blog ä¼šå½¢æˆæ›´å°åˆ° communityï¼Œåè€…ï¼Œæ›´å¤§çš„å¹³å°ï¼ŒåŒè´¨åŒ–çš„å£°éŸ³ï¼Œè§‚ç‚¹ï¼›</li><li>blog æ˜¯å±äºä¸ªäººçš„ï¼Œåè€…å±äºå¹³å°ï¼Œéµä»å•†ä¸šå…¬å¸åˆ©ç›Šï¼Œç¤¾ä¼šä¸»æµä»·å€¼è§‚ï¼›</li></ul><p>æå¦‚ä¸€çœ‹åˆ°è¿™æ¡ thread åï¼Œ<a href="https://t.me/s/yifenshijie/2973" target="_blank" rel="noopener">åœæ­¢æ›´æ–°äº†ä»–åœ¨ telegram å¹³å°çš„ã€Œä¸€åˆ†ä¸–ç•Œã€</a>ï¼Œè®¤ä¸ºè¦çŸ¥è¡Œåˆä¸€ã€‚</p><h3 id="éœæ´›ç»´å…¹çš„æ¬ºéª—"><a href="#éœæ´›ç»´å…¹çš„æ¬ºéª—" class="headerlink" title="éœæ´›ç»´å…¹çš„æ¬ºéª—"></a><a href="https://blog.yitianshijie.net/2019/05/05/horowitz-the-deceiver/" target="_blank" rel="noopener">éœæ´›ç»´å…¹çš„æ¬ºéª—</a></h3><p>Horowitz  1965 å¹´åœ¨çº½çº¦å¡å†…åŸºéŸ³ä¹å…èˆå°æ¼”å‡ºæ—¶ï¼Œåœ¨ç¬¬äºŒä¹ç« ç»“å°¾å¤„å‡ºäº†äº›å°ç‘•ç–µï¼Œåæ¥æä¾›ç»™å”±ç‰‡å…¬å¸çš„æ˜¯ç¼–è¾‘è¿‡çš„ç‰ˆæœ¬ï¼ŒæŠŠç‘•ç–µå‰ªæ‰äº†ã€‚ç›´åˆ° 30 å¹´åï¼Œæ‰æŠŠ unedited ç‰ˆæœ¬æ”¾äº†å‡ºæ¥ã€‚</p><blockquote><p>Apple Music ä¸Šï¼Œ<a href="https://music.apple.com/us/album/fantasie-in-c-major-op-17-ii-m-c3-a4ssig-durchaus-energisch/205999185?i=206001029" target="_blank" rel="noopener">åœ¨è¿™é‡Œ</a>å¯ä»¥å¬åˆ°éŸ³ä¹ä¼šåå‡ºç‰ˆçš„å”±ç‰‡é‡Œçš„ç‰ˆæœ¬ï¼ˆä¿®è¿‡çš„ï¼Œä»ä¸ƒåˆ†äºŒç§’å¼€å§‹ï¼‰ï¼Œ<a href="https://music.apple.com/us/album/fantasie-in-c-major-op-17-ii-m-c3-a4ssig-durchaus-energisch/328340329?i=328340362" target="_blank" rel="noopener">è¿™é‡Œ</a>å¯ä»¥å¬åˆ°æ—¥åå‡ºç‰ˆçš„æœªä¿®ç‰ˆæœ¬ï¼ˆå³æ¼”å‡ºç°åœºç‰ˆæœ¬ï¼Œå‹‹ä¼¯æ ¼è¯´çš„ä¸¥é‡é”™è¯¯åœ¨ä¸ƒåˆ†åä¸€ç§’ï¼‰ã€‚</p></blockquote><p>ä»¥åŠè¿™é‡Œç»™å‡ºç½‘æ˜“äº‘éŸ³ä¹çš„é“¾æ¥ï¼Œæ–¹ä¾¿æ”¶å¬ã€‚<a href="https://music.163.com/#/song?id=405318766" target="_blank" rel="noopener">edited</a> &amp; <a href="https://music.163.com/#/song?id=1298480910" target="_blank" rel="noopener">unedited</a>ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;Complex-life-may-only-exist-because-of-millions-of-years-of-groundwork-by-ancient-fungi&quot;&gt;&lt;a href=&quot;#Complex-life-may-only-exist-because-of-millions-of-years-of-groundwork-by-ancient-fungi&quot; class=&quot;headerlink&quot; title=&quot;Complex life may only exist because of millions of years of groundwork by ancient fungi&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://news.ycombinator.com/item?id=20039980&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Complex life may only exist because of millions of years of groundwork by ancient fungi&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;åœ¨ hacker news çœ‹åˆ°è¿™æ ·ä¸€åˆ™è¯„è®ºï¼šå¯¹äº Fermi paradox è´¹ç±³æ‚–è®ºçš„ä¸€ä¸ªè§£é‡Šï¼Œæ­»å»çš„æœ‰æœºç‰©é€šè¿‡æ•°ç™¾ä¸‡å¹´ï¼Œåœ¨è¿™ä¸ªæ˜Ÿçƒä¸Šå½¢æˆäº†ä¸°å¯Œçš„åŒ–çŸ³ç‡ƒæ–™ã€‚å› ä¸ºè¿™äº›çŸ³æ²¹åŒ–çŸ³èµ„æºçš„ä¸°å¯Œï¼Œæˆ‘ä»¬æ‰èƒ½è¿›å…¥å·¥ä¸šæ—¶ä»£ï¼Œæ‰èƒ½è¿›å…¥ç”µæ°”æ—¶ä»£ã€‚ä½†æœ‰äººåé©³ï¼Œå³ä½¿æ²¡æœ‰è¿™äº›åŒ–çŸ³ï¼Œä½†åªè¦å­˜åœ¨äº†ç”Ÿå‘½ï¼Œå°±ä¼šæœ‰èƒ½é‡æºï¼Œä¸ç®¡é‚£æ˜¯ä»€ä¹ˆï¼Œå°±èƒ½å¸®åŠ©æœºå™¨è¿è½¬ã€‚&lt;/p&gt;
&lt;h3 id=&quot;Why-specialization-can-be-a-downside-in-our-ever-changing-world&quot;&gt;&lt;a href=&quot;#Why-specialization-can-be-a-downside-in-our-ever-changing-world&quot; class=&quot;headerlink&quot; title=&quot;Why specialization can be a downside in our ever-changing world&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://www.theverge.com/2019/5/30/18563322/david-epstein-range-psychology-performance-skills-sports-career-advice-book-interview&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Why specialization can be a downside in our ever-changing world&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;ä½œè€…è®¤ä¸ºä¸“ä¸šåŒ–ï¼Œ 10000 å°æ—¶ç†è®ºï¼Œæ›´å€¾å‘äºåœ¨ä¸€ä¸ª kind or simple çš„ç¯å¢ƒé‡Œå‘ç”Ÿã€‚è€Œäº‹å®å¤§å¤šæ•°äººæ‰€é¢ä¸´çš„ç¯å¢ƒéƒ½æ˜¯æå…¶å¤æ‚çš„ï¼Œ wicked ã€‚é‡ç”³äº†è¡ŒåŠ¨è¦ä¼˜å…ˆäºæ€è€ƒï¼Œå¹¶å¼•ç”¨äº† Herminia Ibarra çš„è¯ã€ŒWe learn who we are in practice, not in theoryã€ã€‚æœ€åï¼Œä»–è®¤ä¸ºè®©æˆ‘ä»¬é¿å…é™·å…¥è‡ªæˆ‘çš„ cognitive biases è®¤çŸ¥åè§çš„ï¼Œæ˜¯ã€Œscience curiosityã€ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="éŸ³ä¹" scheme="http://reyshawn.com/tags/%E9%9F%B3%E4%B9%90/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript async and Promise</title>
    <link href="http://reyshawn.com/2019/05/18/JavaScript-async-and-Promise/"/>
    <id>http://reyshawn.com/2019/05/18/JavaScript-async-and-Promise/</id>
    <published>2019-05-18T11:42:34.993Z</published>
    <updated>2019-05-18T13:47:39.158Z</updated>
    
    <content type="html"><![CDATA[<p>éå¸¸æ¨èå…ˆçœ‹ä¸€ä¸‹å‚è€ƒé“¾æ¥é‡Œä¸¤ä¸ª youtube è§†é¢‘ï¼Œåˆ†åˆ«ä»‹ç»äº† event loop å’Œ setTimeout çš„å®ç°åŸç†ï¼Œè¿™å¯¹äºç†è§£ JavaScript é‡Œå¼‚æ­¥æ“ä½œå®ç°éå¸¸æœ‰å¸®åŠ©ã€‚å…¶æ¬¡æ˜¯å…³äº Promise object çš„æ‰‹åŠ¨å®ç°ï¼Œæœ‰ä¸€äº›æŠ½è±¡ï¼Œå› ä¸ºåŒ…å«äº†å¤§é‡çš„  callback å‡½æ•°ã€‚è¿™é‡Œä¸€å®šè¦åˆ†æ¸…æ¥šï¼Œå“ªäº›æ˜¯å‡½æ•°çš„å£°æ˜ï¼Œå“ªäº›æ˜¯å‡½æ•°çš„è°ƒç”¨ã€‚</p><h2 id="Event-loop"><a href="#Event-loop" class="headerlink" title="Event loop"></a>Event loop</h2><p>JavaScript æ˜¯ä¸€ç§ single thread çš„è¯­è¨€ã€‚æ—¢ç„¶å•ä¸€çº¿ç¨‹ï¼Œé‚£ä¹ˆåœ¨æŸä¸ªæ—¶é—´ç‚¹ï¼Œåªèƒ½å®Œæˆä¸€é¡¹ä»»åŠ¡ã€‚äºæ˜¯</p><pre><code class="javascript">$.get(&#39;http://twitter.com&#39;)$.get(&#39;http://youtube.com&#39;)$.get(&#39;http://google.com&#39;)</code></pre><p>åœ¨å•çº¿ç¨‹ä¸‹ï¼Œå¦‚æœæŸä¸€è¡Œæ‰§è¡Œæ‰€éœ€è¦çš„æ—¶é—´å¤ªä¹…äº†ï¼Œé‚£ä¹ˆä½™ä¸‹çš„çš„ command ä¹Ÿæ— æ³•æ‰§è¡Œï¼Œç¨‹åºå°±åœ¨é‚£ä¸€è¡Œåœæ»ä¸‹æ¥äº†ã€‚æˆ‘ä»¬æŠŠè¿™ä¸ªå«åš blockingã€‚ç„¶è€Œäº‹å®ä¸Šï¼Œå½“æˆ‘ä»¬åœ¨ä½¿ç”¨ <code>setTimeout()</code> å‡½æ•°æ—¶ï¼Œç¨‹åºä¼¼ä¹ä¸ä¼šå‡ºç° blockingã€‚</p><pre><code class="Javascript">console.log(&#39;hi&#39;)setTimeout(() =&gt; console.log(&#39;there&#39;), 0)console.log(&#39;Welcome!&#39;)// output:// hi// Welcome// there</code></pre><p>è¿™é‡Œå“ªæ€•æ˜¯è®¾ç½® delay ä¸º 0sï¼Œ <code>setTimeout()</code> é‡Œçš„å‡½æ•°ä¹Ÿæ˜¯åœ¨æœ€åæ‰æ‰§è¡Œï¼Œæ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿ</p><p>åœ¨ JavaScript çš„æ‰§è¡Œç¯å¢ƒä¸­ï¼Œæ‰€æœ‰çš„éœ€è¦è¿è¡Œçš„å‡½æ•°æ˜¯å•çº¿ç¨‹çš„ï¼ŒæŒ‰ç…§æ¬¡åºä¼šå‡ºç°åœ¨ call stack é‡Œã€‚è€Œé€šå¸¸ï¼ŒJavaScript è¦ä¹ˆåœ¨ Browser é‡Œè¿è¡Œï¼Œè¦ä¹ˆåœ¨ Node ç¯å¢ƒè¿è¡Œï¼Œåœ¨ Browser é‡Œè¿è¡Œæ—¶ï¼Œä¼šæœ‰ä¸€æ•´å¥—æ¥è‡ª Browser æä¾›çš„ web APIï¼ŒåŒç†åœ¨ node ç¯å¢ƒé‡Œä¹Ÿæœ‰ç›¸åº”çš„ APIã€‚ <code>setTimeout()</code> å‡½æ•°å°±æ¥è‡ªè¿™äº›æä¾›çš„ API ä¸­ã€‚å½“æˆ‘ä»¬ declare and call  ä¸€ä¸ª  <code>setTimeout()</code> å‡½æ•°æ—¶ï¼ŒBrowser ä¼šç”Ÿæˆä¸€ä¸ª timer è®¡æ—¶å™¨ï¼Œè®¡æ—¶å™¨çš„æ—¶é—´è¾¾åˆ°æ—¶ï¼Œ  <code>setTimeout()</code>  é‡Œå®šä¹‰çš„ callback å‡½æ•°ä¼šè¿›å…¥åˆ°ä¸€ä¸ªå« <code>task queue</code> çš„å®¹å™¨ä¸­ï¼Œæ­¤æ—¶ç¨‹åºä¼šå»æ£€æµ‹ call stack æ˜¯å¦ä¸ºç©ºï¼Œå½“ call stack ä¸ºç©ºæ—¶ï¼Œä¼šå°† task queue ä¸­æœ€ä¸Šå±‚çš„å‡½æ•°ç§»å…¥ call stack ä¸­è¿›è¡Œæ‰§è¡Œã€‚å› æ­¤æœ¬è´¨ä¸Šæ¥è®²ï¼Œç”±äºæœ‰ web API çš„åŠ æŒï¼Œæœ€ç»ˆç±»ä¼¼  <code>setTimeout()</code> å‡½æ•°è¿˜æ˜¯ä½¿ç”¨äº†å¤šçº¿ç¨‹ã€‚åªä¸è¿‡å¯¹äº JavaScript æ¥è®²ï¼Œä¸€ç›´æ˜¯æ‰§è¡Œçš„æ˜¯ call stack é‡Œçš„å†…å®¹ï¼Œå¯ä»¥è®¤ä¸ºä¸€ç›´æ˜¯å•çº¿ç¨‹æ“ä½œã€‚</p><a id="more"></a><p><img src="/images/eventLoop.png" alt="Event Loop"></p><h2 id="Promise-çš„å®ç°"><a href="#Promise-çš„å®ç°" class="headerlink" title="Promise çš„å®ç°"></a>Promise çš„å®ç°</h2><p>Promise å’Œ   <code>setTimeout()</code> çš„åŒºåˆ«æ˜¯ï¼Œ<code>setTimeout()</code> æ˜¯ delay ä¸€ä¸ªç¡®å®šçš„æ—¶é—´ï¼Œæ¯”å¦‚ 3000msï¼Œ5000msï¼Œç„¶åæ‰§è¡Œ callback å‡½æ•°ã€‚Promise æœ¬èº«æ‰§è¡Œ callback çš„æ—¶é—´æ˜¯ä¸ç¡®å®šçš„ï¼Œåªæœ‰ resolve ä¹‹åæ‰ç®—æ‰§è¡Œå®Œæ¯•ï¼Œå› ä¸º resolve åä¼šæ”¹å˜ stateï¼Œæ¯”å¦‚ä» pending æ”¹å˜æˆ fulfilledï¼Œé€šè¿‡ <code>.then()</code> çš„æ–¹æ³•æ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ã€‚</p><blockquote><p>Timeouts and Promises serve different purposes.</p><p>setTimeout delays the execution of the code block by a specific time duration. Promises are an interface to allow async execution of code.</p><p>A promise allows code to continue executing while you wait for another action to complete. Usually this is a network call. So anything in your <code>then()</code> call will be executed once the network call (or whatever the promise is waiting for) is completed. The time difference between the start of the promise and the resolution of the promise entirely depends on what the promise is executing, and can change with every execution.</p><p>The reason the promise is executing before your timeout is that the promise isnâ€™t actually waiting for anything so it resolved right away.</p></blockquote><p>ä»¥ä¸‹æ˜¯æ¥è‡ª <a href="https://www.promisejs.org/implementing/" target="_blank" rel="noopener">Implementing</a>ï¼Œå¯¹äº Promise object çš„å®ç°ï¼š</p><p>æœ€å¥½çš„æ–¹å¼æ˜¯å°†ä¸‹é¢çš„ä»£ç ç²˜è´´è¿› editor é‡Œï¼Œè°ƒè¯•å‡ éã€‚ä¸å¤ªæ˜ç™½çš„åœ°æ–¹æ‰“ä¸Šæ–­ç‚¹ï¼Œæˆ–æ˜¯ <code>console.log()</code>ã€‚</p><pre><code class="javascript">let PENDING = 0;let FULFILLED = 1;let REJECTED = 2;function Promise(fn) {  // store state which can be PENDING, FULFILLED or REJECTED  let state = PENDING;  // store value or error once FULFILLED or REJECTED  let value = null;  // store sucess &amp; failure handlers attached by calling .then or .done  let handlers = [];  function fulfill(result) {    state = FULFILLED;    value = result;    handlers.forEach(handle);    handlers = null;  }  function reject(error) {    state = REJECTED;    value = error;    handlers.forEach(handle);    handlers = null;  }  function resolve(result) {    try {      let then = getThen(result);      if (then) {        doResolve(then.bind(result), resolve, reject);        return ;      }      fulfill(result)    } catch (e) {      reject(e);    }  }  function handle(handler) {    if (state === PENDING) {      handlers.push(handler);    } else {      if (state === FULFILLED &amp;&amp;        typeof handler.onFulfilled === &#39;function&#39;) {        handler.onFulfilled(value);      }      if (state === REJECTED &amp;&amp;        typeof handler.onRejected === &#39;function&#39;) {        handler.onRejected(value);      }    }  }  this.done = function (onFulfilled, onRejected) {    // ensure we are always asynchronous    setTimeout(function () {      console.log(&#39;instantly implemented âš ï¸&#39;)      handle({        onFulfilled: onFulfilled,        onRejected: onRejected      });    }, 0);  }  doResolve(fn, resolve, reject)  this.then = function (onFulfilled, onRejected) {    var self = this;    return new Promise(function (resolve, reject) {      return self.done(function (result) {        if (typeof onFulfilled === &#39;function&#39;) {          try {            return resolve(onFulfilled(result));          } catch (ex) {            return reject(ex);          }        } else {          return resolve(result);        }      }, function (error) {        if (typeof onRejected === &#39;function&#39;) {          try {            return resolve(onRejected(error));          } catch (ex) {            return reject(ex);          }        } else {          return reject(error);        }      });    });  }}function getThen(value) {  var t = typeof value;  if (value &amp;&amp; (t === &#39;object&#39; || t === &#39;function&#39;)) {    var then = value.then;    if (typeof then === &#39;function&#39;) {      return then;    }  }  return null;}function doResolve(fn, onFulfilled, onRejected) {  var done = false;  try {    fn(function (value) {      if (done) return      done = true      onFulfilled(value)    }, function (reason) {      if (done) return      done = true      onRejected(reason)    })  } catch (ex) {    if (done) return    done = true    onRejected(ex)  }}var promise1 = new Promise(function(resolve, reject) {  setTimeout(function() {    resolve(&#39;foo&#39;);  }, 3000);});promise1.then(function(value) {  console.log(value)  // expected output: &quot;foo&quot;});console.log(promise1);</code></pre><p><img src="/images/Promise.png" alt="Promise"></p><p>ä¸€äº›å¸®åŠ©ç†è§£è¿™æ®µä»£ç çš„å° tipsï¼š</p><ol><li><code>doResolve()</code> ï¼Œç¬¬ä¸€ï¼Œä¼šç›´æ¥æ‰§è¡Œ <code>fn</code> å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å£°æ˜ Promise æ—¶ä¼ é€’çš„ callback å‡½æ•°ã€‚ç¬¬äºŒï¼Œ ä¿è¯ <code>resolve</code> æˆ–æ˜¯ <code>reject</code> function ä»…æ‰§è¡Œä¸€æ¬¡ã€‚</li><li>æ¯æ¬¡å£°æ˜ Promise objectï¼Œéƒ½ä¼šå…ˆæ‰§è¡Œä¸€æ¬¡ <code>doResolve()</code> å‡½æ•°ï¼›</li><li><code>.then()</code> è¿”å›ä¸€ä¸ªæ–°çš„ Promise objectï¼Œè¿™ä¸ª Promise ä¼šæ‰§è¡Œ <code>doResolve()</code>  å‡½æ•°ï¼Œä»è€Œä¼šç›´æ¥æ‰§è¡Œè¿™ä¸ªæ–° Promise çš„ callback å‡½æ•°ï¼›line 73 - line 93ï¼Œæ‰§è¡Œ callback å‡½æ•°è¿”å›çš„æ˜¯ <code>self.done()</code> å‡½æ•°çš„æ‰§è¡Œç»“æœï¼›</li><li><code>.done()</code> æ–¹æ³•ä¼š check state çš„å€¼ï¼Œç¡®å®šæ˜¯å¦å°† <code>resolve</code> æ·»åŠ è¿› <code>handlers</code> ä¸­ï¼›</li><li><code>resolve</code> å‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œå°† <code>state</code> ä» <code>PENDING</code> æ”¹ä¸ºäº† <code>FULFILLED</code>ï¼ŒåŒæ—¶ <code>handlers.forEach(handle)</code> ä¾æ¬¡æ‰§è¡Œ <code>.then</code> æ–¹æ³•ä¸­æ·»åŠ è¿›å»çš„å‡½æ•°ã€‚</li><li><code>resolve</code> å’Œ <code>reject</code> éƒ½ä¼šå°†å€¼èµ‹ç»™ <code>value</code> å˜é‡ï¼›</li><li><code>setTimeout(cb, 0)</code> ä½¿ç”¨äº†ä¸Šè¿°æåˆ°çš„ event loopï¼Œæ­¤æ—¶ <code>cb</code> ä¼šåœ¨å‡ ä¹ 0ms çš„é—´éš”æ—¶é—´åï¼Œè¿›å…¥ task queueã€‚</li></ol><p>å‚è€ƒé“¾æ¥ï¼š</p><ul><li><a href="https://www.youtube.com/watch?v=8aGhZQkoFbQ&amp;list=LLhaQJ_wSNai6JEl8bBjymqA&amp;index=3&amp;t=0s" target="_blank" rel="noopener">What the heck is the event loop anyway? | Philip Roberts | JSConf EU</a></li><li><p><a href="https://www.youtube.com/watch?v=PoRJizFvM7s&amp;list=LLhaQJ_wSNai6JEl8bBjymqA&amp;index=2&amp;t=0s" target="_blank" rel="noopener">Async JS Crash Course - Callbacks, Promises, Async Await</a></p></li><li><p><a href="https://www.promisejs.org/implementing/" target="_blank" rel="noopener">Implementing</a></p></li><li><p><a href="https://stackoverflow.com/questions/23772801/basic-javascript-promise-implementation-attempt" target="_blank" rel="noopener">Basic Javascript promise implementation attempt</a></p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;éå¸¸æ¨èå…ˆçœ‹ä¸€ä¸‹å‚è€ƒé“¾æ¥é‡Œä¸¤ä¸ª youtube è§†é¢‘ï¼Œåˆ†åˆ«ä»‹ç»äº† event loop å’Œ setTimeout çš„å®ç°åŸç†ï¼Œè¿™å¯¹äºç†è§£ JavaScript é‡Œå¼‚æ­¥æ“ä½œå®ç°éå¸¸æœ‰å¸®åŠ©ã€‚å…¶æ¬¡æ˜¯å…³äº Promise object çš„æ‰‹åŠ¨å®ç°ï¼Œæœ‰ä¸€äº›æŠ½è±¡ï¼Œå› ä¸ºåŒ…å«äº†å¤§é‡çš„  callback å‡½æ•°ã€‚è¿™é‡Œä¸€å®šè¦åˆ†æ¸…æ¥šï¼Œå“ªäº›æ˜¯å‡½æ•°çš„å£°æ˜ï¼Œå“ªäº›æ˜¯å‡½æ•°çš„è°ƒç”¨ã€‚&lt;/p&gt;
&lt;h2 id=&quot;Event-loop&quot;&gt;&lt;a href=&quot;#Event-loop&quot; class=&quot;headerlink&quot; title=&quot;Event loop&quot;&gt;&lt;/a&gt;Event loop&lt;/h2&gt;&lt;p&gt;JavaScript æ˜¯ä¸€ç§ single thread çš„è¯­è¨€ã€‚æ—¢ç„¶å•ä¸€çº¿ç¨‹ï¼Œé‚£ä¹ˆåœ¨æŸä¸ªæ—¶é—´ç‚¹ï¼Œåªèƒ½å®Œæˆä¸€é¡¹ä»»åŠ¡ã€‚äºæ˜¯&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;javascript&quot;&gt;$.get(&amp;#39;http://twitter.com&amp;#39;)
$.get(&amp;#39;http://youtube.com&amp;#39;)
$.get(&amp;#39;http://google.com&amp;#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åœ¨å•çº¿ç¨‹ä¸‹ï¼Œå¦‚æœæŸä¸€è¡Œæ‰§è¡Œæ‰€éœ€è¦çš„æ—¶é—´å¤ªä¹…äº†ï¼Œé‚£ä¹ˆä½™ä¸‹çš„çš„ command ä¹Ÿæ— æ³•æ‰§è¡Œï¼Œç¨‹åºå°±åœ¨é‚£ä¸€è¡Œåœæ»ä¸‹æ¥äº†ã€‚æˆ‘ä»¬æŠŠè¿™ä¸ªå«åš blockingã€‚ç„¶è€Œäº‹å®ä¸Šï¼Œå½“æˆ‘ä»¬åœ¨ä½¿ç”¨ &lt;code&gt;setTimeout()&lt;/code&gt; å‡½æ•°æ—¶ï¼Œç¨‹åºä¼¼ä¹ä¸ä¼šå‡ºç° blockingã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;Javascript&quot;&gt;console.log(&amp;#39;hi&amp;#39;)
setTimeout(() =&amp;gt; console.log(&amp;#39;there&amp;#39;), 0)
console.log(&amp;#39;Welcome!&amp;#39;)

// output:
// hi
// Welcome
// there
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™é‡Œå“ªæ€•æ˜¯è®¾ç½® delay ä¸º 0sï¼Œ &lt;code&gt;setTimeout()&lt;/code&gt; é‡Œçš„å‡½æ•°ä¹Ÿæ˜¯åœ¨æœ€åæ‰æ‰§è¡Œï¼Œæ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;åœ¨ JavaScript çš„æ‰§è¡Œç¯å¢ƒä¸­ï¼Œæ‰€æœ‰çš„éœ€è¦è¿è¡Œçš„å‡½æ•°æ˜¯å•çº¿ç¨‹çš„ï¼ŒæŒ‰ç…§æ¬¡åºä¼šå‡ºç°åœ¨ call stack é‡Œã€‚è€Œé€šå¸¸ï¼ŒJavaScript è¦ä¹ˆåœ¨ Browser é‡Œè¿è¡Œï¼Œè¦ä¹ˆåœ¨ Node ç¯å¢ƒè¿è¡Œï¼Œåœ¨ Browser é‡Œè¿è¡Œæ—¶ï¼Œä¼šæœ‰ä¸€æ•´å¥—æ¥è‡ª Browser æä¾›çš„ web APIï¼ŒåŒç†åœ¨ node ç¯å¢ƒé‡Œä¹Ÿæœ‰ç›¸åº”çš„ APIã€‚ &lt;code&gt;setTimeout()&lt;/code&gt; å‡½æ•°å°±æ¥è‡ªè¿™äº›æä¾›çš„ API ä¸­ã€‚å½“æˆ‘ä»¬ declare and call  ä¸€ä¸ª  &lt;code&gt;setTimeout()&lt;/code&gt; å‡½æ•°æ—¶ï¼ŒBrowser ä¼šç”Ÿæˆä¸€ä¸ª timer è®¡æ—¶å™¨ï¼Œè®¡æ—¶å™¨çš„æ—¶é—´è¾¾åˆ°æ—¶ï¼Œ  &lt;code&gt;setTimeout()&lt;/code&gt;  é‡Œå®šä¹‰çš„ callback å‡½æ•°ä¼šè¿›å…¥åˆ°ä¸€ä¸ªå« &lt;code&gt;task queue&lt;/code&gt; çš„å®¹å™¨ä¸­ï¼Œæ­¤æ—¶ç¨‹åºä¼šå»æ£€æµ‹ call stack æ˜¯å¦ä¸ºç©ºï¼Œå½“ call stack ä¸ºç©ºæ—¶ï¼Œä¼šå°† task queue ä¸­æœ€ä¸Šå±‚çš„å‡½æ•°ç§»å…¥ call stack ä¸­è¿›è¡Œæ‰§è¡Œã€‚å› æ­¤æœ¬è´¨ä¸Šæ¥è®²ï¼Œç”±äºæœ‰ web API çš„åŠ æŒï¼Œæœ€ç»ˆç±»ä¼¼  &lt;code&gt;setTimeout()&lt;/code&gt; å‡½æ•°è¿˜æ˜¯ä½¿ç”¨äº†å¤šçº¿ç¨‹ã€‚åªä¸è¿‡å¯¹äº JavaScript æ¥è®²ï¼Œä¸€ç›´æ˜¯æ‰§è¡Œçš„æ˜¯ call stack é‡Œçš„å†…å®¹ï¼Œå¯ä»¥è®¤ä¸ºä¸€ç›´æ˜¯å•çº¿ç¨‹æ“ä½œã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://reyshawn.com/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>èµ¤çƒ› - ã€è¿˜æ„¿ã€</title>
    <link href="http://reyshawn.com/2019/02/21/%E8%B5%A4%E7%83%9B%20-%20%E3%80%8E%E8%BF%98%E6%84%BF%E3%80%8F/"/>
    <id>http://reyshawn.com/2019/02/21/èµ¤çƒ› - ã€è¿˜æ„¿ã€/</id>
    <published>2019-02-21T08:24:34.698Z</published>
    <updated>2019-02-23T03:18:14.548Z</updated>
    
    <content type="html"><![CDATA[<p>ã€è¿˜æ„¿ã€è¿™ä¸ªæ¸¸æˆï¼Œä»å»å¹´æ”¾å‡ºé¢„å‘Šå¼€å§‹ï¼Œæˆ‘å°±æœ‰å…³æ³¨ã€‚å»å¹´ 7 æœˆé‡Šå‡ºå…ˆå¯¼é¢„å‘Šï¼Œå†…å®¹æ˜¯å‡ æ”¯ 80 å¹´ä»£å¹¿å‘Šå’Œä¸€æ¡£ç«¥æ˜Ÿé€‰ç§€èŠ‚ç›®ã€‚éšååˆé™†ç»­é‡Šå‡ºä¸€äº›å›¾ç‰‡ï¼Œæ¯”å¦‚è´´æ»¡å¹¿å‘Šçš„å¤§é—¨çš„ç…§ç‰‡ã€‚å»çœ‹ç½‘ä¸Šå…³äºè¿™äº›é¢„å‘Šçš„åˆ†æï¼Œå‘ç°è¿™é‡Œä¸å…å¤¹æ‚äº†å‡¶æ€ã€åˆ†å°¸ã€æ‹œç¥ã€ç¥­ç¥€ç­‰ç­‰ææ€–æƒŠæ‚šçš„ã€Œå¥‡æƒ…ã€å…ƒç´ ã€‚è¿™äº›å†…å®¹ä¼šè®©äººè”æƒ³åˆ°ã€è¡€è§‚éŸ³ã€ï¼Œä¼šè”æƒ³åˆ° 93 å¹´çš„é¦™æ¸¯ç”µå½±ã€äººè‚‰å‰çƒ§åŒ…ã€ï¼Œæˆ–è€…æ˜¯15 å¹´ç¿å­å…‰å¯¼æ¼”æ‰§å¯¼çš„ã€è¸è¡€å¯»æ¢…ã€ã€‚è¿™ç±»ç”µå½±éƒ½å¯ä»¥å½’çº³ä¸ºã€Œå¥‡æƒ…ç‰‡ã€çš„æ¦‚å¿µï¼Œå®ƒä»¬å¾€å¾€ä¼šæ˜¯ä¸€äº›å‡¶æ€æ¡ˆä»¶ï¼Œå’Œæ™®é€šçš„çŠ¯ç½ªç‰‡ä¸åŒï¼ŒçŠ¯ç½ªæ‰‹æ®µé€šå¸¸éƒ½æ˜¯å‡¶ç‹ æ®‹å¿ï¼Œè€Œä¸”åŠ¨æœºéš¾ä»¥æ‰æ‘¸ã€‚</p><blockquote><p>å¥‡æƒ…ç”µå½±çš„èƒŒåå¾€å¾€è•´å«ç€å¯¹æ—¶å±€åŠ¨è¡ã€ç¤¾ä¼šä¸ç¨³å®šçš„ä¸€ç§æœ¬èƒ½æ€§çš„ææƒ§ã€‚è¦ä¹ˆç›´æ¥è¯‰è‹¦ï¼Œè¦ä¹ˆè½¬ç§»è§†çº¿ã€‚</p><p>â€“<a href="https://hardimage.pro/32" target="_blank" rel="noopener">ã€å¥‡å¼‚çš„â€¦â€¦ã€ Episode 32 - ç¡¬å½±åƒ</a></p></blockquote><p>ã€è¿˜æ„¿ã€åŒæ ·æ˜¯å…·æœ‰ã€Œå¥‡æƒ…ç‰‡ã€å†…æ ¸çš„ææ€–æ¸¸æˆã€‚</p><p>ä»¥ä¸‹å†…å®¹æ¶‰åŠå‰§é€ã€‚</p><p>ã€è¿˜æ„¿ã€çš„æ•…äº‹èƒŒæ™¯è®¾å®šåœ¨ 80 å¹´ä»£çš„å°æ¹¾ã€‚æ•…äº‹çš„å™è¿°åœ¨ 1980 å¹´ï¼Œ1985 å¹´ï¼Œ1986 å¹´ä¸‰ä¸ªæ—¶é—´ç‚¹äº’ç›¸ç©¿æ¢­ï¼Œäº¤å‰å™äº‹ã€‚80 å¹´ä»£çš„å°æ¹¾ç©¶ç«Ÿå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ1979 å¹´æœ«å‘ç”Ÿäº†è½°åŠ¨ä¸€æ—¶çš„ã€Œç¾ä¸½å²›äº‹ä»¶ã€ã€‚</p><a id="more"></a><blockquote><p>ä»¥ç¾éº—å³¶é›œèªŒç¤¾æˆå“¡ç‚ºæ ¸å¿ƒçš„é»¨å¤–é‹å‹•äººå£«ï¼Œæ–¼12æœˆ10æ—¥çµ„ç¹”ç¾¤çœ¾é€²è¡ŒéŠè¡ŒåŠæ¼”è¬›ï¼Œè¨´æ±‚æ°‘ä¸»èˆ‡è‡ªç”±ï¼Œçµ‚çµé»¨ç¦å’Œæˆ’åš´ã€‚</p><p>â€¦</p><p>æ­¤äº‹ä»¶å°å°ç£å¾€å¾Œçš„æ”¿å±€ç™¼å±•æœ‰è‘—é‡è¦å½±éŸ¿ï¼Œå°ç£æ°‘çœ¾æ–¼ç¾éº—å³¶äº‹ä»¶å¾Œé–‹å§‹é—œå¿ƒå°ç£æ”¿æ²»ã€‚ä¹‹å¾Œåˆé™¸çºŒç™¼ç”Ÿæ—å®…è¡€æ¡ˆï¼ˆ1980ï¼‰ã€é™³æ–‡æˆå‘½æ¡ˆï¼ˆ1981ï¼‰ã€åŠ‰æ±Ÿå—å‘½æ¡ˆï¼ˆ1984ï¼‰æ’¼å‹•åœ‹éš›ç¤¾æœƒï¼Œä½¿åœ‹æ°‘é»¨æ”¿åºœä¸æ–·é­å—åœ‹éš›è¼¿è«–çš„å£“åŠ›ä»¥åŠé»¨å¤–å‹¢åŠ›çš„æŒ‘æˆ°ï¼Œä¹‹å¾Œåœ‹æ°‘é»¨æ¼¸æ¼¸ä¸å†ç¨±å‘¼é»¨å¤–äººå£«ç‚ºé‡å¿ƒé™°è¬€ä»½å­ï¼Œä¸¦é€æ¼¸æ”¾æ£„ä¸€é»¨å°ˆæ”¿çš„è·¯ç·šä»¥æ‡‰æ™‚å‹¢ï¼Œä¹ƒè‡³æ–¼è§£é™¤æŒçºŒ38å¹´çš„æˆ’åš´ã€é–‹æ”¾é»¨ç¦ã€å ±ç¦ã€‚ä¼´éš¨è‘—åœ‹æ°‘é»¨æ”¿åºœçš„è·¯ç·šè½‰å‘ï¼Œå°ç£ä¸»é«”æ„è­˜æ—¥ç›Šç¢ºç«‹ï¼Œåœ¨æ•™è‚²ã€æ–‡åŒ–ã€ç¤¾æœƒæ„è­˜ç­‰æ–¹é¢éƒ½æœ‰é‡å¤§è½‰è®Šã€‚</p><p>â€“wikipedia ç¾éº—å³¶äº‹ä»¶</p></blockquote><p>ã€Œç¾ä¸½å²›å†›äº‹å¤§å®¡ã€çš„åŒæ—¶ï¼Œ1980 å¹´ 2 æœˆ 28 æ—¥ï¼Œå‘ç”Ÿäº†éœ‡æƒŠå…¨å°æ¹¾çš„ã€Œæ—å®…è¡€æ¡ˆã€ã€‚2017 å¹´ä¸Šæ˜ çš„ç”µå½±ã€è¡€è§‚éŸ³ã€ï¼Œå…¶ä¸­çš„ä¸€äº›æƒ…èŠ‚å°±æ˜¯å–æäºã€Œæ—å®…è¡€æ¡ˆã€ï¼Œä¹Ÿè·å¾—äº† 54 å±Šé‡‘é©¬æœ€ä½³å½±ç‰‡ã€‚å›åˆ°æ¸¸æˆé‡Œï¼Œ1980 å¹´ 8 æœˆï¼Œåœ¨è¿™ä¸ªæ—¶é—´æœå®¶ä¸€å®¶äººæ¬å…¥æ¸¸æˆé‡Œçš„è¿™åº§ã€Œå‡¶å®…ã€ã€‚</p><p>æœ€å¼€å§‹çœ‹åˆ°ã€è¿˜æ„¿ã€é¢„å‘Šçš„æ—¶å€™ï¼Œå°±è”æƒ³åˆ°äº†ç”µå½±ã€è¡€è§‚éŸ³ã€ã€‚å› ä¸ºéƒ½æœ‰ç€å¾ˆå¤šç›¸ä¼¼çš„å…ƒç´ ï¼Œæ¯”å¦‚ã€Œå‡¶æ€ã€ã€ã€Œè§‚éŸ³ã€ã€ã€Œå·«æœ¯ã€ç­‰ç­‰ã€‚ä½†å®é™…<del>æ¸¸ç©</del>ï¼ˆçœ‹è¿‡ æ¸¸æˆç›´æ’­ï¼‰ä¹‹åï¼Œå…¶å®å·®åˆ«è¿˜æ˜¯å¾ˆå¤§çš„ã€‚ã€è¡€è§‚éŸ³ã€é‡Œæœ‰è¾ƒå¤šçš„æ”¿æ²»æ„å‘³ï¼Œã€è¿˜æ„¿ã€æ˜¯åœ¨å„ç§ææ€–ï¼Œå®—æ•™ï¼Œæ°‘ä¿—åŒ…è£¹ä¸‹ï¼Œè¿˜æ˜¯åªæ˜¯åœ¨è®²ä¸€ä¸ªå®¶åº­çš„å¥‡æƒ…æ•…äº‹ï¼Œæ ¼å±€æ›´å°ä¸€äº›ã€‚</p><p><img src="/images/Game/devotion.png" alt="devotion"></p><p>1980 å¹´åˆ° 1985 å¹´ã€1986 å¹´è¿™äº›å¹´ï¼Œå°æ¹¾ç»å†äº†ä»€ä¹ˆï¼Ÿå› ä¸º 1979 å¹´å°æ¹¾å’Œç¾å›½çš„æ–­äº¤ï¼Œå’Œã€Œç¾ä¸½å²›äº‹ä»¶ã€çš„å½±å“ï¼Œå°æ¹¾åœ¨æ”¿æ²»ä¸Šé€æ¸å˜å¾—æ°‘ä¸»å’Œå¼€æ”¾ï¼Œç»æµä¸ŠåŒæ ·ä¹Ÿæ˜¯è“¬å‹ƒå‘å±•ã€‚æ°‘ä¼—æœ‰äº†æ›´å¤šçš„å¨±ä¹æ´»åŠ¨ï¼Œçœ‹ç”µè§†ï¼Œè™½ç„¶å½“æ—¶å…¨å°æ¹¾åªæœ‰ä¸‰ä¸ªå°ï¼Œå¤§å®¶èƒ½çœ‹çš„ä¸œè¥¿å¾ˆå°‘ï¼Œæ‰€ä»¥æ¸¯å‰§ã€æ¥šç•™é¦™ã€å¼•è¿›ä¸€ä¸‹å­å°±èƒ½åœ¨å°æ¹¾åˆ›ä¸‹äº† 70% çš„æ”¶è§†ç‡çºªå½•ã€‚ã€äº”ç¯å¥–ã€æ˜¯å°è§†åˆ¶ä½œçš„ä¸€æ¡£ç»¼è‰ºé€‰ç§€èŠ‚ç›®ï¼Œæ’­å‡ºæ—¶é—´é•¿è¾¾ 33 å¹´ï¼Œä¹Ÿæ˜¯æ¸¸æˆé‡Œã€Œä¸ƒå½©æ˜Ÿèˆå°ã€çš„åŸå‹ã€‚é™¤äº†çœ‹ç”µè§†ä¹‹å¤–ï¼ŒèµŒåšä¹‹é£ä¹Ÿæ˜¯å°¤ä¸ºç››è¡Œï¼Œæ¯”å¦‚æ‰€è°“çš„ã€Œå¤§å®¶ä¹ã€ï¼Œå°±æ˜¯ 80 å¹´ä»£å°æ¹¾å¾ˆæµè¡Œçš„ä¸€ç§éæ³•èµŒåšæ–¹å¼ã€‚</p><blockquote><p>å°æ¹¾çš„å¨±ä¹å·¥ä¸š ï¼Œåœ¨ 20 ä¸–çºª 80 å¹´ä»£å¼€å§‹æœ‰äº†ä¸ªçˆ†å‘å¼çš„æˆé•¿ ã€‚å¯ä»¥è¯´ ï¼Œå¤§å®¶æœ‰äº†é’± ï¼Œå°±å¼€å§‹çˆ±å¬é¡é¡ä¹‹éŸ³ ã€‚</p><p>ç”µè§†å°ä¸‰å°éƒ½æœ‰è®¸å¤šçš„ç»¼è‰ºèŠ‚ç›®å‡ºç° ï¼Œå°¤å…¶æ˜¯æ˜ŸæœŸå…­åŠæ˜ŸæœŸå¤©æ™šä¸Š ï¼Œæ˜¯ç»¼è‰ºèŠ‚ç›®çš„ä¸»æˆ˜åœº ã€‚å½“æ—¶çš„è®¸å¤šä¸»æŒäººæˆ–è·‘é¾™å¥—çš„ ï¼Œç°åœ¨éƒ½å·²ç»æ˜¯ç»¼è‰ºç•Œçš„å¤§ä½¬ ã€‚ä¸è¿‡å½“æ—¶çš„ç»¼è‰ºèŠ‚ç›® ï¼Œåœ¨ä¸€é˜µæ¬¢ä¹è¿‡å ï¼Œä¸»æŒäººåŠæ¥å®¾ä»¬ä¸€å®šéƒ½ä¼šåˆå”±å‡ é¦– â€œå‡€åŒ–æ­Œæ›² â€ â€”â€”ä¸å¤–å°±æ˜¯é‚£äº› â€œè§‚å¿µæ­£ç¡® ã€æ„è¯†å¥åº· â€ ï¼Œé¼“å¹ä¹è§‚å‘ä¸Šäººç”Ÿè§‚çš„æ­Œæ›² ï¼Œå°±æ˜¯æ€•å¤§å®¶å¬å¤ªå¤šé¡é¡ä¹‹éŸ³å¯¼è‡´é£æ°”è´¥å ã€‚äºæ˜¯æ¯å½“èŠ‚ç›®ç»“æŸå‰ ï¼Œæˆ‘ä»¬å°±ä¼šçœ‹åˆ°æ‰€æœ‰å‚ä¸è¿™æ¬¡èŠ‚ç›®çš„è‰ºäººæ’æ’ç«™ ï¼Œåœ¨å„æ— çº¿ç”µè§†å°å¤§ä¹é˜Ÿçš„ä¼´å¥ä¸‹ ï¼Œä¸€èµ·åŒæ‰‹æ‰“æ‹å­ ï¼Œéšç€ä¼´å¥æ‘‡æ‘† ï¼Œä¸€èµ·é«˜å£°é½å”± â€œå‡€åŒ–æ­Œæ›² â€ ã€‚é—´å¥æ—¶ ï¼Œä¸»æŒäººè¿˜ä¼šé¡ºä¾¿æ„Ÿè°¢ä¸€ä¸‹æ‰€æœ‰æ¥å®¾ ï¼Œä»¥åŠç”± Ã— Ã— Ã—æŒ‡æŒ¥æ‰€é¢†å¯¼çš„ Ã—è§†å¤§ä¹é˜Ÿ ã€‚</p><p>â€“ã€æˆ‘ä»¬å°æ¹¾è¿™äº›å¹´ã€</p></blockquote><p>ä¹Ÿæ˜¯å—èµŒåšé£æ°”çš„å½±å“ï¼Œå‡ºç°äº†ã€Œæ±‚æ˜ç‰Œã€ã€‚æ€€ç€èƒ½ä»èµŒåšé‡Œä¸­å¥–å’Œå¤§æä¸€ç¬”çš„å¿ƒæ€ï¼Œå¾ˆå¤šäººå¸Œæœ›ä»ä¸€äº›æ— å…³çš„è‡ªç„¶ç°è±¡ï¼Œæˆ–æ˜¯æ±‚ç¥æ‹œä½›æ¥å¾—åˆ°ç¥æ˜çš„æš—ç¤ºã€‚ã€Œè¿·ä¿¡ã€åœ¨å½“æ—¶æˆä¸ºäº†å¾ˆæ™®éçš„ç°è±¡ï¼Œå…¶å®å³ä¾¿æ˜¯ç°åœ¨çš„ä¸­å›½å†œæ‘ï¼Œé€¢å¹´è¿‡èŠ‚ï¼Œä¸§è‘¬å«å¨¶ï¼Œå…¶ä¸­çš„è®¸å¤šç¹å¤çš„å½¢å¼å’Œè¯´æ³•ï¼Œåœ¨å¤–äººçœ‹æ¥ï¼Œä¹Ÿä¸è¿‡å°±æ˜¯è¿·ä¿¡ç½¢äº†ã€‚ä½†ä¹Ÿè¦æ‰¿è®¤ï¼Œã€Œè¿·ä¿¡ã€æ˜¯æ°‘ä¿—é‡Œé‡è¦çš„ç»„æˆéƒ¨åˆ†ï¼Œæ‰€æœ‰çš„ã€Œè¿·ä¿¡ã€ä¹Ÿéƒ½ä¸æ˜¯çªç„¶å‡ºç°çš„ï¼Œå®ƒéƒ½å’Œå½“æ—¶çš„ç¤¾ä¼šèƒŒæ™¯ï¼Œæ”¿æ²»ç¯å¢ƒï¼Œç»æµç¯å¢ƒï¼Œæ°‘ä¼—å¿ƒæ€æ°›å›´æ¯æ¯ç›¸å…³ã€‚æ¸¸æˆé‡Œæœ‰å¾ˆå¤šçš„å°æ¹¾ 80 å¹´ä»£ç¬¦å·ï¼Œæ—§ç”µè§†æœºï¼Œé€‰ç§€èŠ‚ç›®ï¼Œçº¢é¾™é±¼ï¼Œè§‚éŸ³åƒï¼Œéº»å°†ã€‚èµ¤çƒ›åœ¨ä¸€ä¸ªå°é—­ç©ºé—´é‡Œï¼Œé€è¿‡è¿™äº›ç¬¦å·ï¼Œå¸Œæœ›è¿˜åŸå‡ºä¸€ä¸ª 80 å¹´ä»£å°æ¹¾çš„çœŸå®ç¤¾ä¼šçŠ¶æ€ã€‚</p><blockquote><p>æ°‘çœ¾ç¯¤ä¿¡å¤§å®¶æ¨‚ä¸­çè™Ÿç¢¼æœƒå‡ºç¾æ–¼å„ç¨®è¶…è‡ªç„¶ç¾è±¡ä¸­ï¼Œç¨±ç‚ºã€Œæ˜ç‰Œã€ã€‚ä¸€æ™‚é–“ï¼Œã€Œæ±‚æ˜ç‰Œã€ä¹‹é¢¨å¹éå…¨è‡ºç£ã€‚æ°‘çœ¾ç´›ç´›æ¹§å…¥å¤§å°å»Ÿå®‡ã€é“è§€ã€é™°å»Ÿã€å¢³å¢“ï¼Œå‘ç¥ä½›ã€é¬¼é­‚æ±‚æ˜ç‰Œï¼Œç”šè‡³è†œæ‹œå„ç¨®ç‰©é«”å¦‚æ¨¹æœ¨ã€çŸ³é ­ç­‰ï¼Œå¸Œæœ›é€™äº›ç‰©é«”ä¸Šçš„ç²¾æ€ªå¯ä»¥æœ‰ç¥ç¤ºã€‚</p><p>â€“wikipedia å¤§å®¶æ¨‚ (è³­åš) </p></blockquote><p>å°±æ˜¯åœ¨è¿™æ ·ä¸€ä¸ªä¼´éšç€åŠ¨è¡ï¼Œæ°‘ä¸»ï¼Œå¼€æ”¾çš„ç¤¾ä¼šæ°›å›´ä¸‹ï¼Œå°æœç¾å¿ƒåœ¨è¿™æ–°å®¶é‡Œåº¦è¿‡äº†ä»–çš„ 5 å²åˆ° 11 å²çš„æ—¶å…‰ï¼Œä¹Ÿå°±æ˜¯ä» 1980 å¹´åˆ° 1987 å¹´ã€‚</p><p>çˆ¶äº²æœä¸°äºï¼Œæ˜¯ä¸€ä½å°æœ‰æˆå°±çš„ç¼–å‰§ï¼Œæ‹¿è¿‡å®å²›æ–‡è‰ºå¥–æœ€ä½³ç¼–å‰§ã€‚æ¯äº²å·©è‰èŠ³æœ¬æ˜¯ä¸€ä½ç”µå½±æ˜æ˜Ÿï¼Œåœ¨å«ç»™æœä¸°äºä¹‹åï¼Œå†³å®šæ¯å½±ï¼Œåœ¨å®¶åšå…¨èŒå¤ªå¤ªï¼Œæ“æŒå®¶åŠ¡ã€‚å¤«å¦»ä¿©åœ¨ 1975 å¹´ç”Ÿä¸‹æœç¾å¿ƒã€‚åœ¨æ­¤ä¹‹åï¼Œçˆ¶äº²æœä¸°äºçš„ç¼–å‰§äº‹ä¸šå´ä¸é‚£ä¹ˆä¸€å¸†é£é¡ºã€‚80 å¹´ä»£çš„å°æ¹¾æ­£åœ¨é€æ¸å˜å¾—å¼€æ”¾ï¼Œå› æ­¤å°‘æœ‰äººå†å»æ„¿æ„ç”¨æœä¸°äºé‚£æ ·ä¼ ç»Ÿçš„ï¼Œåˆ»æ¿çš„ï¼Œäº†æ— æ–°æ„çš„å‰§æœ¬ã€‚å‰§æœ¬å¤šæ¬¡è¢«æ‹’ã€‚äº‹ä¸šä¸Šçš„ä¸é¡ºåˆ©ä¹Ÿè®©æ•´ä¸ªå®¶åº­çš„ç»æµæƒ…å†µé™·å…¥æ³¥æ²¼ã€‚è¢«è¿«æŠ›å”®ç¥–å®…ï¼Œä¹Ÿè®¸æ˜¯å› ä¸ºä¾¿å®œï¼Œæ¬åˆ°äº†è¿™å¤„æ®è¯´å‘ç”Ÿè¿‡å‘½æ¡ˆçš„ã€Œå‡¶å®…ã€ã€‚ä¹”è¿æ–°å±…ï¼Œå°½ç®¡å®¶åº­ç»æµçŠ¶å†µå¹¶ä¸å¥½ï¼Œå–œå¥½é¢å­çš„çˆ¶äº²ä»ç„¶é‚€è¯·ä¼—å¤šäº²æœ‹å¥½å‹æ¥å®¶é‡Œåº†ç¥ã€‚æ¯äº²ä¸å¾—ä¸æ—©ä¸Šå››äº”ç‚¹èµ·æ¥å¼€å§‹è´­ç‰©ç½®åŠå‡†å¤‡ã€‚æ— è®ºæ€æ ·ï¼Œç»ˆäºæ˜¯åœ¨æ–°å®¶é‡Œå®‰é¡¿ä¸‹æ¥äº†ã€‚å¥³å„¿æœç¾å¿ƒï¼Œçˆ¶äº²æ¯äº²æœ€å¤§çš„å¸Œæœ›å°±æ˜¯è®©å¥¹åƒæ¯äº²ä¸€æ ·æˆä¸ºå¤§æ˜æ˜Ÿã€‚ä»å°å¼€å§‹ç»ƒç´ï¼Œå­¦å”±æ­Œã€‚</p><p>æ•…äº‹æ˜¯å¦‚ä½•æ…¢æ…¢èµ°å‘æ‚²å‰§çš„å‘¢ï¼Ÿå¤§æ¦‚ä»ä¸€å¼€å§‹ï¼Œä»çˆ¶äº²çš„ç¼–å‰§äº‹ä¸šä¸é¡ºï¼Œçˆ¶äº²çš„å¥½é¢å­ï¼Œå¤§ç”·å­ä¸»ä¹‰ï¼Œå°å»ºè¿·ä¿¡å¼€å§‹ï¼Œæ•…äº‹çš„ç»“å±€å°±å·²ç»ç¡®å®šäº†ã€‚æ¯•ç«Ÿã€Œäººæ˜¯å¾ˆéš¾æ”¹å˜çš„ã€ã€‚æŠ›å¼€æ¸¸æˆä¸­æ‰€æœ‰çš„ææ€–å…ƒç´ ï¼Œ jump scareï¼Œææ€–è°·ç†è®ºè¿™äº›å†…å®¹ã€‚å•çº¯å»çœ‹è¿™ä¸ªæ•…äº‹ï¼Œå»çœ‹è¿™ä¸€å®¶äººã€‚é™¤äº†ç¾å¿ƒä»¥å¤–çš„å…¶ä»–äººç‰©éƒ½å¤ªå¹³é¢æ‰å¹³äº†ã€‚çˆ¶äº²æœä¸°äºï¼Œæ‰¿æ‹…äº†æ‰€æœ‰çš„åé¢è§’è‰²çš„ä½œç”¨ï¼Œä»–å’Œä½•è€å¸ˆæˆä¸ºä¸€åˆ‡ç½ªè¡Œçš„å§‹ä½œä¿‘è€…ã€‚æ¸¸æˆä¸­æœ‰ä¸€äº›çˆ¶äº²ä¸å¥³å„¿çš„äº¤äº’ï¼Œæ¯”å¦‚æœ€æ¸©é¦¨çš„æ•…äº‹ä¹¦é‚£æ®µï¼Œæ‹ç…§ç‰‡é‚£ä¸€æ®µã€‚ä½†æ˜¯æ›´å¤šçš„æ¡¥æ®µéƒ½åœ¨å±•ç°è¿™ä¸ªçˆ¶äº²çš„è´Ÿé¢å½¢è±¡ï¼Œå†·æ¼ ï¼Œæ˜“æ€’ï¼Œè£…ç¥å¼„é¬¼æ±‚ç¥æ‹œä½›ã€‚çˆ¶äº²çš„å­˜åœ¨ï¼Œè¡ŒåŠ¨ï¼Œéƒ½æ˜¯åœ¨åŠªåŠ›åœ°æ¨åŠ¨æ•´ä¸ªæ•…äº‹çš„æˆå‰§å†²çªï¼Œä½†æœ‰æ—¶å€™è¿™æ ·åœ¨çˆ¶äº²èº«ä¸Šçš„ç¡¬è®¾å®šï¼Œç¼ºä¹å‰å› åæœçš„è¡Œä¸ºï¼Œä¹Ÿä¼šç¼ºå°‘è¯´æœåŠ›ã€‚å°¤å…¶æ˜¯æ•…äº‹çš„æœ€åï¼Œä¹Ÿå°±æ˜¯è¿™æ•…äº‹æœ€å¤§çš„æ‚²å‰§ï¼Œæ›´æ˜¯è§‰å¾—è¿™çˆ¶äº²æ„šç¬¨çš„éš¾ä»¥ç†å–»ï¼Œæ€ä¹ˆå°±ä¿¡äº†åˆ«äººçš„èƒ¡è¨€ä¹±è¯­å‘¢ï¼Œä½ æ˜æ˜è¿˜é‚£ä¹ˆçˆ±ä½ è‡ªå·±çš„å¥³å„¿ã€‚è¿™ä¸ªåœ°æ–¹ï¼Œæœ‰ç‚¹å„¿æ˜¯ç¼–å‰§ä¸ºäº†åˆ¶é€ è¿™ä¹ˆä¸€ä¸ªæ‚²å‰§è€Œä¸€å®šè¦è®©çˆ¶äº²é€‰æ‹©è¿™ä¹ˆåšã€‚æƒ…èŠ‚çš„å±•ç°ä¹Ÿéƒ½æ˜¯ä½•è€å¸ˆçš„ç”µè¯ï¼Œå•æ–¹é¢è®²è¿°ï¼Œè€Œçˆ¶äº²æœä¸°äºçš„å†…å¿ƒæ´»åŠ¨æ˜¯ç¼ºå¤±çš„ã€‚</p><p>æ¯äº²å·©è‰èŠ³ï¼Œæ‰¿æ‹…äº†æ¸¸æˆå¤§éƒ¨åˆ†çš„æƒŠå“ç‚¹ï¼Œä¹Ÿæ˜¯æ¸¸æˆé‡Œå”¯ä¸€çš„å¥³é¬¼æ‹…å½“ã€‚å¯¹äºæ¯äº²çš„ä¿¡æ¯ï¼Œæ¸¸æˆä¸­é€æ¼çš„å¾ˆå°‘ã€‚æˆ‘ä»¬åªçŸ¥é“å¥¹æ˜¯æ›¾ç»çš„ç”µå½±æ˜æ˜Ÿï¼Œå‘Šåˆ«å½±å›åå‹¤ä¿­æŒå®¶ã€‚åœ¨ 1986 å¹´å†³å®šå¤å‡ºï¼Œåœ¨ä¹‹åä¸‹è½ä¸æ˜ã€‚æ•…äº‹é‡Œå¯èƒ½å”¯ä¸€è®©äººå–œæ¬¢çš„ï¼Œå°±æ˜¯å°ç¾å¿ƒäº†ï¼Œå¿ƒç†æ´»åŠ¨åˆ»ç”»çš„ä¹Ÿå¾ˆå¤šã€‚æ‰€æœ‰å¤§äººçš„åˆ»ç”»éƒ½æ˜¯å¹³é¢çš„ï¼Œæ‰å¹³çš„ï¼Œå°±åƒæ¸¸æˆé‡Œå‡ºç°çš„çº¸äººä¸€æ ·ã€‚</p><p>æ•´ä½“æ¥çœ‹ï¼Œã€è¿˜æ„¿ã€ä»æ—§æ˜¯ä¸€æ­¥æ°´å¹³ä¸Šä¹˜çš„ææ€–æ¸¸æˆã€‚å°½ç®¡å€Ÿé‰´äº†ä¸å°‘ä¼˜ç§€çš„å‰ä½œï¼Œã€å¯‚é™å²­P.T.ã€çš„æ—¶ç©ºäº¤å‰ï¼Œã€è‰¾è¿ªèŠ¬å¥‡çš„è®°å¿†ã€ï¼ˆ(What Remains of Edith Finchï¼‰çš„ç”µå½±å™äº‹ã€‚ä½†ã€Œèµ¤çƒ›ã€æ¯•ç«Ÿæ˜¯ä¸€ä¸ªå°æ¹¾å›¢é˜Ÿï¼Œã€è¿˜æ„¿ã€æ˜¯ä¸€ä¸ªé—½å—æ–‡åŒ–èƒŒæ™¯çš„ä¸­æ–‡ä½œå“ã€‚å½“ä½ èƒ½æ— éšœç¢çš„é˜…è¯»å¢™ä¸Šå¼ è´´çš„å°å¹¿å‘Šï¼Œç”µè§†å¹¿å‘Šï¼ŒèƒŒæ™¯å½•éŸ³ï¼Œæ‰€è·çš„ä¿¡æ¯å’Œä½“éªŒéƒ½æ¯”ä½ å»ç©ä¸€æ¬¾æ¬§ç¾æ–‡åŒ–èƒŒæ™¯æ¸¸æˆå¤šå¾ˆå¤šï¼Œå…±é¸£ä¹Ÿä¼šæ›´å¤§ã€‚å°±å¥½åƒæˆ‘å»çœ‹ã€ç‰¯å²­è¡—å°‘å¹´æ€äººäº‹ä»¶ã€ï¼Œä¸€å®šæ€»èƒ½å¸¦ç»™æˆ‘æœ€å¤§çš„éœ‡æ’¼ä¸€æ ·ã€‚</p><p>å‚è€ƒ</p><ul><li><a href="https://hardimage.pro/32" target="_blank" rel="noopener">ã€å¥‡å¼‚çš„â€¦â€¦ã€ Episode 32 - ç¡¬å½±åƒ</a></li><li>ã€æˆ‘ä»¬å°æ¹¾è¿™äº›å¹´ã€</li><li><a href="https://www.youtube.com/watch?v=TsCok5DX8uA&amp;frags=pl%2Cwn" target="_blank" rel="noopener">é‚„é¡˜Devotion | ç©ä¹‹å‰å¿…çŸ¥çš„ä¸ƒå¤§æ°‘ä¿—æ–‡åŒ–çŸ¥è­˜AdamDD</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ã€è¿˜æ„¿ã€è¿™ä¸ªæ¸¸æˆï¼Œä»å»å¹´æ”¾å‡ºé¢„å‘Šå¼€å§‹ï¼Œæˆ‘å°±æœ‰å…³æ³¨ã€‚å»å¹´ 7 æœˆé‡Šå‡ºå…ˆå¯¼é¢„å‘Šï¼Œå†…å®¹æ˜¯å‡ æ”¯ 80 å¹´ä»£å¹¿å‘Šå’Œä¸€æ¡£ç«¥æ˜Ÿé€‰ç§€èŠ‚ç›®ã€‚éšååˆé™†ç»­é‡Šå‡ºä¸€äº›å›¾ç‰‡ï¼Œæ¯”å¦‚è´´æ»¡å¹¿å‘Šçš„å¤§é—¨çš„ç…§ç‰‡ã€‚å»çœ‹ç½‘ä¸Šå…³äºè¿™äº›é¢„å‘Šçš„åˆ†æï¼Œå‘ç°è¿™é‡Œä¸å…å¤¹æ‚äº†å‡¶æ€ã€åˆ†å°¸ã€æ‹œç¥ã€ç¥­ç¥€ç­‰ç­‰ææ€–æƒŠæ‚šçš„ã€Œå¥‡æƒ…ã€å…ƒç´ ã€‚è¿™äº›å†…å®¹ä¼šè®©äººè”æƒ³åˆ°ã€è¡€è§‚éŸ³ã€ï¼Œä¼šè”æƒ³åˆ° 93 å¹´çš„é¦™æ¸¯ç”µå½±ã€äººè‚‰å‰çƒ§åŒ…ã€ï¼Œæˆ–è€…æ˜¯15 å¹´ç¿å­å…‰å¯¼æ¼”æ‰§å¯¼çš„ã€è¸è¡€å¯»æ¢…ã€ã€‚è¿™ç±»ç”µå½±éƒ½å¯ä»¥å½’çº³ä¸ºã€Œå¥‡æƒ…ç‰‡ã€çš„æ¦‚å¿µï¼Œå®ƒä»¬å¾€å¾€ä¼šæ˜¯ä¸€äº›å‡¶æ€æ¡ˆä»¶ï¼Œå’Œæ™®é€šçš„çŠ¯ç½ªç‰‡ä¸åŒï¼ŒçŠ¯ç½ªæ‰‹æ®µé€šå¸¸éƒ½æ˜¯å‡¶ç‹ æ®‹å¿ï¼Œè€Œä¸”åŠ¨æœºéš¾ä»¥æ‰æ‘¸ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¥‡æƒ…ç”µå½±çš„èƒŒåå¾€å¾€è•´å«ç€å¯¹æ—¶å±€åŠ¨è¡ã€ç¤¾ä¼šä¸ç¨³å®šçš„ä¸€ç§æœ¬èƒ½æ€§çš„ææƒ§ã€‚è¦ä¹ˆç›´æ¥è¯‰è‹¦ï¼Œè¦ä¹ˆè½¬ç§»è§†çº¿ã€‚&lt;/p&gt;
&lt;p&gt;â€“&lt;a href=&quot;https://hardimage.pro/32&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ã€å¥‡å¼‚çš„â€¦â€¦ã€ Episode 32 - ç¡¬å½±åƒ&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ã€è¿˜æ„¿ã€åŒæ ·æ˜¯å…·æœ‰ã€Œå¥‡æƒ…ç‰‡ã€å†…æ ¸çš„ææ€–æ¸¸æˆã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹å†…å®¹æ¶‰åŠå‰§é€ã€‚&lt;/p&gt;
&lt;p&gt;ã€è¿˜æ„¿ã€çš„æ•…äº‹èƒŒæ™¯è®¾å®šåœ¨ 80 å¹´ä»£çš„å°æ¹¾ã€‚æ•…äº‹çš„å™è¿°åœ¨ 1980 å¹´ï¼Œ1985 å¹´ï¼Œ1986 å¹´ä¸‰ä¸ªæ—¶é—´ç‚¹äº’ç›¸ç©¿æ¢­ï¼Œäº¤å‰å™äº‹ã€‚80 å¹´ä»£çš„å°æ¹¾ç©¶ç«Ÿå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ1979 å¹´æœ«å‘ç”Ÿäº†è½°åŠ¨ä¸€æ—¶çš„ã€Œç¾ä¸½å²›äº‹ä»¶ã€ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="æ¸¸æˆ" scheme="http://reyshawn.com/tags/%E6%B8%B8%E6%88%8F/"/>
    
      <category term="æ•…äº‹" scheme="http://reyshawn.com/tags/%E6%95%85%E4%BA%8B/"/>
    
  </entry>
  
  <entry>
    <title>æ£‹ç›˜ä¸Šçš„ã€Œå¤å¢“ä¸½å½±ã€</title>
    <link href="http://reyshawn.com/2019/02/07/%E6%A3%8B%E7%9B%98%E4%B8%8A%E7%9A%84%E3%80%8C%E5%8F%A4%E5%A2%93%E4%B8%BD%E5%BD%B1%E3%80%8D/"/>
    <id>http://reyshawn.com/2019/02/07/æ£‹ç›˜ä¸Šçš„ã€Œå¤å¢“ä¸½å½±ã€/</id>
    <published>2019-02-07T13:15:26.950Z</published>
    <updated>2019-02-07T13:39:29.295Z</updated>
    
    <content type="html"><![CDATA[<p>åˆæ˜¯ä¸€ä¸ªæ–°å¹´è¿‡å»äº†ã€‚åœ¨å¹´å¤ä¸€å¹´ä¸å˜çš„ä¹ ä¿—å’Œæ¸æ¸æ¶ˆæ·¡çš„å¹´å‘³é‡Œï¼Œæˆ‘æŠŠ Lara Croft Go æ‰“é€šäº†ã€‚åœ¨ Square Enix çš„ Go æ¸¸æˆä¸‰éƒ¨æ›²é‡Œï¼ŒHitman Go æ˜¯å‡ å¹´å‰ç©è¿‡çš„ï¼Œå»å¹´å°è¯•äº† Deus Ex Goã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œæ›´å–œæ¬¢è¿™éƒ¨ Lara Goã€‚Deus é‡Œçš„ç§‘å¹»é£å¤ªè¿‡æµ“é‡ï¼ŒHitman Go å¾ˆè´´è¿‘ç°ä»£éƒ½å¸‚ï¼Œåœ¨æ£‹ç›˜æ¨¡æ‹Ÿçš„åœºæ™¯é‡Œï¼Œæœ‰ç†Ÿæ‚‰çš„æ¸¸æ³³æ± ï¼ŒèŠ±å›­ï¼Œæˆ¿å±‹é‡Œçš„å®¶å…·ç­‰ç­‰ã€‚Lara Go çš„åœºæ™¯éƒ½æ˜¯æ”¾åœ¨é‡å¤–ï¼Œå±±çªŸæ´ç©´ï¼Œæ‚¬å´–å³­å£ã€‚å¦‚æœå¦å¤–ä¸¤ä½œçš„ç‰¹ç‚¹éƒ½æ˜¯åœ¨ã€Œæ½œå…¥ã€ï¼Œé‚£ä¹ˆ Lara Go çš„ç‰¹ç‚¹åˆ™æ˜¯åœ¨ã€Œå†’é™©ã€ã€‚å°½ç®¡æœ‰ç€å›ºå®šçš„æ£‹ç›˜ï¼Œæ¯æ¬¡åªèƒ½å‰è¿›ä¸€æ ¼ï¼Œä½†è¿™çš„ç¡®æ˜¯ä¸ªä¸æŠ˜ä¸æ‰£çš„ Tomb Raider å¼çš„å†’é™©æ•…äº‹ã€‚</p><p><img src="/images/Game/Lara Go 1.jpg" alt="Lara Go 1"></p><p>æ¸¸æˆæ•´ä½“ç¾æœ¯é£æ ¼ï¼Œåå‘æŠ˜çº¸ï¼ŒèƒŒæ™¯çš„é»‘è‰²å‰ªå½±æä¾›æ²‰æµ¸æ„Ÿã€‚è¿™æ ·çš„ç¾æœ¯é£æ ¼åœ¨ iOS å¹³å°å¹¶ä¸å°‘è§ã€‚ç†Ÿæ‚‰çš„æœ‰ã€Œçºªå¿µç¢‘è°·ã€ã€ŒAltoâ€™s Odysseyã€ã€‚è¿™æ ·åæŠ˜çº¸çš„è‰ºæœ¯é£æ ¼ï¼Œä¹Ÿæ¯”è¾ƒé€‚åˆè¿™æ ·çš„æ¸¸æˆæ¨¡å¼ã€‚Square Enix åœ¨ Go ç³»åˆ—æ¸¸æˆé‡Œæƒ³åšçš„ï¼Œæ˜¯å¸Œæœ›æŠŠ Go ç³»åˆ—åšæˆä¸€ç§æ¡Œæ¸¸ç±»å‹çš„æ¸¸æˆï¼Œæ‰€ä»¥è¿™æ ·çš„æŠ˜çº¸é£æ ¼å†å®Œç¾ä¸è¿‡äº†ã€‚å‡ å¹´å‰åœ¨ç© Hitman Go æ—¶ï¼Œæ¯ä¸€å…³çš„åœ°å›¾ï¼Œéƒ½æ˜¯æŒ‰ç…§æ¡Œæ¸¸çš„åŒ…è£…ç›’æ¥è®¾è®¡çš„ã€‚</p><p>ä»¥ä¸‹å†…å®¹æ¶‰åŠå‰§é€ã€‚</p><a id="more"></a><p><img src="/images/Game/Go-Trilogy.png" alt="Go-Trilogy"></p><p>Lara Go ç›¸æ¯”äºå¦å¤–ä¸¤ä½œï¼Œæ•´ä¸ªæ¸¸æˆç‰¹è‰²ä¸ŠåŠ å…¥ã€Œå†’é™©ã€çš„å…ƒç´ ã€‚æ¸¸æˆç©æ³•ä¸Šå¼•å…¥ã€Œæ”€çˆ¬ã€ç³»ç»Ÿã€‚è¿™æ ·åœ¨æ¸¸æˆè§£å¯†çš„è¿‡ç¨‹ä¸­ï¼Œå°±ä¸å†åªæ˜¯è€ƒè™‘å•çº¯çš„ XY å¹³é¢ç§»åŠ¨ï¼Œè¿˜ä¼šæœ‰æ¥è‡ª Z è½´çš„å˜æ¢ã€‚è¿™ä¸€ç‚¹ä½“ç°åœ¨ï¼Œæ¯”å¦‚å †å çŸ³æŸ±ï¼Œé™·å‘ï¼Œå‡é™æœºå…³ç­‰ç­‰ã€‚æ•…äº‹çš„æ ¸å¿ƒå°±åƒæœ€ä¼ ç»Ÿï¼Œæœ€ typical çš„ Tomb Raider çš„æ•…äº‹é‚£æ ·ï¼Œä¸»è§’ Lara æ¥åˆ°ä¸€ç‰‡ä¸›æ—ï¼Œåœ¨ä¸›æ—æ·±å¤„å‘ç°ä¸€å¤„ç§˜å¢ƒï¼Œé‚£é‡Œä¿å­˜ç€ä¸€ä¸ªç±»ä¼¼ã€Œé­”æ–¹ã€çš„å™¨ç‰©ï¼Œè·å¾—ã€Œé­”æ–¹ã€éœ€è¦ä¸‰é¢—çŸ³å¤´ï¼Œè·å¾—è¿™ä¸‰é¢—çŸ³å¤´ï¼Œå¿…é¡»ç»å†ä¸‰å¤„è¿·å®«ï¼šThe Maze of Snakesï¼ŒThe Maze of Stonesï¼ŒThe Maze of Spiritsã€‚è¦åˆ†åˆ«ç»å†è¿™ä¸‰å¤„è¿·å®«ï¼Œè·å¾—ä¸‰ä¸ªçŸ³å¤´ï¼Œæ‰“å¼€å¤§é—¨ï¼Œæœ€åæ‰èƒ½è·å¾—ã€Œé­”æ–¹ã€ï¼Œã€Œé­”æ–¹ã€è¢«æ‹¿ä¸‹åŒæ—¶ï¼Œæ•´ä¸ªç§˜å¢ƒä¹Ÿå˜å¾—ä¸ç¨³å®šï¼Œä¼¼ä¹å¼€å§‹åå¡Œé™·è½ï¼Œäºæ˜¯å°±è¦å°½å¿«ä»ç§˜å¢ƒä¸­é€ƒè„±ã€‚è¿™æ˜¯ä¸»çº¿å†…å®¹ï¼Œé™¤æ­¤ä»¥å¤–ï¼ŒLara Go é‡Œè¿˜æœ‰ä¸¤ä¸ªæ”¯çº¿ï¼ŒNew Adventureï¼Œåˆ†åˆ«æ˜¯ The Cave of Fire å’Œ The Mirror of Spiritsã€‚</p><p>æœ€æœ‰è¶£çš„ç« èŠ‚éƒ½æ˜¯æ¥è‡ªç•ªå¤–ã€‚æœ¬ä½œä¹Ÿæ˜¯è¿™æ ·ï¼Œå…¨éƒ¨ç©ä¸‹æ¥ï¼Œåé¢çš„ä¸¤ä¸ª New Adventureï¼Œæ˜¯æˆ‘è®¤ä¸ºè¿™ä¸ªæ¸¸æˆè®¾è®¡çš„æœ€æ£’çš„ä¸¤ä¸ªç« èŠ‚ã€‚The Cave of Fire é‡Œå¼•å…¥äº†ã€Œå¤æ´»ç³»ç»Ÿã€ï¼Œåœ¨ä½ æ¶ˆç­æ€ªç‰©åçš„å››ä¸ªå›åˆï¼Œæ€ªç‰©ä¼šè‡ªåŠ¨å¤æ´»ã€‚æ‰€ä»¥ï¼Œä¸å†åƒä¹‹å‰é‚£æ ·æƒ³ç€å¦‚ä½•è§£å†³æ‰æ€ªç‰©ã€‚å¤§å¤šæ•°æƒ…å†µéœ€è¦é€šè¿‡å¼•è¯±æ€ªç‰©ï¼Œè§¦å‘æŸäº›æœºå…³ï¼Œæˆ–æ˜¯åˆ©ç”¨æ€ªç‰©å¤æ´»å‰çš„å››ä¸ªå›åˆï¼Œè¿›è¡Œä¸€äº›åˆ«çš„æ“ä½œã€‚å› æ­¤ï¼Œè¿™å°±è®©æ¯ä¸€æ­¥é™åˆ¶å¾—ç‰¹åˆ«æ­»ï¼Œåœ¨è‹¥å¹²æ¡çº¿è·¯ä¸­ï¼Œæœ€ä¼˜çš„çº¿è·¯å¯èƒ½åªæœ‰ä¸€æ¡ï¼Œè¿˜è¦ä¸æ–­è®¡ç®—æœºå…³å¤åŸçš„å›åˆæ•°ï¼Œæ€ªç‰©å¤æ´»çš„å›åˆæ•°ã€‚è¿™äº›éƒ½éœ€è¦æ¯”ä¹‹å‰ç« èŠ‚æ›´å¤šçš„æ€è€ƒã€‚The Mirror of Spirits è¿™ä¸ªç« èŠ‚å®åœ¨æ˜¯å¤ªæ£’äº†ã€‚è¿™ä¸ªç« èŠ‚é‡Œç¬¬ä¸€æ¬¡å¼•å…¥äº†ã€Œå…‰ã€ç³»ç»Ÿï¼Œé€šè¿‡ã€Œå…‰ã€æ¥è§¦å‘æœºå…³ã€‚å¦å¤–æœ€å…·åˆ›æ„çš„æ˜¯åŠ å…¥äº†ã€Œé•œåƒã€æ¦‚å¿µã€‚è¿™æ ·çš„ç¾æœ¯é£æ ¼å’Œç©æ³•æ¨¡å¼ï¼Œç›¸æ¯”ç±»ä¼¼çš„ã€Œçºªå¿µç¢‘è°·ã€æ¥è®²ï¼Œéƒ½é«˜å‡ºå¤ªå¤šäº†ã€‚ç”»é¢é‡Œï¼Œæ¸¸æˆçš„ä¸€åŠä¼šå‡ºç°ä¸€ä¸ªé•œåƒåœºæ™¯ï¼Œé•œåƒåœºæ™¯é‡Œä¼šæœ‰ä¸€ä¸ªé•œåƒäººç‰©ã€‚é•œåƒåœºæ™¯ä¸€å¼€å§‹æ˜¯å’ŒçœŸå®ä¸–ç•Œç›¸åŒï¼Œåæ¥å°±ä¼šæ…¢æ…¢å‡ºç°äº†äº›è®¸ä¸åŒï¼Œæ¯”å¦‚ä¸åŒçš„æœºå…³ï¼Œä½ç½®ä¸åŒçš„å‡ºå£ï¼Œä¸åŒçš„æ€ªç‰©ï¼Œç”šè‡³ä¸åŒçš„åœ°å½¢å¸ƒå±€ã€‚è¿™é‡Œï¼Œé•œåƒäººç‰©çš„æ­»äº¡ï¼Œä¹Ÿä¼šå¯¼è‡´çœŸå®äººç‰©çš„æ­»äº¡ï¼Œæ‰€ä»¥è§£è°œè¿‡ç¨‹ä¸­ï¼Œä¸ä»…è¦æ³¨æ„çœŸå®ä¸–ç•Œçš„æœºå…³ï¼Œè¿˜è¦å…¼é¡¾é•œåƒä¸–ç•Œé‡Œçš„ç§ç§è¦ç´ ã€‚å¿…è¦çš„æ—¶å€™ï¼Œä½ è¿˜è¦è¿›å…¥åˆ°é•œåƒä¸–ç•Œï¼Œè€Œé•œåƒäººç‰©ä¼šæ¥åˆ°çœŸå®ä¸–ç•Œã€‚è¿™æ ·çš„è®¾å®šï¼ŒæŠŠä¹‹å‰é‚£ç§ç®€å•çš„ turn-based è§£è°œæ¸¸æˆï¼Œå¯èƒ½åªæ˜¯æ¬åŠ¨ä¸€ä¸‹å¼€å…³ï¼Œåˆ°è¿™é‡Œç›´æ¥ä¸Šå‡åˆ°ä¸€ä¸ªæ–°çš„ levelï¼Œæ— è®ºæ˜¯æ¸¸æˆç©æ³•ï¼Œè¿˜æ˜¯ç¾æœ¯é£æ ¼ã€‚</p><p><img src="/images/Game/Lara Go .jpg" alt="Lara Go "></p><p><img src="/images/Game/Lara Go 3.jpg" alt="Lara Go 3"></p><p>è¯´ä¸‹å‡ å¤„è‡ªå·±æ¸¸ç©æ—¶å°è±¡æ·±åˆ»çš„ç‚¹ï¼šåœ¨è·å¾—ã€Œé­”æ–¹ã€æ—¶å€™ï¼Œè¿›å…¥ä¸‹ä¸€ç¯‡ç« ï¼ŒThe Escape é€ƒäº¡ç« èŠ‚ã€‚åœºæ™¯å˜çš„æ˜æš—ï¼Œé»‘è‰²å‰ªå½±çš„èƒŒæ™¯æ˜¯ä¸æ–­æ‰è½çš„ç¢çŸ³ï¼ŒèƒŒæ™¯éŸ³ä¹ä¹Ÿçªç„¶å˜å¾—ç´§å¼ æ€¥ä¿ƒã€‚åœ¨è¿™ä¸ªç« èŠ‚çš„æ¸¸æˆè§£å¯†é‡Œï¼Œä¹Ÿå°½é‡è®¾è®¡çš„ç®€å•ã€‚æ¯”å¦‚ï¼Œæ‹‰ä¸‹æœºå…³åï¼Œéœ€è¦è¿…é€Ÿé€šè¿‡å°„ç®­çš„åŒºåŸŸã€‚æ°åˆ°å¥½å¤„åœ°è¥é€ å‡ºé€ƒäº¡çš„æ°›å›´ã€‚ç¬¬äºŒä¸ªå°è±¡æ·±åˆ»çš„ç‚¹ï¼Œæ˜¯åœ¨ç«æŠŠçš„ç¬¬ä¸€æ¬¡å‡ºç°ï¼Œæ‹¿åˆ°ç«æŠŠä¹‹åï¼Œä¹‹å‰é‚£äº›å“äººçš„æ€ªç‰©ï¼Œç»ˆäºä¸å†æ•¢é è¿‘åŠæ­¥ã€‚ä»¥åŠï¼Œåœ¨  The Mirror of Spiritsï¼Œé•œåƒçš„ç¬¬ä¸€æ¬¡å‡ºç°ï¼Œç¬¬ä¸€æ¬¡æ§åˆ¶çœŸå®äººç‰©è¿›å…¥åˆ°é•œåƒä¸–ç•Œé‡Œï¼Œç¬¬ä¸€æ¬¡é€šè¿‡æœºå…³ï¼Œè®©é•œåƒäººç‰©å’ŒçœŸå®äººç‰©å‡ºç°ã€Œå¼‚æ­¥ã€è¡ŒåŠ¨ã€‚è¿™äº›ä¸€åˆ‡ï¼Œå¿ƒä¸­ä¸å…ä¼šæ¶Œç°å†’é™©ç´§å¼ æ¿€åŠ¨å’Œè§£è°œæˆåŠŸçš„å¿«æ„Ÿï¼Œä¹Ÿè®©æˆ‘ä¸æ–­åœ°èµå¹è®¾è®¡å¸ˆï¼Œèµå¹è¿™ä¸ªæ¸¸æˆçš„å¼€å‘è€…ã€‚</p><p><img src="/images/Game/Lara Go 2.jpg" alt="Lara Go 2"></p><p>è¿™éƒ¨æ¸¸æˆå‘å¸ƒäº 2015 å¹´ï¼Œä¹Ÿè·å¾—äº†è¯¸å¦‚ Apple Design Awardï¼ŒTGA Best Mobile Game ç­‰å¤šé¡¹å¤§å¥–ã€‚ä½†æ¯”è¾ƒå¯æƒœçš„æ˜¯ï¼Œ Square Enix Montreal ç¡®å®šä¸ä¼šå†åˆ¶ä½œ Go ç³»åˆ—æ¸¸æˆã€‚</p><blockquote><p>Square Enix Montreal studio head Patrick Naud confirmed that the studio is not working on any new <em>Go</em> games, saying that â€œone of the challenges we have today is the premium mobile market is diminishing.â€ He pointed specifically to their prices (the <em>Go</em> games are each $4.99), saying that itâ€™s â€œsuch a big barrier for mobile users.â€</p></blockquote><p>åœ¨ç§»åŠ¨ç«¯å¹³å°ï¼Œå¤§å¤šæ•°æ¸¸æˆçš„è¿è¥æ¨¡å¼éƒ½æ˜¯å…è´¹åŠ å†…è´­çš„å½¢å¼ã€‚å†…è´­çš„å†…å®¹ä¹Ÿå¾€å¾€æ˜¯æ¸¸æˆå†…çš„é‡‘å¸ä»€ä¹ˆã€‚è€Œå¯¹äºç±»ä¼¼ Lara Go è¿™æ ·å°è€Œç¾ï¼Œç²¾è‡´çš„ç‹¬ç«‹æ¸¸æˆï¼Œåœ¨æµ©è¡çš„ç§»åŠ¨å¹³å°å¸‚åœºï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆç«äº‰åŠ›ã€‚ä¸ç®¡æ˜¯åŠ£å¸é©±é™¤è‰¯å¸ï¼Œè¿˜æ˜¯è¯´ç°ä»£ç”Ÿæ´»èŠ‚å¥åŠ å¿«ï¼Œäººä»¬éƒ½æ˜¯æ›´åŠ åçˆ±å¿«é¤ç±»å‹çš„æ¶ˆè´¹ï¼Œæ¸¸æˆä¹Ÿå¥½ï¼Œç”µå½±ä¹Ÿå¥½ã€‚è™½ç„¶å¾ˆæ˜ç¡® Go ä¸ä¼šæœ‰ä¸‹ä¸€éƒ¨ç»­ä½œï¼Œä½† Go è¿™ç§æ£‹ç›˜é£æ ¼çš„è§£è°œæ¸¸æˆï¼Œè¿™æ ·çš„æ¸¸æˆæ–¹å¼ï¼Œå› å…¶ç‹¬æœ‰çš„é£æ ¼ï¼Œä¸€å®šä¼šå¾—åˆ°å»¶ç»­ã€‚</p><p>å‚è€ƒï¼š</p><ul><li><a href="https://www.theverge.com/2018/6/3/17422724/square-enix-montreal-no-longer-making-go-games-lara-croft-hitman-deus-ex-free-to-play" target="_blank" rel="noopener">Square Enix Montreal is no longer making Go games - The Verge</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åˆæ˜¯ä¸€ä¸ªæ–°å¹´è¿‡å»äº†ã€‚åœ¨å¹´å¤ä¸€å¹´ä¸å˜çš„ä¹ ä¿—å’Œæ¸æ¸æ¶ˆæ·¡çš„å¹´å‘³é‡Œï¼Œæˆ‘æŠŠ Lara Croft Go æ‰“é€šäº†ã€‚åœ¨ Square Enix çš„ Go æ¸¸æˆä¸‰éƒ¨æ›²é‡Œï¼ŒHitman Go æ˜¯å‡ å¹´å‰ç©è¿‡çš„ï¼Œå»å¹´å°è¯•äº† Deus Ex Goã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œæ›´å–œæ¬¢è¿™éƒ¨ Lara Goã€‚Deus é‡Œçš„ç§‘å¹»é£å¤ªè¿‡æµ“é‡ï¼ŒHitman Go å¾ˆè´´è¿‘ç°ä»£éƒ½å¸‚ï¼Œåœ¨æ£‹ç›˜æ¨¡æ‹Ÿçš„åœºæ™¯é‡Œï¼Œæœ‰ç†Ÿæ‚‰çš„æ¸¸æ³³æ± ï¼ŒèŠ±å›­ï¼Œæˆ¿å±‹é‡Œçš„å®¶å…·ç­‰ç­‰ã€‚Lara Go çš„åœºæ™¯éƒ½æ˜¯æ”¾åœ¨é‡å¤–ï¼Œå±±çªŸæ´ç©´ï¼Œæ‚¬å´–å³­å£ã€‚å¦‚æœå¦å¤–ä¸¤ä½œçš„ç‰¹ç‚¹éƒ½æ˜¯åœ¨ã€Œæ½œå…¥ã€ï¼Œé‚£ä¹ˆ Lara Go çš„ç‰¹ç‚¹åˆ™æ˜¯åœ¨ã€Œå†’é™©ã€ã€‚å°½ç®¡æœ‰ç€å›ºå®šçš„æ£‹ç›˜ï¼Œæ¯æ¬¡åªèƒ½å‰è¿›ä¸€æ ¼ï¼Œä½†è¿™çš„ç¡®æ˜¯ä¸ªä¸æŠ˜ä¸æ‰£çš„ Tomb Raider å¼çš„å†’é™©æ•…äº‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/Game/Lara Go 1.jpg&quot; alt=&quot;Lara Go 1&quot;&gt;&lt;/p&gt;
&lt;p&gt;æ¸¸æˆæ•´ä½“ç¾æœ¯é£æ ¼ï¼Œåå‘æŠ˜çº¸ï¼ŒèƒŒæ™¯çš„é»‘è‰²å‰ªå½±æä¾›æ²‰æµ¸æ„Ÿã€‚è¿™æ ·çš„ç¾æœ¯é£æ ¼åœ¨ iOS å¹³å°å¹¶ä¸å°‘è§ã€‚ç†Ÿæ‚‰çš„æœ‰ã€Œçºªå¿µç¢‘è°·ã€ã€ŒAltoâ€™s Odysseyã€ã€‚è¿™æ ·åæŠ˜çº¸çš„è‰ºæœ¯é£æ ¼ï¼Œä¹Ÿæ¯”è¾ƒé€‚åˆè¿™æ ·çš„æ¸¸æˆæ¨¡å¼ã€‚Square Enix åœ¨ Go ç³»åˆ—æ¸¸æˆé‡Œæƒ³åšçš„ï¼Œæ˜¯å¸Œæœ›æŠŠ Go ç³»åˆ—åšæˆä¸€ç§æ¡Œæ¸¸ç±»å‹çš„æ¸¸æˆï¼Œæ‰€ä»¥è¿™æ ·çš„æŠ˜çº¸é£æ ¼å†å®Œç¾ä¸è¿‡äº†ã€‚å‡ å¹´å‰åœ¨ç© Hitman Go æ—¶ï¼Œæ¯ä¸€å…³çš„åœ°å›¾ï¼Œéƒ½æ˜¯æŒ‰ç…§æ¡Œæ¸¸çš„åŒ…è£…ç›’æ¥è®¾è®¡çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹å†…å®¹æ¶‰åŠå‰§é€ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="æ¸¸æˆ" scheme="http://reyshawn.com/tags/%E6%B8%B8%E6%88%8F/"/>
    
      <category term="æ•…äº‹" scheme="http://reyshawn.com/tags/%E6%95%85%E4%BA%8B/"/>
    
  </entry>
  
  <entry>
    <title>ã€ŒUser Authentication with Passport and Koa ã€Summary</title>
    <link href="http://reyshawn.com/2019/01/31/%E3%80%8CUser%20Authentication%20with%20Passport%20and%20Koa%20%E3%80%8DSummary/"/>
    <id>http://reyshawn.com/2019/01/31/ã€ŒUser Authentication with Passport and Koa ã€Summary/</id>
    <published>2019-01-31T02:11:15.356Z</published>
    <updated>2019-02-02T14:15:36.141Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸Šå‘¨åœ¨é˜…è¯» <em>Express.js Blueprints</em> æ—¶çœ‹åˆ° Authentication çš„éƒ¨åˆ†ï¼Œå°±æƒ³ç€ä½¿ç”¨ Koa å»å¤ç°ä¸€éã€‚äºæ˜¯åœ¨ç½‘ä¸Šçœ‹åˆ°è¿™ç¯‡æ–‡ç«  <a href="https://mherman.org/blog/user-authentication-with-passport-and-koa/" target="_blank" rel="noopener">User Authentication with Passport and Koa</a> ã€‚æ–‡ç« ç»™å‡ºäº†æºä»£ç å’Œè¯¦ç»†çš„æ­¥éª¤ã€‚å…¶ä¸­ä¸ä¹é‡åˆ°è‡ªå·±ä¸ç†Ÿæ‚‰çš„çŸ¥è¯†é¢†åŸŸï¼Œæ¯”å¦‚ knexï¼Œpostgresql å’Œ redis ç­‰ç­‰ã€‚å†™è¿™ç¯‡æ–‡ç« çš„ç›®çš„ï¼šä¸€æ˜¯ç†Ÿæ‚‰ä¸‹åœ¨ koa æ¡†æ¶ä¸‹çš„ç¨‹åºç»“æ„ï¼›äºŒæ˜¯å¯¹äºè‡ªå·±ä¸ç†Ÿæ‚‰çš„çŸ¥è¯†é¢†åŸŸçš„ä¸€ä¸ªæ€»ç»“ã€‚</p><p>éœ€è¦é€šè¿‡ brew å®‰è£…ï¼š</p><ul><li>postgresql</li><li>redis</li></ul><p>ä½¿ç”¨ npm å…¨å±€å®‰è£…ï¼š</p><ul><li>knex</li></ul><a id="more"></a><h2 id="æ–‡ä»¶ç»“æ„ï¼Œé€»è¾‘"><a href="#æ–‡ä»¶ç»“æ„ï¼Œé€»è¾‘" class="headerlink" title="æ–‡ä»¶ç»“æ„ï¼Œé€»è¾‘"></a>æ–‡ä»¶ç»“æ„ï¼Œé€»è¾‘</h2><p>æ–‡ä»¶æœ€åçš„ç»“æ„ï¼š</p><pre><code class="shell">.â”œâ”€â”€ LICENSEâ”œâ”€â”€ README.mdâ”œâ”€â”€ knexfile.jsâ”œâ”€â”€ package-lock.jsonâ”œâ”€â”€ package.jsonâ”œâ”€â”€ srcâ”‚   â””â”€â”€ serverâ”‚       â”œâ”€â”€ auth.jsâ”‚       â”œâ”€â”€ dbâ”‚       â”‚   â”œâ”€â”€ connection.jsâ”‚       â”‚   â”œâ”€â”€ migrationsâ”‚       â”‚   â”‚   â”œâ”€â”€ 20170817152841_movies.jsâ”‚       â”‚   â”‚   â””â”€â”€ 20190127152820_users.jsâ”‚       â”‚   â”œâ”€â”€ queriesâ”‚       â”‚   â”‚   â”œâ”€â”€ movies.jsâ”‚       â”‚   â”‚   â””â”€â”€ users.jsâ”‚       â”‚   â””â”€â”€ seedsâ”‚       â”‚       â”œâ”€â”€ movies_seed.jsâ”‚       â”‚       â””â”€â”€ users.jsâ”‚       â”œâ”€â”€ index.jsâ”‚       â”œâ”€â”€ routesâ”‚       â”‚   â”œâ”€â”€ auth.jsâ”‚       â”‚   â”œâ”€â”€ index.jsâ”‚       â”‚   â””â”€â”€ movies.jsâ”‚       â””â”€â”€ viewsâ”‚           â”œâ”€â”€ login.htmlâ”‚           â”œâ”€â”€ register.htmlâ”‚           â””â”€â”€ status.htmlâ””â”€â”€ test    â”œâ”€â”€ routes.auth.test.js    â”œâ”€â”€ routes.index.test.js    â”œâ”€â”€ routes.movies.test.js    â””â”€â”€ sample.test.js</code></pre><p>æœ‰ä¸€äº›æ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶å±äºè‡ªåŠ¨ç”Ÿæˆçš„ boilerplateï¼Œæ¯”å¦‚ <code>package.json</code>ï¼Œ<code>knexfile.js</code>ï¼Œ<code>db</code> æ–‡ä»¶å¤¹é‡Œçš„ä¸€äº›å†…å®¹ã€‚é¡¹ç›®çš„ç»“æ„æ¸…æ™°æ˜æœ—ã€‚<code>test</code> ä¸ºæµ‹è¯•æ–‡ä»¶å¤¹ã€‚æµ‹è¯•æ–‡ä»¶çš„æ ‡é¢˜ç»Ÿä¸€åŠ ä¸Š <code>test</code> æ ‡ç¤ºï¼Œå¹¶ç”¨ dot åˆ†éš”ã€‚è¿™ä¹Ÿæé†’è‡ªå·±ï¼Œæ–‡ä»¶æ ‡é¢˜çš„å‘½åå¯ä»¥ä¸ä½¿ç”¨ underscore æˆ– dash æ¥åˆ†éš”ï¼Œä¹Ÿå¯ä»¥ç”¨ dotã€‚åœ¨ <code>server</code> æ–‡ä»¶å¤¹ä¸‹ï¼Œ<code>db</code> å‡ ä¹éƒ½æ˜¯æ•°æ®åº“ï¼Œknex ç›¸å…³çš„ã€‚å¦å¤–æœ‰è·¯ç”± <code>routes</code> æ–‡ä»¶å¤¹å’Œ <code>views</code> è§†å›¾æ–‡ä»¶å¤¹ã€‚</p><h2 id="Postgresql"><a href="#Postgresql" class="headerlink" title="Postgresql"></a>Postgresql</h2><p>åœ¨ macOS ä¸Šç›´æ¥ä½¿ç”¨ Brew å®‰è£…å³å¯ã€‚ç”±äºæˆ‘ä¸ªäººä¸ä¹ æƒ¯å¼€æœºè‡ªåŠ¨å¯åŠ¨æ•°æ®åº“ï¼Œé‚£ä¸ªéœ€è¦ç”¨åˆ°ç±»ä¼¼ <code>service start</code> çš„å‘½ä»¤ã€‚è¿™é‡Œæ˜¯æ‰‹åŠ¨å¼€å¯çš„åŠæ³•ï¼š</p><pre><code class="shell">$ pg_ctl -D /usr/local/var/postgres start  </code></pre><p>å’Œ Mysql ä¸€æ ·ï¼ŒæŠŠ <code>start</code> å¯ä»¥æ¢æˆ <code>stop</code>ï¼Œ<code>restart</code>ã€‚</p><p>æ•°æ®åº“åˆå§‹åŒ–ï¼š</p><pre><code class="shell">$ initdb /usr/local/var/postgres  </code></pre><p>åœ¨è¿™ç¯‡æ•™ç¨‹é‡Œï¼Œéœ€è¦æˆ‘äº‹å…ˆåˆ›å»ºä¸¤ä¸ªæ•°æ®åº“ï¼Œåˆ›å»ºæ•°æ®åº“ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š</p><pre><code class="shell">$ createdb koa_api    $ createdb koa_api_test</code></pre><p><code>psql</code> + Databaseï¼Œè¿›å…¥ database çš„å‘½ä»¤è¡Œã€‚</p><p><code>\dt</code> æ˜¾ç¤ºæ‰€æœ‰ tables</p><blockquote><p>Please note the following commands:</p><ul><li><code>\list</code> or <code>\l</code>: list all databases</li><li><code>\dt</code>: list all tables in the current database</li></ul><p>You will never see tables in other databases, these tables arenâ€™t visible. You have to connect to the correct database to see its tables (and other objects).</p><p>To switch databases:</p><pre><code>\connect database_name` or `\c database_name</code></pre><p>See the manual about <a href="http://www.postgresql.org/docs/current/interactive/app-psql.html" target="_blank" rel="noopener">psql</a>.</p><p>â€“ <a href="https://dba.stackexchange.com/questions/1285/how-do-i-list-all-databases-and-tables-using-psql" target="_blank" rel="noopener">How do I list all databases and tables using psql?</a></p></blockquote><p>é™¤æ­¤ä»¥å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡ Knex æ¥åˆ›å»ºæ•°æ®åº“ã€‚ç†è®ºä¸Šï¼Œå¯ä»¥é€šè¿‡ Knex æ¥è¿›è¡Œæ‰€æœ‰çš„æ•°æ®åº“æ“ä½œã€‚</p><h2 id="knex"><a href="#knex" class="headerlink" title="knex"></a>knex</h2><blockquote><p><strong>Knex.js</strong> is a â€œbatteries includedâ€ SQL query builder for <strong>Postgres</strong>, <strong>MSSQL</strong>, <strong>MySQL</strong>, <strong>MariaDB</strong>, <strong>SQLite3</strong>, <strong>Oracle</strong>, and <strong>Amazon Redshift</strong> designed to be flexible, portable, and fun to use. </p><p>â€“ <a href="https://knexjs.org" target="_blank" rel="noopener">Knex.js</a></p></blockquote><p>Knexï¼Œå¯ä»¥çœ‹ä½œæ˜¯å„ç§ä¸åŒæ•°æ®åº“ä¸‹ç»Ÿä¸€å°è£…çš„ä¸€å¥— APIã€‚é€šè¿‡ Knex æ¥å’Œæ•°æ®åº“è¿›è¡Œäº¤äº’ã€‚æ¯”å¦‚åˆ›å»ºè¡¨ï¼Œæ›´æ–°ï¼Œæ·»åŠ æ•°æ®ç­‰ç­‰ã€‚ä¸Šæ–‡å¼•ç”¨é‡Œæåˆ°äº†ã€Œbattery-includedã€ä¸€è¯ï¼Œæ„æ€æ˜¯ã€Œå¼€ç®±å³ç”¨ã€ï¼Œå³è¿™ä¸ª Library å·²ç»åŒ…å«äº†å®ƒæ‰€éœ€è¦çš„å…¨éƒ¨ä¾èµ– Dependencyã€‚æˆ‘ä»¬è£…å®Œæ‹¿æ¥ç›´æ¥ç”¨å³å¯ï¼Œä¸éœ€è¦åœ¨è¿›è¡Œå…¶ä»– Library çš„å®‰è£…ã€‚</p><p><img src="/images/knex.png" alt="knex"></p><p>å› ä¸ºè¦é¢‘ç¹åœ¨ Terminal é‡Œç”¨åˆ° <code>knex</code> å‘½ä»¤ï¼Œæ‰€ä»¥æœ€åäº‹å…ˆå…¨å±€å®‰è£… Knexã€‚åœ¨è¿™ç¯‡æ•™ç¨‹é‡Œï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨ Postgresql åˆ›å»ºå®Œæ•°æ®åº“ä»¥åï¼Œä¼šçœ‹åˆ°éœ€è¦æˆ‘ä»¬æ‰§è¡Œè¿™ä¸¤æ¡å‘½ä»¤ï¼š</p><pre><code class="shell">$ knex migrate:latest --env development$ knex seed:run --env development</code></pre><hr><p><em>Tipsï¼š</em></p><p><em>å¦‚æœä¸æƒ³è¦å…¨å±€å®‰è£… Knexï¼Œä¾ç„¶æƒ³åœ¨ Terminal è¿è¡Œã€‚åœ¨ç”Ÿæˆçš„ <code>node_modules</code> æ–‡ä»¶å¤¹ä¸‹ä¼šæœ‰ä¸ªéšè—æ–‡ä»¶å¤¹ <code>.bin</code>ï¼Œé‡Œé¢åŒ…å«äº†å…¨éƒ¨æˆ‘ä»¬å¯ä»¥ç›´æ¥è¿è¡Œçš„ packageã€‚æ‰€ä»¥ç›´æ¥ï¼š</em></p><pre><code class="shell">$ node_modules/.bin/knex init</code></pre><hr><p><code>init</code> ä¹‹åï¼Œæœ¬åœ°ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª <code>knexfile.js</code> æ–‡ä»¶ã€‚é‡Œé¢å¤§è‡´æ˜¯äº› boilerplatesã€‚åœ¨è¿™ç¯‡æ•™ç¨‹ç»™çš„ source code é‡Œï¼Œ    <code>knexfile.js</code> å·²ç»é’ˆå¯¹ postgresql é…ç½®å®Œæ¯•ã€‚ä½†è¿™é‡Œè¦æ˜ç™½ migration å’Œ seed ä¸¤ä¸ªæ“ä½œã€‚</p><blockquote><p>Migrations are a way to make database changes or updates, like creating or dropping tables, as well as updating a table with new columns with constraints via generated scripts. We can build these scripts via the command line using <code>knex</code>command line tool.</p></blockquote><p>ä¾‹å¦‚ï¼Œé€šè¿‡ knex åˆ›å»º tableï¼š</p><pre><code class="shell">$ knex migrate:make users</code></pre><p>è¿™é‡Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª <code>users.js</code> æ–‡ä»¶ï¼Œæ–‡ä»¶åå‰é¢è¿˜ä¼šæœ‰ time stampã€‚å­˜å‚¨è·¯å¾„åœ¨ <code>./server/db/migration/</code>ã€‚æ‰€æœ‰çš„æ–‡ä»¶å¤¹éƒ½ä¼šè‡ªåŠ¨ç”Ÿæˆã€‚åœ¨æ–°ç”Ÿæˆçš„æ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰æ–°å»ºçš„è¿™ä¸ª table å„ä¸ª field å±æ€§ã€‚ä¾‹å¦‚åœ¨è¿™ç¯‡æ–‡ç« çš„ä¾‹å­é‡Œï¼Œæ–°å»ºäº† users tableï¼Œå®šä¹‰å±æ€§å¦‚ä¸‹ï¼š</p><pre><code class="javascript">exports.up = (knex, Promise) =&gt; {  return knex.schema.createTable(&#39;users&#39;, (table) =&gt; {    table.increments();    table.string(&#39;username&#39;).unique().notNullable();    table.string(&#39;password&#39;).notNullable();  });};exports.down = (knex, Promise) =&gt; {  return knex.schema.dropTable(&#39;users&#39;);};</code></pre><p>é€šè¿‡ä¸‹é¢è¿™æ¡å‘½ä»¤æ¥åº”ç”¨æˆ‘ä»¬å®šä¹‰çš„å±æ€§ï¼š</p><pre><code class="shell">knex migrate:latest --env development</code></pre><blockquote><p>To run the migration, use the command:</p><pre><code>knex migrate:latest</code></pre><p>The default environment is development, which works for us here, but if you need to specify a different environment, such as a test environment, then you can use the <em>env</em> flag in the migration command like:</p><pre><code>knex migrate:latest --env test</code></pre></blockquote><p><code>development</code> æ˜¯æˆ‘ä»¬äº‹å…ˆåœ¨ <code>knexfile.js</code> é‡Œå®šä¹‰å¥½çš„ã€‚å¯ä»¥ç†è§£ä¸ºå¯¹äº database çš„æ˜ å°„ã€‚ä»ä¸Šé¢å®šä¹‰çš„å±æ€§ä¸­ï¼Œå¯ä»¥å¾ˆè½»æ¾çš„çŸ¥é“è¿™ä¸ª table æœ‰ä¸¤ä¸ª fieldï¼Œåˆ†åˆ«æ˜¯ <code>username</code> å’Œ <code>password</code>ã€‚ä»¥åŠæ¯ä¸ª field çš„å±æ€§éƒ½é€šè¿‡ chain function çš„å½¢å¼æ¥è¡¨è¾¾ã€‚</p><blockquote><p>Similar to migrations, the <code>knex</code> module allows us to create scripts to insert initial data into our tables called seed files! If we have relations on our tables, the seeding <strong>must be in a specific order</strong> to so that we can rely on data that might already be in the database. </p></blockquote><p>seed æ˜¯ç”¨æ¥åˆå§‹åŒ–æ•°æ®çš„ã€‚åŒ migrate ä¸€æ ·ï¼š</p><pre><code class="shell">$ knex seed:make users$ knex seed:run --env development</code></pre><p>line 1 ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª <code>user.js</code> åœ¨è·¯å¾„ <code>./server/db/seeds/</code> é‡Œã€‚line 2 è¿è¡Œè¿™ä¸ª seedsï¼Œå¯¹ table é‡Œæ•°æ®è¿›è¡Œåˆå§‹åŒ–ã€‚</p><h2 id="Mocha-js-Chai-js"><a href="#Mocha-js-Chai-js" class="headerlink" title="Mocha.js ,  Chai.js"></a>Mocha.js ,  Chai.js</h2><p>ä¸€ä¸ªæµ‹è¯• module è¢«ç§°ä¸º specificationï¼Œç®€ç§° specï¼Œç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/images/Mocha_test.png" alt="Mocha_test"></p><p>åœ¨è¿™ç¯‡æ•™ç¨‹ä¸­ï¼Œç”¨åˆ° Mocha å’Œ Chai ä¸¤ä¸ªæµ‹è¯• Libraryã€‚</p><blockquote><ul><li><a href="http://mochajs.org/" target="_blank" rel="noopener">Mocha</a> â€“ the core framework: it provides common testing functions including <code>describe</code> and <code>it</code> and the main function that runs tests.</li><li><a href="http://chaijs.com/" target="_blank" rel="noopener">Chai</a> â€“ the library with many assertions. It allows to use a lot of different assertions, for now we need only <code>assert.equal</code>.</li></ul></blockquote><p>ä½¿ç”¨ Mocha è¿›è¡Œæµ‹è¯•ï¼Œè¿è¡Œ Mochaï¼Œå®ƒä¼šè‡ªåŠ¨æ‰¾é¡¹ç›®ç›®å½•é‡Œ test æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶è¿è¡Œã€‚</p><blockquote><p>Mocha automatically looks for tests inside the <code>**test**</code> directory of your project. Hence, you should go ahead and create this directory in your project root.</p></blockquote><p>ä»¥ä¸‹æ˜¯å†™çš„ä¸€ä¸ªå¾ˆç®€å•çš„å°ä¾‹å­ï¼š</p><pre><code class="javascript">const assert = require(&#39;assert&#39;);describe(&quot;sample&quot;, ()=&gt;{    it(&quot;it&#39;s just a test&quot;, ()=&gt;{        let x = 5;        let result = x;        assert.equal(Math.pow(x, 1), result);    });});</code></pre><p>åœ¨ Terminal é‡Œè¿è¡Œï¼š</p><pre><code class="shell">$ node_modules/.bin/_mocha  sample    âœ“ it&#39;s just a test  1 passing (6ms)</code></pre><p>Chai çš„ä½œç”¨æ˜¯æä¾›äº†æ›´å¤šæµ‹è¯•çš„æ–¹æ³•ã€‚ä¾‹å¦‚æ•™ç¨‹é‡Œæµ‹è¯•æ˜¯å¦ render view æˆåŠŸï¼š</p><pre><code class="javascript">describe(&#39;GET /auth/register&#39;, () =&gt; {  it(&#39;should render the register view&#39;, (done) =&gt; {    chai.request(server)    .get(&#39;/auth/register&#39;)    .end((err, res) =&gt; {      should.not.exist(err);      res.redirects.length.should.eql(0);      res.status.should.eql(200);      res.type.should.eql(&#39;text/html&#39;);      res.text.should.contain(&#39;&lt;h1&gt;Register&lt;/h1&gt;&#39;);      res.text.should.contain(        &#39;&lt;p&gt;&lt;button type=&quot;submit&quot;&gt;Register&lt;/button&gt;&lt;/p&gt;&#39;);      done();    });  });});</code></pre><p>å…¶ä¸»è¦å†…å®¹æ£€æµ‹è¿”å›çš„ res é‡Œæœ‰æ²¡æœ‰æƒ³çš„ DOM Node ã€‚å½“ç„¶ï¼Œå‰æè¿˜æ˜¯å»éªŒè¯è¿”å›ä»£ç æ˜¯å¦æ˜¯ 200ï¼Œ è¿”å›æ–‡æœ¬ç±»å‹è¿™äº›ã€‚</p><h2 id="Redis-Session"><a href="#Redis-Session" class="headerlink" title="Redis, Session"></a>Redis, Session</h2><p>è¿™ç¯‡æ•™ç¨‹çš„æœ€åä»‹ç»äº† redisï¼ŒæŠŠç”¨æˆ·çš„ user ä¿¡æ¯ä» memory ä¸­æ‹¿å‡ºæ¥å­˜è¿› redis é‡Œã€‚è¿™æ ·å½“å…³é—­æµè§ˆå™¨ï¼ŒçŸ­æ—¶é—´å†é‡æ–°æ‰“å¼€æ—¶ï¼Œä¸éœ€è¦é‡æ–°è¾“å…¥ç”¨æˆ·åå¯†ç è¿›è¡Œç™»å½•ã€‚</p><blockquote><p>Itâ€™s a good idea to move session data out of memory and into an external session store as you begin scaling your application.</p></blockquote><p>Redis åŒæ ·ä¹Ÿæ˜¯æ•°æ®åº“ Databaseï¼Œä½†ä¸åŒäºä¹‹å‰æ¥è§¦çš„ MySqlï¼ŒPostgresqlï¼ŒRedis å±äº in-memory databaseã€‚çœ‹äº† Wikipedia çš„è§£é‡Šã€‚in-memory database ä¸»è¦ä¾èµ–äºå†…å­˜ memoryï¼Œè€Œä¸æ˜¯é€šå¸¸çš„å¤–å­˜ storageã€‚</p><p>å…³äº session å’Œ cookie çš„åŒºåˆ«ã€‚</p><p>cookie æ˜¯å­˜å‚¨åœ¨ client ç«¯çš„ï¼Œé€šå¸¸æ˜¯ä¸€äº›åå¥½è®¾å®šï¼Œæ¯”å¦‚é¢œè‰²å•Šç­‰ç­‰ï¼Œé€šå¸¸ä¸ä¼šæœ‰æ•æ„Ÿä¿¡æ¯ã€‚session å­˜å‚¨åœ¨ server ç«¯ï¼Œå› ä¸º http é€šä¿¡æ˜¯æ— çŠ¶æ€çš„ã€‚session ç”¨æ¥ä¿å­˜ client å’Œ server ä¹‹é—´çš„é€šä¿¡çŠ¶æ€ï¼Œä»¥åŠ client å¯èƒ½ä¼šè®¿é—®å¤šä¸ªä¸åŒçš„é¡µé¢ï¼Œè¿™äº›é¡µé¢éƒ½åœ¨è¿™ä¸€ä¸ª server ä¸Šï¼Œé€šä¿¡çš„åŒæ–¹å¹¶æ²¡æœ‰å˜åŒ–ï¼Œé€šè¿‡ session åœ¨ä¸åŒçš„é¡µé¢å…±äº«æ•°æ®ã€‚</p><blockquote><p>A session is a unit of maybe variables, state, settings while a certain user is accessing a server/domain in a specific time frame. All the session information is in the traditional model stored on the server (!)</p><p>Because many concurrent users can visit a server/domain at the same time the server needs to be able to distinguish many different concurrent sessions and always assign the right session to the right user. (And no user may â€œstealâ€ another usesâ€™s session)</p></blockquote><p>è¿™é‡Œé¦–å…ˆç”¨åˆ°ä¸¤ä¸ª middlewareï¼Œkoa-session å’Œ koa-redisã€‚koa-session æ˜¯ koa åŸºç¡€çš„ session ç®¡ç† middlewareã€‚é€šå¸¸ session æ˜¯å­˜å‚¨åœ¨ memory é‡Œçš„ï¼Œé€šè¿‡ koa-redis å°† session å­˜å‚¨åœ¨ redis é‡Œã€‚</p><p>æŠŠ session å­˜å‚¨åœ¨ redis çš„ä¼˜åŠ¿ï¼š</p><blockquote><p>Redis is perfect for storing sessions. All operations are performed in memory, and so reads and writes will be fast. </p><p>The second aspect is persistence of session state. Redis gives you a lot of flexibility in how you want to persist session state to your hard-disk. You can go through <a href="http://redis.io/topics/persistence" target="_blank" rel="noopener">http://redis.io/topics/persistence</a> to learn more, but at a high level, here are your options â€¦</p></blockquote><p>ä¾æ—§æ˜¯é€šè¿‡ brew å®‰è£… redisã€‚</p><p>redis å¯åŠ¨ï¼š</p><pre><code class="shell">$ redis-server /usr/local/etc/redis.conf</code></pre><p>redis å…³é—­ï¼Œç›´æ¥ <code>ctrl</code> + <code>C</code> æˆ–æ˜¯ï¼š</p><pre><code class="shell">$ redis-cli shutdown</code></pre><p>å‚è€ƒï¼š</p><ul><li><a href="https://knexjs.org" target="_blank" rel="noopener">Knex.js</a></li><li><a href="https://medium.com/@jaeger.rob/seed-knex-postgresql-database-with-json-data-3677c6e7c9bc" target="_blank" rel="noopener">Seed Knex PostgreSQL Database with JSON Data</a></li><li><a href="https://github.com/l4nk332/stuff/tree/master/node/Knex" target="_blank" rel="noopener">l4nk332/stuff - Github</a></li><li><a href="https://www.zhihu.com/question/24710451" target="_blank" rel="noopener">ã€Œbatteries-includedã€è¯¥æ€ä¹ˆç¿»è¯‘æ¯”è¾ƒå¥½ï¼Ÿ - çŸ¥ä¹</a></li><li><a href="https://gist.github.com/NigelEarle/70db130cc040cc2868555b29a0278261" target="_blank" rel="noopener">Migrations &amp; Seeding</a></li><li><a href="https://javascript.info/testing-mocha" target="_blank" rel="noopener">Automated testing with mocha</a></li><li><a href="https://stackoverflow.com/questions/12236890/run-mocha-tests-in-test-environment" target="_blank" rel="noopener">Run mocha tests in test environment? - StackOverflow</a></li><li><a href="https://blog.logrocket.com/a-quick-and-complete-guide-to-mocha-testing-d0e0ea09f09d" target="_blank" rel="noopener">A quick and complete guide to Mocha testing</a></li><li><a href="https://stackoverflow.com/questions/623815/what-is-the-difference-between-a-session-and-a-cookie" target="_blank" rel="noopener">What is the difference between a Session and a Cookie? - StackOverflow</a></li><li><a href="https://stackoverflow.com/questions/10278683/how-safe-is-it-to-store-sessions-with-redis" target="_blank" rel="noopener">How safe is it to store sessions with Redis?</a></li><li><a href="https://medium.com/@petehouston/install-and-config-redis-on-mac-os-x-via-homebrew-eb8df9a4f298" target="_blank" rel="noopener">Install and config Redis on Mac OS X via Homebrew</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¸Šå‘¨åœ¨é˜…è¯» &lt;em&gt;Express.js Blueprints&lt;/em&gt; æ—¶çœ‹åˆ° Authentication çš„éƒ¨åˆ†ï¼Œå°±æƒ³ç€ä½¿ç”¨ Koa å»å¤ç°ä¸€éã€‚äºæ˜¯åœ¨ç½‘ä¸Šçœ‹åˆ°è¿™ç¯‡æ–‡ç«  &lt;a href=&quot;https://mherman.org/blog/user-authentication-with-passport-and-koa/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;User Authentication with Passport and Koa&lt;/a&gt; ã€‚æ–‡ç« ç»™å‡ºäº†æºä»£ç å’Œè¯¦ç»†çš„æ­¥éª¤ã€‚å…¶ä¸­ä¸ä¹é‡åˆ°è‡ªå·±ä¸ç†Ÿæ‚‰çš„çŸ¥è¯†é¢†åŸŸï¼Œæ¯”å¦‚ knexï¼Œpostgresql å’Œ redis ç­‰ç­‰ã€‚å†™è¿™ç¯‡æ–‡ç« çš„ç›®çš„ï¼šä¸€æ˜¯ç†Ÿæ‚‰ä¸‹åœ¨ koa æ¡†æ¶ä¸‹çš„ç¨‹åºç»“æ„ï¼›äºŒæ˜¯å¯¹äºè‡ªå·±ä¸ç†Ÿæ‚‰çš„çŸ¥è¯†é¢†åŸŸçš„ä¸€ä¸ªæ€»ç»“ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦é€šè¿‡ brew å®‰è£…ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;postgresql&lt;/li&gt;
&lt;li&gt;redis&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä½¿ç”¨ npm å…¨å±€å®‰è£…ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;knex&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://reyshawn.com/tags/JavaScript/"/>
    
      <category term="Front-end" scheme="http://reyshawn.com/tags/Front-end/"/>
    
      <category term="Node.js" scheme="http://reyshawn.com/tags/Node-js/"/>
    
  </entry>
  
  <entry>
    <title>åˆè§ Koa.js</title>
    <link href="http://reyshawn.com/2019/01/26/%E5%88%9D%E8%A7%81%20Koa/"/>
    <id>http://reyshawn.com/2019/01/26/åˆè§ Koa/</id>
    <published>2019-01-26T11:41:00.000Z</published>
    <updated>2019-01-26T11:48:30.956Z</updated>
    
    <content type="html"><![CDATA[<p>å»ç½‘ä¸Šæ£€ç´¢ Koaï¼Œå¾€å¾€ä¼šçœ‹åˆ°è¯¸å¤š Koa å’Œ Express æ–‡ç« ã€‚Koa çš„ç¡®æ˜¯æ¯” Express æ›´æ–°çš„æ¡†æ¶ï¼Œå› æ­¤ä¹Ÿä½¿ç”¨åˆ°äº† ES6 æ›´æ–°çš„ç‰¹æ€§ï¼Œæ¯”å¦‚ async/awaitã€‚Koa çš„æ ¸å¿ƒ module ä»…ä»…æ˜¯ middleware kernelï¼ŒExpress åˆ™æä¾›äº†ä¸€å¥—å®Œæ•´çš„è§£å†³æ–¹æ¡ˆï¼ŒåŠŸèƒ½ï¼Œroutingï¼Œtemplate è¿™äº›ã€‚Koa è¦ä½¿ç”¨è¿™äº›éœ€è¦å®‰è£…é¢å¤–çš„ moduleã€‚è¿™æ ·çš„å¯¹æ¯”ï¼Œå®¹æ˜“è®©äººè”æƒ³åˆ° editor å’Œ IDE çš„åŒºåˆ«ï¼Œå‰è€…æ³¨é‡è½»é‡ï¼Œå¯å®šåˆ¶ï¼Œåè€…è¿½æ±‚å¤§è€Œå…¨çš„è®¾è®¡ã€‚ä¸¤ç§ä¸åŒçš„è®¾è®¡å“²å­¦ï¼Œæˆ‘æ˜¯åçˆ±å‰è€…ï¼Œç›¸ä¿¡ less is more çš„åŠ›é‡ã€‚å½“ç„¶ï¼Œæ¯•ç«Ÿ Koa å’Œ Express éƒ½æ˜¯æ¥è‡ªäºåŒä¸€ä¸ªå¼€å‘å›¢é˜Ÿï¼Œå¾ˆå¤šåŸºç¡€æ¦‚å¿µæ˜¯ç›¸é€šçš„ã€‚é˜…è¯»æœ¬æ–‡ï¼Œä½ éœ€è¦æå‰äº†è§£ä»¥ä¸‹å†…å®¹ï¼š</p><ul><li>Node.js çš„å¼‚æ­¥ç‰¹æ€§åŠå¼‚æ­¥æ˜¯å¦‚ä½•å®ç°çš„</li><li>å¼‚æ­¥å®ç°çš„å‡ ç§æ–¹å¼ï¼Œcallback åˆ° Promise åˆ° async/await</li><li>ä»€ä¹ˆæ˜¯ middlewareï¼Ÿ</li><li>ejs template engine</li></ul><p>é€šè¿‡æœ¬æ–‡ï¼Œä½ èƒ½äº†è§£åˆ°ã€‚Koa æœ€åŸºç¡€çš„ HelloWorldï¼Œå®ƒ å¦‚ä½•æ¸²æŸ“ä¸€ä¸ª template é¡µé¢ï¼Œä¼ é€’æ•°æ®ã€‚ä»€ä¹ˆæ˜¯ã€ŒRouting è·¯ç”±ã€ï¼Œè·¯ç”±åœ¨ Koa ä¸­å¦‚ä½•å®ç°çš„ã€‚</p><a id="more"></a><h2 id="Hello-world"><a href="#Hello-world" class="headerlink" title="Hello world"></a>Hello world</h2><p><code>app.use()</code> å°±æ˜¯æ·»åŠ ä¸€ä¸ª middlewareã€‚æˆ‘ä»¬é€šè¿‡ Koa è¿›è¡Œçš„è®¸å¤šæ“ä½œï¼Œæ¯”å¦‚å¤„ç† requestï¼Œå¤„ç† dataï¼Œrouting éƒ½æ˜¯é€šè¿‡ <code>app.use()</code> æ¥å®ç°çš„ã€‚</p><p><code>ctx</code> å†…å°è£…äº† request å’Œ response  objectã€‚</p><pre><code class="javascript">const Koa = require(&#39;koa&#39;);const app = new Koa();app.use(async function(ctx) {    ctx.body = &quot;hello world ssss&quot;;})app.listen(3000, function() {    console.log(&#39;listen port: 3000...&#39;)})</code></pre><h2 id="æ¸²æŸ“-ejs-æ¨¡ç‰ˆ"><a href="#æ¸²æŸ“-ejs-æ¨¡ç‰ˆ" class="headerlink" title="æ¸²æŸ“ ejs æ¨¡ç‰ˆ"></a>æ¸²æŸ“ ejs æ¨¡ç‰ˆ</h2><p>è¿™é‡Œä»¥ ejs ä¸ºä¾‹æ¥è¿›è¡Œè¯´æ˜ï¼Œå…¶ä»–çš„ template engineï¼Œä½¿ç”¨æ–¹æ³•éƒ½æ˜¯ç›¸é€šçš„ã€‚</p><p>ä½¿ç”¨ npm å®‰è£…ï¼š</p><pre><code class="shell">$ npm install koa-views --save$ npm install ejs --save</code></pre><p>server.js å†…å®¹æ˜¯</p><pre><code class="javascript">const Koa = require(&#39;koa&#39;);const app = new Koa();const views = require(&#39;koa-views&#39;);app.use(views(__dirname + &#39;/views&#39;, {    map: {        html: &#39;ejs&#39;    }}));app.use(async function(ctx) {    await ctx.render(&#39;layout.ejs&#39;);})app.listen(3000, function() {    console.log(&#39;listen port: 3000...&#39;)})</code></pre><p><code>./views/layout.ejs</code> å†…å®¹æ˜¯</p><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;    &lt;h1&gt;Hello Koa, This is from ejs&lt;/h1&gt;&lt;/body&gt;</code></pre><p>ä¸Šé¢è¿™ä¸ªä¾‹å­æ˜¯ä¸åŒ…å«ä¼ å€¼çš„ï¼Œå½“éœ€è¦å‘ template ä¼ é€’å€¼æ—¶ï¼Œé€šè¿‡ <code>ctx.state</code> æ¥è®¾ç½®ï¼Œå°†ä¸Šé¢ render éƒ¨åˆ†ä¿®æ”¹æˆï¼š</p><pre><code class="javascript">app.use(async function(ctx) {    ctx.state = {        title: &#39;This is title&#39;,        body: &#39;body bla bla&#39;    };    await ctx.render(&#39;layout.ejs&#39;);})</code></pre><p>æˆ–è€…å†™æˆ <code>render</code> çš„å‚æ•°ï¼ŒäºŒè€…æ˜¯ç­‰ä»·çš„ï¼š</p><pre><code class="javascript">app.use(async function(ctx) {    await ctx.render(&#39;layout.ejs&#39;, {        title: &#39;This is title&#39;,        body: &#39;body bla bla&#39;    });})</code></pre><p>æ­¤æ—¶ template ä¿®æ”¹æˆï¼š</p><pre><code class="ejs">&lt;!DOCTYPE html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;    &lt;h1&gt;&lt;%- title %&gt;&lt;/h1&gt;    &lt;p&gt;&lt;%- body %&gt;&lt;/p&gt;&lt;/body&gt;</code></pre><p>é€šå¸¸æˆ‘ä»¬åœ¨å†™ä¸€ä¸ª template çš„æ—¶å€™ï¼Œä¼šåˆ†æˆå¥½å¤šç»„ä»¶ï¼Œé¦–å…ˆæœ‰ä¸€ä¸ªå¤§ä½“çš„æ¡†æ¶ï¼Œlayout.ejsï¼Œæ–°å»ºä¸€ä¸ª partials æ–‡ä»¶å¤¹ï¼Œé‡Œé¢å­˜å‚¨æˆ‘ä»¬æ‰€éœ€çš„å„ä¸ªç»„ä»¶ï¼Œå¦‚ head.ejsï¼Œheader.ejsï¼Œfooter.ejs ç­‰ç­‰ã€‚æˆ‘ä»¬åœ¨ä¸€ä¸ªéœ€è¦æ¸²æŸ“çš„é¡µé¢é‡Œå¼•ç”¨è¿™äº›ç»„ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ªè¿‡ç¨‹åœ¨ koa åº”è¯¥å¦‚ä½•å®ç°å‘¢ï¼Ÿ</p><p>è¿™é‡Œç›´æ¥åœ¨ ejs é‡Œä½¿ç”¨ <code>include</code> è¿›è¡Œå¼•ç”¨ã€‚</p><p>header.ejs</p><pre><code class="html">&lt;header&gt;    &lt;p&gt;This is a header&lt;/p&gt;&lt;/header&gt;</code></pre><p>layout.ejs</p><pre><code class="ejs">&lt;!DOCTYPE html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;    &lt;%- include ./header %&gt;    &lt;h1&gt;&lt;%- title %&gt;&lt;/h1&gt;    &lt;p&gt;&lt;%- body %&gt;&lt;/p&gt;&lt;/body&gt;</code></pre><h2 id="Router-è·¯ç”±åŠŸèƒ½"><a href="#Router-è·¯ç”±åŠŸèƒ½" class="headerlink" title="Router è·¯ç”±åŠŸèƒ½"></a>Router è·¯ç”±åŠŸèƒ½</h2><p>å¯¹äºä¸€ä¸ª web siteï¼Œéœ€è¦å¤„ç†å„ç§å„æ ·ä¸åŒçš„è¯·æ±‚ï¼Œé’ˆå¯¹ä¸åŒçš„è¯·æ±‚ requestï¼Œæœ‰ç€ä¸åŒçš„åé¦ˆ responseï¼Œä»¥åŠå¯èƒ½è¦è°ƒç”¨ä¸åŒçš„èµ„æº resourceã€‚æœ‰äº›éœ€è¦è°ƒç”¨ä¸€äº› javascript æ–‡ä»¶ï¼Œcss æ–‡ä»¶ï¼Œæœ‰äº›éœ€è¦è°ƒç”¨ä¸€äº›å›¾ç‰‡ imagesï¼Œæœ‰äº›éœ€è¦è®¿é—®æ•°æ®åº“ã€‚è¿™äº›ä¸åŒçš„èµ„æº resource æœ‰ç€ä¸åŒçš„å­˜å‚¨è·¯å¾„ï¼Œä¸ºäº†è®© request å¾—åˆ°åˆé€‚çš„åé¦ˆï¼Œå°±éœ€è¦ä¸€ä¸ª router è·¯ç”±åŠŸèƒ½ï¼Œå‘Šè¯‰ serverï¼Œè¿™ä¸ª requestï¼Œéœ€è¦å»å“ªé‡Œæ‰¾ç›¸åº”çš„ resource å»åé¦ˆã€‚</p><p><img src="/images/koa_routing.png" alt="koa_routing"></p><pre><code class="shell">$ npm install koa-router --save</code></pre><p>server.js ä¸­ä¿®æ”¹ä¸ºï¼š</p><pre><code class="javascript">const Router = require(&#39;koa-router&#39;);const router = new Router()router.get(&#39;/&#39;, async function(ctx) {    await ctx.render(&#39;layout.ejs&#39;, {        title: &#39;This is title&#39;,        body: &#39;body bla bla&#39;    });})app.use(router.routes());</code></pre><p>æˆ‘ä»¬çœ‹åˆ°ï¼Œå„ä¸ªé¡µé¢çš„æ¸²æŸ“å®Œå…¨ç”± router è¿›è¡Œäº†æ¥ç®¡ã€‚</p><p>ä¸Šé¢æ˜¯æœ€ç®€å•çš„ â€œGetâ€ è¯·æ±‚ï¼Œä¸‹é¢æ˜¯ç»™å‡ºä¸€ä¸ªâ€Postâ€ è¯·æ±‚çš„ä¾‹å­ï¼Œæ¥è‡ª <a href="https://chenshenhai.github.io/koa2-note/note/request/post.html" target="_blank" rel="noopener">koa2 è¿›é˜¶å­¦ä¹ ç¬”è®°</a>ï¼Œæˆ‘åšäº†ä¸€äº›å°æ”¹åŠ¨ï¼ŒåŸæ–‡ä½¿ç”¨çš„æ˜¯åŸç”Ÿ koa ä¸­çš„ ctx æ¥åˆ¤æ–­è¯·æ±‚ã€‚æˆ‘è¿™é‡Œç›´æ¥ä½¿ç”¨äº† <code>koa-router</code> å®ç°ï¼Œé€šè¿‡å¯¹æ¯”ï¼Œä¹Ÿå¯ä»¥æ˜ç™½ koa-router è¿™ä¸ª module æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œåªä¸è¿‡æ˜¯åœ¨åŸç”Ÿ Koa åŸºç¡€ä¸Šå¢åŠ äº†ä¸€å±‚åˆ¤æ–­ã€‚</p><pre><code class="javascript">// receive the posting datafunction parsePostData(ctx) {    return new Promise((resolve, reject) =&gt; {        try {            let postData = &quot;&quot;;            ctx.req.addListener(&#39;data&#39;, (data) =&gt; {                postData += data;            });            ctx.req.addListener(&#39;end&#39;, () =&gt; {                let parseData = parseQueryStr(postData);                resolve(parseData);            });        } catch(err) {            reject(err);        }    })}// convert the posting data to Objectfunction parseQueryStr(data) {    let queryData = {};    let queryStrList = data.split(&#39;&amp;&#39;);    for (let queryStr of queryStrList) {        let itemList = queryStr.split(&#39;=&#39;);        queryData[ itemList[0] ] = decodeURIComponent(itemList[1]);    }    return queryData;}app.use(views(__dirname + &#39;/views&#39;, {    map: {        html: &#39;ejs&#39;    }}));router.get(&#39;/&#39;, async function(ctx) {    await ctx.render(&#39;layout.ejs&#39;, {        data: &#39;no data posted&#39;    });})router.post(&#39;/&#39;, async function(ctx) {    let postData = await parsePostData(ctx);    await ctx.render(&#39;layout.ejs&#39;, {        data: JSON.stringify(postData)    })})app.use(router.routes());</code></pre><p>layout.ejs æ·»åŠ ä¸€ä¸ªå¯ä»¥æäº¤çš„è¡¨æ ¼ï¼Œæ³¨æ„è¡¨æ ¼çš„ <code>method</code> æ˜¯ <code>POST</code>ï¼Œ<code>action</code> æ˜¯æ ¹ç›®å½•é¡µé¢ <code>&quot;/&quot;</code>ã€‚ </p><pre><code class="ejs">&lt;!DOCTYPE html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;    &lt;%- include ./header %&gt;    &lt;h1&gt;koa2 request post demo&lt;/h1&gt;      &lt;form method=&quot;POST&quot; action=&quot;/&quot;&gt;            &lt;p&gt;userName&lt;/p&gt;            &lt;input name=&quot;userName&quot; /&gt;&lt;br/&gt;            &lt;p&gt;nickName&lt;/p&gt;            &lt;input name=&quot;nickName&quot; /&gt;&lt;br/&gt;            &lt;p&gt;email&lt;/p&gt;            &lt;input name=&quot;email&quot; /&gt;&lt;br/&gt;            &lt;button type=&quot;submit&quot;&gt;submit&lt;/button&gt;      &lt;/form&gt;      &lt;p&gt;&lt;%- data %&gt;&lt;p&gt;&lt;/body&gt;</code></pre>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å»ç½‘ä¸Šæ£€ç´¢ Koaï¼Œå¾€å¾€ä¼šçœ‹åˆ°è¯¸å¤š Koa å’Œ Express æ–‡ç« ã€‚Koa çš„ç¡®æ˜¯æ¯” Express æ›´æ–°çš„æ¡†æ¶ï¼Œå› æ­¤ä¹Ÿä½¿ç”¨åˆ°äº† ES6 æ›´æ–°çš„ç‰¹æ€§ï¼Œæ¯”å¦‚ async/awaitã€‚Koa çš„æ ¸å¿ƒ module ä»…ä»…æ˜¯ middleware kernelï¼ŒExpress åˆ™æä¾›äº†ä¸€å¥—å®Œæ•´çš„è§£å†³æ–¹æ¡ˆï¼ŒåŠŸèƒ½ï¼Œroutingï¼Œtemplate è¿™äº›ã€‚Koa è¦ä½¿ç”¨è¿™äº›éœ€è¦å®‰è£…é¢å¤–çš„ moduleã€‚è¿™æ ·çš„å¯¹æ¯”ï¼Œå®¹æ˜“è®©äººè”æƒ³åˆ° editor å’Œ IDE çš„åŒºåˆ«ï¼Œå‰è€…æ³¨é‡è½»é‡ï¼Œå¯å®šåˆ¶ï¼Œåè€…è¿½æ±‚å¤§è€Œå…¨çš„è®¾è®¡ã€‚ä¸¤ç§ä¸åŒçš„è®¾è®¡å“²å­¦ï¼Œæˆ‘æ˜¯åçˆ±å‰è€…ï¼Œç›¸ä¿¡ less is more çš„åŠ›é‡ã€‚å½“ç„¶ï¼Œæ¯•ç«Ÿ Koa å’Œ Express éƒ½æ˜¯æ¥è‡ªäºåŒä¸€ä¸ªå¼€å‘å›¢é˜Ÿï¼Œå¾ˆå¤šåŸºç¡€æ¦‚å¿µæ˜¯ç›¸é€šçš„ã€‚é˜…è¯»æœ¬æ–‡ï¼Œä½ éœ€è¦æå‰äº†è§£ä»¥ä¸‹å†…å®¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Node.js çš„å¼‚æ­¥ç‰¹æ€§åŠå¼‚æ­¥æ˜¯å¦‚ä½•å®ç°çš„&lt;/li&gt;
&lt;li&gt;å¼‚æ­¥å®ç°çš„å‡ ç§æ–¹å¼ï¼Œcallback åˆ° Promise åˆ° async/await&lt;/li&gt;
&lt;li&gt;ä»€ä¹ˆæ˜¯ middlewareï¼Ÿ&lt;/li&gt;
&lt;li&gt;ejs template engine&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é€šè¿‡æœ¬æ–‡ï¼Œä½ èƒ½äº†è§£åˆ°ã€‚Koa æœ€åŸºç¡€çš„ HelloWorldï¼Œå®ƒ å¦‚ä½•æ¸²æŸ“ä¸€ä¸ª template é¡µé¢ï¼Œä¼ é€’æ•°æ®ã€‚ä»€ä¹ˆæ˜¯ã€ŒRouting è·¯ç”±ã€ï¼Œè·¯ç”±åœ¨ Koa ä¸­å¦‚ä½•å®ç°çš„ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://reyshawn.com/tags/JavaScript/"/>
    
      <category term="Front-end" scheme="http://reyshawn.com/tags/Front-end/"/>
    
      <category term="Node.js" scheme="http://reyshawn.com/tags/Node-js/"/>
    
  </entry>
  
  <entry>
    <title>å¼‚æ­¥ &amp; callback</title>
    <link href="http://reyshawn.com/2019/01/25/%E5%BC%82%E6%AD%A5%20&amp;%20callback/"/>
    <id>http://reyshawn.com/2019/01/25/å¼‚æ­¥ &amp; callback/</id>
    <published>2019-01-25T03:27:39.896Z</published>
    <updated>2019-01-25T08:52:18.896Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘å¼€å§‹å­¦ä¹  Node.jsã€‚ä¸»è¦çœ‹ä¸¤æœ¬ä¹¦ï¼š<em>Node.js in Practice</em> å’Œ <em>Node.js Design Patterns</em>ã€‚å‰è€…ç±»ä¼¼äº oâ€™reilly çš„ cookbook ç³»åˆ—ï¼Œæ•´æœ¬ä¹¦çš„ç¼–æ’æ˜¯é€šè¿‡ä¸€ä¸ªä¸ª recipeï¼Œä¸€ä¸ªä¸ªå…·ä½“çš„ problem&amp;solution å®ç°çš„ã€‚åè€…å°±æ˜¯ <a href="https://search.packtpub.com/" target="_blank" rel="noopener">Packt Publishing</a> å‡ºå“çš„ä¸€ç³»åˆ— Design Patterns ä¹¦ç±ã€‚åŒ…æ‹¬è¿™ä¸¤æœ¬ä¹¦åœ¨å†…çš„è®¸å¤šè®²è§£ Node.js çš„ä¹¦ç±ï¼Œéƒ½ä¼šä¸æ–­å¼ºè°ƒä¸¤ä¸ªå…³é”®è¯ï¼Œ asynchronous å’Œ non-blocking I/Oã€‚åœ¨æœ€åˆå¼€å§‹å­¦ä¹ ç¼–ç¨‹çš„æ—¶å€™ï¼Œæ— è®ºæ˜¯å†™ä¸€äº›ç®—æ³•é¢˜ç›®ï¼Œæˆ–æ˜¯åšä¸€äº›æœ¬åœ°æµ‹è¯•ï¼Œå®ƒéƒ½æ˜¯åŒæ­¥çš„ï¼Œå³æ—¶å“åº”çš„ï¼Œå•çº¿ç¨‹çš„ï¼Œblocking I/Oã€‚ä½†å¦‚æœè¿›å…¥çš„ç½‘ç»œé¢†åŸŸï¼Œã€Œå¼‚æ­¥ã€åˆ™ä¼šè¢«ä¸æ–­æèµ·ã€‚ç›¸æ¯” synchronousï¼Œã€Œå¼‚æ­¥ã€æ›´åŠ æ¥è¿‘æˆ‘ä»¬ç›¸å¤„çš„çœŸå®ä¸–ç•Œã€‚</p><p>è¿™ç¯‡æ–‡ç« ä»¥ <em>Node.js Design Patterns</em> ç¬¬äºŒç« çš„ Web Spider ä¾‹å­ï¼Œæ¢ç©¶æ€è€ƒåœ¨ Node.js ä¸­æ˜¯å¦‚ä½•é€šè¿‡ callback æ¥å®ç°å¼‚æ­¥æ“ä½œçš„ã€‚</p><a id="more"></a><h2 id="callbackï¼Œé€’å½’ï¼Œlibuv"><a href="#callbackï¼Œé€’å½’ï¼Œlibuv" class="headerlink" title="callbackï¼Œé€’å½’ï¼Œlibuv"></a>callbackï¼Œé€’å½’ï¼Œlibuv</h2><blockquote><p>Callbacks are to be used when we donâ€™t know <strong>when</strong> something will be done. Again, think of something like an API call, fetching data from a database or I/O with the hard drive.</p><p>â€“<a href="https://medium.com/javascript-in-plain-english/callbacks-in-node-js-how-why-when-ac293f0403ca" target="_blank" rel="noopener">Callbacks in Node.js: Why, When, How?</a></p></blockquote><p>åœ¨è§£å†³ä¸€äº›ç®—æ³•é¢˜ç›®æ—¶ï¼Œç»å¸¸ä¼šç”¨åˆ°ã€Œé€’å½’ã€ã€‚ã€Œé€’å½’ã€æ˜¯å‡½æ•°ä¸æ–­è°ƒç”¨è‡ªèº«çš„è¿‡ç¨‹ã€‚callback å’Œã€Œé€’å½’ã€æœ‰äº›ç›¸ä¼¼ï¼ŒåŒºåˆ«æ˜¯ï¼Œã€Œé€’å½’ã€æ˜¯é‡å¤çš„è°ƒç”¨è‡ªèº«ï¼Œè€Œ callback æ˜¯å»è°ƒç”¨å¦ä¸€ä¸ªä¸åŒçš„å‡½æ•°ã€‚æœ¬è´¨æ¥è®²ï¼Œéƒ½ä¼šå½¢æˆä¸€ä¸ª  <a href="http://www.wikiwand.com/en/Call_stack" target="_blank" rel="noopener">Call stack</a>ã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆå¯ä»¥é€šè¿‡ callback æ¥å®ç°å¼‚æ­¥ï¼Ÿ</p><pre><code class="javascript">// This is synchronous.function processData() {       let data = fetchData();       data += 1;       return data; }// This is asynchronous... function processData(callback) {       fetchData(function (err, data) {             if (err) {           return callback(err);        }             data += 1;             callback(null, data);       }); }</code></pre><p>åœ¨  synchronous ä¸­ï¼Œline 3 è·å¾—æ•°æ®ï¼Œå­˜å‚¨åœ¨ data ä¸­ï¼Œline 4 å¯¹æ•°æ®è¿›è¡Œå¤„ç†ã€‚è¿™æ˜¯ä¸€ä¸ªçº¿æ€§çš„ï¼Œå•çº¿ç¨‹çš„ï¼Œéœ€è¦ç­‰å¾…çš„ synchronous æ“ä½œã€‚åœ¨ async ä¸­ï¼Œå‡½æ•° <code>fetchData()</code> å¤šäº†ä¸€ä¸ª callback å‚æ•°ï¼Œåç»­çš„æ•°æ®å¤„ç†ï¼Œ<code>data += 1</code> å†™åœ¨äº†è¿™ä¸ª callback é‡Œã€‚ä¹Ÿå°±æ„å‘³ç€ï¼Œå½“è°ƒç”¨ <code>fetchData()</code> åï¼Œæ•´ä¸ªç¨‹åºä¸ä¼šåœä¸‹æ¥ç­‰å¾…ï¼Œè€Œæ˜¯æ¥ç€è¿›è¡Œä¸‹é¢çš„æ“ä½œã€‚å½“ <code>fetchData()</code> ä¸­è·å¾—äº†æ•°æ®ï¼Œæ›´æŠ½è±¡ç‚¹ï¼Œæ˜¯è¾¾æˆäº†æŸä¸ªæ¡ä»¶ï¼Œåˆ™è°ƒç”¨ callback å‡½æ•°ã€‚</p><blockquote><p>Callbacks are functions. You pass them to other functions so they can be executed when the time is right, i.e. when the event needed by the callback has happened.</p><p>â€“<a href="https://medium.com/javascript-in-plain-english/callbacks-in-node-js-how-why-when-ac293f0403ca" target="_blank" rel="noopener">Callbacks in Node.js: Why, When, How?</a></p></blockquote><p>çœ‹ä¼¼åœ¨ async ä¸­å‡ºç°äº†ç¬¬äºŒæ¡çº¿ç¨‹ï¼Œå®é™…ä¸Šï¼Œåœ¨ Node.js ä¸­ä¾æ—§æ˜¯å•çº¿ç¨‹ã€‚é€šè¿‡å•çº¿ç¨‹ï¼Œæ¥æ¨¡æ‹Ÿå¤šçº¿ç¨‹ä¸‹çš„ concurrencyï¼Œå€ŸåŠ©åº•å±‚åº“ <code>libuv</code> æ¥å®ç°ã€‚<code>libuv</code> è®© Node.js æœ‰äº† non-blocking I/O ç‰¹æ€§ã€‚</p><blockquote><p>For example, in Unix, regular filesystem files do not support non-blocking operations, so, in order to simulate a non-blocking behavior, it is necessary to use a separate thread outside the Event Loop. All these inconsistencies across and within the different operating systems required a higher-level abstraction to be built for the Event Demultiplexer. This is exactly why the Node.js core team created a C library called libuv, with the objective to make Node.js compatible with all the major platforms and normalize the non-blocking behavior of the different types of resource; libuv today represents the low-level I/O engine of Node.js.</p><p>â€“ p17 <em>Node.js Design Patterns</em></p></blockquote><blockquote><p>This may sound strange if we consider that Node.js is single threaded, but if we remember what we discussed in Chapter 1, Node.js Design Fundamentals, we realize that even though we have just one thread, we can still achieve concurrency, thanks to the nonblocking nature of Node.js.</p><p>â€“p71 <em>Node.js Design Patterns</em></p></blockquote><blockquote><p>æ¯ä¸ªæˆ‘ä»¬å¸¸è§çš„æ“ä½œç³»ç»Ÿéƒ½ä¸ºæˆ‘ä»¬å°è£…äº†ç±»ä¼¼çš„é«˜å¹¶å‘å¼‚æ­¥æ¨¡å‹ï¼Œé‚£libuvå…¶å®å°±æ˜¯å¯¹å„ä¸ªæ“ä½œç³»ç»Ÿè¿›è¡Œå°è£…ï¼Œæœ€åæš´éœ²å‡ºç»Ÿä¸€çš„apiä¾›å¼€å‘è€…è°ƒç”¨ï¼Œå¼€å‘è€…ä¸éœ€è¦å…³ç³»åº•å±‚æ˜¯ä»€ä¹ˆæ“ä½œç³»ç»Ÿï¼Œä»€ä¹ˆAPIäº†ã€‚ </p><p>â€“<a href="https://zhuanlan.zhihu.com/p/50480439" target="_blank" rel="noopener">libuv â€” çŸ¥ä¹ä¸“æ </a></p></blockquote><p>è¿™é‡Œå•çº¿ç¨‹æ¨¡æ‹Ÿå¤šçº¿ç¨‹çš„åŸç†ï¼Œå’Œè®¡ç®—æœºä¸­å®ç°çš„ concurrency å·®ä¸å¤šã€‚å› ä¸ºåœ¨è®¡ç®—æœºä¸­ï¼Œå¦‚æœä»å•ä¸ªæ—¶é’Ÿæ¥çœ‹ï¼Œè®¡ç®—æœºåªèƒ½å®Œæˆä¸€æ¡å‘½ä»¤ã€‚è€Œå€ŸåŠ©è¯¸å¦‚ time shared åˆ†æ—¶ç³»ç»Ÿç­‰ç­‰ï¼Œåœ¨ä¸€æ®µæ—¶é—´å†…å¯ä»¥è®¤ä¸ºè®¡ç®—æœºåŒæ—¶ã€Œå¹¶å‘ã€åœ°åœ¨è¿›è¡Œå¤šä¸ªä»»åŠ¡ã€‚å› æ­¤ï¼Œåœ¨ Node.js ç”±äºæœ‰äº† <code>libuv</code>ï¼Œä¼šè®©æœ‰ç€ callback çš„å‡½æ•°ä¼šè¿›è¡Œã€Œå¼‚æ­¥ã€æ“ä½œã€‚</p><blockquote><p>So why show you this? Because you canâ€™t just call one function after another and hope they execute in the right order. Callbacks are a way to make sure certain code doesnâ€™t execute until other code has already finished execution.</p><p>â€“<a href="https://codeburst.io/javascript-what-the-heck-is-a-callback-aba4da2deced" target="_blank" rel="noopener">JavaScript: What the heck is a Callback?</a></p></blockquote><p>å…³äº callback çš„ä½¿ç”¨ï¼Œæ˜¯æœ‰ä¸€äº› conventions çš„ã€‚æ¯”å¦‚ callback çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ errorã€‚callback æœ¬èº«ä½œä¸ºå‡½æ•°å‚æ•°ï¼Œé€šå¸¸æ”¾åœ¨æœ€åä¸€ä¸ªã€‚</p><blockquote><p>Nearly everything in node.js is asynchronous. So, nearly every method that is called, you must specify a callback method to handle the result of the method call. Normally, the callback function takes two parameters: error, result. So it is up to you to check for the error and then handle the result. </p><p>â€“ <a href="https://stackoverflow.com/questions/13789095/understanding-node-js-callback-structure" target="_blank" rel="noopener">understanding node.js callback structure</a></p></blockquote><h2 id="Web-Spider-çš„-callback-å®ç°"><a href="#Web-Spider-çš„-callback-å®ç°" class="headerlink" title="Web Spider çš„ callback å®ç°"></a>Web Spider çš„ callback å®ç°</h2><p>åœ¨ <em>Node.js Design Patterns</em> è¿™æœ¬ä¹¦çš„ç¬¬äºŒç« èŠ‚ï¼Œä½œè€…é€šè¿‡ web spider è¿™ä¸ªä¾‹å­ï¼Œä»‹ç»äº† async åœ¨ node é‡Œçš„å„ç§å®ç°æ–¹æ¡ˆã€‚æœ‰æœ€åŸç”Ÿçš„ callback hellï¼Œæ”¹è‰¯åçš„ callbackï¼Œä¹Ÿæœ‰ asyncï¼ŒPromiseï¼Œgenerator ç­‰ç­‰æ›´åŠ ç®€å•çš„å†™æ³•ã€‚æ— è®ºä½¿ç”¨å“ªç§æ–¹å¼ï¼Œä¼šç”¨åˆ° <code>fs.stat(path, callback)</code> å’Œ <code>request(url, callback)</code>[^1]ã€‚å‰è€…æ˜¯ Node.js è‡ªèº«çš„å…³äºæ–‡ä»¶æ“ä½œçš„ä¸€ç³»åˆ— apiï¼Œåè€…æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹ moduleã€‚å› ä¸ºè¿™ä¸¤ä¸ªå‡½æ•°éƒ½ç”¨åˆ°äº† callbackï¼Œæ‰€ä»¥åœ¨ debug æ¨¡å¼ä¸‹ï¼Œå°±å»æ›´æ·±ä¸€å±‚çœ‹çœ‹æ˜¯å¦‚ä½•è¿ä½œçš„ã€‚Web Spider çš„å‡½æ•°æºç å·²é™„åœ¨äº†å‚è€ƒé“¾æ¥é‡Œã€‚</p><pre><code class="javascript">function download(url, filename, callback) {  console.log(`Downloading ${url}`);  request(url, (err, response, body) =&gt; {    if(err) {      return callback(err);    }    saveFile(filename, body, err =&gt; {      if(err) {        return callback(err);      }      console.log(`Downloaded and saved: ${url}`);      callback(null, body);    });  });}function spider(url, callback) {  const filename = utilities.urlToFilename(url);  fs.stat(filename, err =&gt; {    if(!err) {      return callback(null, filename, false);    }    download(url, filename, err =&gt; {      if(err) {        return callback(err);      }      callback(null, filename, true);    })  });}</code></pre><h3 id="fs-stat"><a href="#fs-stat" class="headerlink" title="fs.stat()"></a>fs.stat()</h3><p>é¦–å…ˆè¿›å…¥ <code>fs.stat()</code> å‡½æ•°ï¼š</p><pre><code class="javascript">function stat(path, options, callback) {  if (typeof options === &#39;function&#39;) {    callback = options;    options = {};  }  callback = makeStatsCallback(callback);  path = toPathIfFileURL(path);  validatePath(path);  const req = new FSReqCallback(options.bigint);  req.oncomplete = callback;  binding.stat(pathModule.toNamespacedPath(path), options.bigint, req);}</code></pre><p>line 2 åˆ° line 5 æ˜¯å‚æ•°åˆ¤æ–­å’Œè½¬æ¢ã€‚line 6 <code>makeStatsCallback(callback)</code>ï¼Œè°ƒç”¨ï¼š</p><pre><code class="Javascript">// Special case of `makeCallback()` that is specific to async `*stat()` calls as// an optimization, since the data passed back to the callback needs to be// transformed anyway.function makeStatsCallback(cb) {  if (typeof cb !== &#39;function&#39;) {    throw new ERR_INVALID_CALLBACK();  }  return (err, stats) =&gt; {    if (err) return cb(err);    cb(err, getStatsFromBinding(stats));  };}</code></pre><p>æŒ‰ç…§æ³¨é‡Šè¯´æ˜ï¼Œæ˜¯ <code>makeCallback()</code> çš„ç‰¹æ®Šæƒ…å†µï¼Œé‚£æˆ‘ä»¬å°±å»çœ‹çœ‹ <code>makeCallback()</code> æ˜¯ä»€ä¹ˆã€‚</p><pre><code class="javascript">// Ensure that callbacks run in the global context. Only use this function// for callbacks that are passed to the binding layer, callbacks that are// invoked from JS already run in the proper scope.function makeCallback(cb) {  if (typeof cb !== &#39;function&#39;) {    throw new ERR_INVALID_CALLBACK();  }  return (...args) =&gt; {    return Reflect.apply(cb, undefined, args);  };}</code></pre><p>è¿™æ®µ code  çš„å…³é”®æ˜¯ <code>Reflect.apply(cb, undefined, args);</code>ã€‚æŒ‰ç…§ MDN çš„å™è¿°ï¼Œ<code>Reflect</code> æ˜¯ï¼š</p><blockquote><p><strong>Reflect</strong> is a built-in object that provides methods for interceptable JavaScript operations. The methods are the same as those of <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy/handler" target="_blank" rel="noopener">proxy handlers</a>. <code>Reflect</code> is not a function object, so itâ€™s not constructible.</p><p>Unlike most global objects, <code>Reflect</code> is not a constructor. You cannot use it with a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/new" target="_blank" rel="noopener"><code>new</code>operator</a> or invoke the <code>Reflect</code> object as a function. All properties and methods of <code>Reflect</code>are static (just like the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math" target="_blank" rel="noopener"><code>Math</code></a> object).</p></blockquote><p>Reflect æ˜¯ä¸€ä¸ª global objectã€‚é‚£ä¹ˆå½“è°ƒç”¨ <code>Reflect.apply()</code>ï¼Œå°±æ˜¯åœ¨ global context ä¸‹è¿›è¡Œçš„ã€‚ä¸ºä»€ä¹ˆéœ€è¦ global context å‘¢ï¼Ÿé¦–å…ˆæƒ³ä»€ä¹ˆæ—¶å€™ä¼šå»è°ƒç”¨ callbackï¼Œå¾€å¾€æ˜¯ error handlingï¼Œå‡ºé”™çš„æ—¶å€™ï¼Œæˆ–è€…æ˜¯è¿›è¡Œæœ€åä¸€æ­¥å·¥ä½œçš„æ—¶å€™ã€‚ä¸¤ç§æƒ…å†µï¼Œæ— è®ºæ˜¯å“ªä¸€ç§ï¼Œç¨‹åºéƒ½è¦ä»ä¸ç®¡å¤šæ·±çš„ call stack å‡ºæ¥ï¼Œå›åˆ°åœ°é¢ï¼Œå›åˆ° global contextï¼Œå» handle errorï¼Œæˆ–æ˜¯è¿›è¡Œæ‰€æœ‰å‰æå·¥ä½œç»“æŸåçš„ä¸‹ä¸€æ­¥å·¥ä½œã€‚</p><p><code>makeStatsCallback(callback)</code>ä¹‹åå…³é”®çš„ä¸‰æ­¥æ˜¯ï¼š</p><pre><code class="javascript">const req = new FSReqCallback(options.bigint);req.oncomplete = callback;binding.stat(pathModule.toNamespacedPath(path), </code></pre><p><code>FSReqCallback</code> å’Œ <code>binding</code> éƒ½æ˜¯å¯¹æ›´åº•å±‚çš„ C library è°ƒç”¨ã€‚</p><pre><code class="javascript">const binding = process.binding(&#39;fs&#39;);const { FSReqCallback, statValues } = binding;</code></pre><p>ä»è¿™é‡Œå¼€å§‹ï¼Œå°±é€æ¸è¿›å…¥ <code>libuv</code> ï¼ŒC library çš„é¢†åŸŸäº†ã€‚åœ¨è¿™äº› C library ä¸­åšäº†ä»€ä¹ˆäº‹æƒ…ï¼Œä»¥æˆ‘ç›®å‰çš„çŸ¥è¯†ç»“æ„å°±å¾ˆéš¾ç†è§£äº†ã€‚åªæ˜¯å¤§ä½“ä¸Šï¼Œåº”è¯¥æ˜¯è®¾ç½®å¼‚æ­¥æ“ä½œï¼Œè§„å®šåœ¨å‡½æ•°ç»“æŸåå»æ‰§è¡Œ callback ç­‰ç­‰ï¼Œå°±å¦‚è¿™å¥ <code>req.oncomplete = callback;</code> å­—é¢å«ä¹‰æ‰€å†™çš„é‚£æ ·ã€‚</p><h3 id="request"><a href="#request" class="headerlink" title="request"></a>request</h3><p>request æ˜¯ä¸€ä¸ªç®€å•çš„ Http clientã€‚è¿™æ˜¯å®ƒä»¬çš„ <a href="https://github.com/request/request" target="_blank" rel="noopener">Git repo</a>ã€‚web spider çš„ç›®æ ‡å°±æ˜¯è¦ä¸‹è½½ç›®æ ‡ url çš„å†…å®¹ã€‚åœ¨ä¸Šä¸€å°èŠ‚ï¼Œæˆ‘ä»¬é€šè¿‡ <code>fs.stat()</code> æ¥æ£€æµ‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚å½“æ£€æµ‹åˆ°æ–‡ä»¶ä¸å­˜åœ¨çš„æ—¶å€™ï¼Œåˆ™å¯¹ç›®æ ‡ url è¿›è¡Œä¸‹è½½ã€‚ä¸‹è½½è¿™ä¸ªåŠ¨ä½œï¼Œå±•å¼€æ¥è®²ï¼Œé¦–è¦å·¥ä½œå°±æ˜¯åˆ›å»ºä¸€ä¸ª http clinetï¼Œæ¥å‘ server å‘é€è¯·æ±‚ï¼Œç„¶åæ¥æ”¶æ¥è‡ª server è¿”å›çš„æ•°æ®ã€‚å³ <code>body</code> å†…å®¹ã€‚è¿™äº›æ“ä½œï¼Œéƒ½æ˜¯é€šè¿‡ <code>request</code> è¿™ä¸ª module æ¥å®ç°çš„ã€‚åˆ›å»ºçš„ http client å°±å¯ç±»æ¯”æµè§ˆå™¨ï¼Œå½“å®ƒå‘é€ request è¯·æ±‚æ—¶ï¼Œéœ€è¦æŒ‰ç…§ TCP/IP åè®®ï¼ŒåŠ å…¥ headï¼Œè®¾ç½® tunnelï¼Œredirect ç­‰ç­‰å†…å®¹ã€‚è¿™äº›æ˜¯é€šè¿‡ <code>request.Request(params)</code> æ¥å®ç°çš„ã€‚</p><pre><code class="javascript">function request (uri, options, callback) {  if (typeof uri === &#39;undefined&#39;) {    throw new Error(&#39;undefined is not a valid uri or options object.&#39;)  }  var params = initParams(uri, options, callback)  if (params.method === &#39;HEAD&#39; &amp;&amp; paramsHaveRequestBody(params)) {    throw new Error(&#39;HTTP HEAD requests MUST NOT include a request body.&#39;)  }  return new request.Request(params)}</code></pre><p>line 6 å¯¹å‚æ•°è¿›è¡Œåˆå§‹åŒ–ï¼š</p><pre><code class="javascript">// organize params for patch, post, put, head, delfunction initParams (uri, options, callback) {  if (typeof options === &#39;function&#39;) {    callback = options  }  var params = {}  if (typeof options === &#39;object&#39;) {    extend(params, options, {uri: uri})  } else if (typeof uri === &#39;string&#39;) {    extend(params, {uri: uri})  } else {    extend(params, uri)  }  params.callback = callback || params.callback  return params}</code></pre><p><code>request()</code> å‡½æ•°è¿”å›çš„  <code>request.Request(params)</code>  å¦‚ä¸‹ï¼š</p><pre><code class="javascript">function Request (options) {  // if given the method property in options, set property explicitMethod to true  // extend the Request instance with any non-reserved properties  // remove any reserved functions from the options object  // set Request instance to be readable and writable  // call init  var self = this  // start with HAR, then override with additional options  if (options.har) {    self._har = new Har(self)    options = self._har.options(options)  }  stream.Stream.call(self)  var reserved = Object.keys(Request.prototype)  var nonReserved = filterForNonReserved(reserved, options)  extend(self, nonReserved)  options = filterOutReservedFunctions(reserved, options)  self.readable = true  self.writable = true  if (options.method) {    self.explicitMethod = true  }  self._qs = new Querystring(self)  self._auth = new Auth(self)  self._oauth = new OAuth(self)  self._multipart = new Multipart(self)  self._redirect = new Redirect(self)  self._tunnel = new Tunnel(self)  self.init(options)}</code></pre><p>æ³¨æ„ä¸€ä¸‹ line 17ï¼Œ<code>stream.Stream.call(self)</code>ï¼Œåœ¨è¿›å…¥è¿™ä¸ªå‡½æ•°å†…éƒ¨åï¼Œæ¥åˆ°ï¼š</p><pre><code class="javascript">// legacy.jsconst EE = require(&#39;events&#39;);const util = require(&#39;util&#39;);function Stream() {  EE.call(this);}</code></pre><p>å› ä¸º EE æ˜¯æ¥è‡ª events å¯¼å‡ºçš„ EventEmitterï¼Œ<code>EE.call(this)</code> å®é™…ä¸Šæ˜¯å¯¹ EventEmitter çš„åˆå§‹åŒ–ã€‚åˆ°è¿™é‡Œä¼šå‘ç°ï¼Œrequest å¤„ç† callback æ‰€ä½¿ç”¨çš„æ–¹å¼ï¼Œæ˜¯å’Œ EventEmitter ç›¸å…³çš„ã€‚å…·ä½“çš„ç»§æ‰¿å…³ç³»æ˜¯ï¼š</p><p><code>EventEmitter</code> &lt;- <code>stream.Stream</code> &lt;- <code>Request</code></p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>è¿™ç¯‡æ–‡ç« æœ€åˆæ˜¯æƒ³å¼„æ¸…æ¥š <code>fs</code> å’Œ <code>request</code> æ˜¯æ€ä¹ˆå¤„ç† callback å‡½æ•°ï¼Œæ˜¯å¦‚ä½•å»è°ƒç”¨çš„ï¼Œä¸€è·¯ debug ä¸‹å»ï¼Œç»ˆå½’ç»•ä¸å¼€ <code>libuv</code> ï¼Œè®¡ç®—æœºåº•å±‚å…³äº thread çš„å†…å®¹ä»¥åŠç½‘ç»œæ–¹é¢çš„ TCP/IP åè®®ã€‚è¿™ä¸¤æ–¹é¢éƒ½æ˜¯æˆ‘çš„çŸ¥è¯†å¼±é¡¹ï¼Œå› æ­¤ä¹Ÿå°±åœ¨åˆé€‚çš„åœ°æ–¹æµ…å°è¾„æ­¢äº†ã€‚å½“ç„¶ï¼Œå†™è¿™ç¯‡æ–‡ç« ä¹Ÿè®©æˆ‘å¯¹äº callback æœ‰äº†æ›´æ·±çš„ç†è§£ä¹‹å¤–ï¼ŒåŒæ—¶ï¼Œæˆ‘æƒ³å¿…è¦æŠ½æ—¶é—´å†å»å¥½å¥½è¯»è¯» CSAPP å’Œ TCP/IP é‚£ä¸¤æœ¬ä¹¦äº†ã€‚</p><p>[^1]: åŸæ–‡åˆ¤æ–­æ–‡ä»¶å­˜åœ¨ç”¨çš„æ˜¯ <code>fs.exists()</code>ï¼Œä½†è¿™ä¸ªå‡½æ•°ï¼Œåœ¨æˆ‘æŸ¥é˜… Node.js Documentation æ—¶å‘ç°å·²ç» deprecatedï¼Œæ‰€ä»¥ç¨å¾®ä¿®æ”¹äº†ä¸€ä¸‹ã€‚</p><hr><p>å‚è€ƒï¼š</p><ul><li><a href="https://medium.com/javascript-in-plain-english/callbacks-in-node-js-how-why-when-ac293f0403ca" target="_blank" rel="noopener">Callbacks in Node.js: Why, When, How?</a></li><li><a href="https://stackoverflow.com/questions/24042861/nodejs-what-does-process-binding-mean" target="_blank" rel="noopener">Nodejs: What does <code>process.binding</code> mean?</a></li><li><a href="https://zhuanlan.zhihu.com/p/40977678" target="_blank" rel="noopener">æ·±å…¥å‡ºä¸æ¥nodejsæºç -ä»fs.statçœ‹nodeæ¶æ„</a></li><li><a href="https://github.com/PacktPublishing/Node.js_Design_Patterns_Second_Edition_Code" target="_blank" rel="noopener">Node.js_Design Patterns Second Edition Code</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘å¼€å§‹å­¦ä¹  Node.jsã€‚ä¸»è¦çœ‹ä¸¤æœ¬ä¹¦ï¼š&lt;em&gt;Node.js in Practice&lt;/em&gt; å’Œ &lt;em&gt;Node.js Design Patterns&lt;/em&gt;ã€‚å‰è€…ç±»ä¼¼äº oâ€™reilly çš„ cookbook ç³»åˆ—ï¼Œæ•´æœ¬ä¹¦çš„ç¼–æ’æ˜¯é€šè¿‡ä¸€ä¸ªä¸ª recipeï¼Œä¸€ä¸ªä¸ªå…·ä½“çš„ problem&amp;amp;solution å®ç°çš„ã€‚åè€…å°±æ˜¯ &lt;a href=&quot;https://search.packtpub.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Packt Publishing&lt;/a&gt; å‡ºå“çš„ä¸€ç³»åˆ— Design Patterns ä¹¦ç±ã€‚åŒ…æ‹¬è¿™ä¸¤æœ¬ä¹¦åœ¨å†…çš„è®¸å¤šè®²è§£ Node.js çš„ä¹¦ç±ï¼Œéƒ½ä¼šä¸æ–­å¼ºè°ƒä¸¤ä¸ªå…³é”®è¯ï¼Œ asynchronous å’Œ non-blocking I/Oã€‚åœ¨æœ€åˆå¼€å§‹å­¦ä¹ ç¼–ç¨‹çš„æ—¶å€™ï¼Œæ— è®ºæ˜¯å†™ä¸€äº›ç®—æ³•é¢˜ç›®ï¼Œæˆ–æ˜¯åšä¸€äº›æœ¬åœ°æµ‹è¯•ï¼Œå®ƒéƒ½æ˜¯åŒæ­¥çš„ï¼Œå³æ—¶å“åº”çš„ï¼Œå•çº¿ç¨‹çš„ï¼Œblocking I/Oã€‚ä½†å¦‚æœè¿›å…¥çš„ç½‘ç»œé¢†åŸŸï¼Œã€Œå¼‚æ­¥ã€åˆ™ä¼šè¢«ä¸æ–­æèµ·ã€‚ç›¸æ¯” synchronousï¼Œã€Œå¼‚æ­¥ã€æ›´åŠ æ¥è¿‘æˆ‘ä»¬ç›¸å¤„çš„çœŸå®ä¸–ç•Œã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç¯‡æ–‡ç« ä»¥ &lt;em&gt;Node.js Design Patterns&lt;/em&gt; ç¬¬äºŒç« çš„ Web Spider ä¾‹å­ï¼Œæ¢ç©¶æ€è€ƒåœ¨ Node.js ä¸­æ˜¯å¦‚ä½•é€šè¿‡ callback æ¥å®ç°å¼‚æ­¥æ“ä½œçš„ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Coding" scheme="http://reyshawn.com/categories/Coding/"/>
    
    
      <category term="JavaScript" scheme="http://reyshawn.com/tags/JavaScript/"/>
    
      <category term="Node.js" scheme="http://reyshawn.com/tags/Node-js/"/>
    
  </entry>
  
  <entry>
    <title>Hexo Theme å¼€å‘ä¸å®Œå…¨è®°å½•</title>
    <link href="http://reyshawn.com/2019/01/20/Hexo%20Theme%20%E5%BC%80%E5%8F%91%E4%B8%8D%E5%AE%8C%E5%85%A8%E8%AE%B0%E5%BD%95/"/>
    <id>http://reyshawn.com/2019/01/20/Hexo Theme å¼€å‘ä¸å®Œå…¨è®°å½•/</id>
    <published>2019-01-20T00:22:36.357Z</published>
    <updated>2019-01-22T14:28:53.628Z</updated>
    
    <content type="html"><![CDATA[<p>å†³å®šå»ºç«‹ä¸€ä¸ªé™æ€ Blogï¼Œå·²ç»æ˜¯ 2016 å¹´çš„äº‹äº†ã€‚åœ¨é‚£ä¹‹å‰ï¼Œä¹Ÿå°±æ˜¯åœ¨ 2016 å¹´ 4 æœˆ 5 æ—¥ï¼Œè‡ªå·±æ›¾ç»ä½¿ç”¨ <a href="https://github.com/getpelican/pelican" target="_blank" rel="noopener">Pelican</a> è¿›è¡Œè¿‡çŸ­æš‚çš„å°è¯•ã€‚ç”Ÿæ´»åœ¨äº’è”ç½‘æ—¶ä»£ï¼Œå½“ä½ å†³å®šå°†ä¸€åˆ‡ç”µå­åŒ–ï¼Œä¹‰æ— åé¡¾åœ°æŠ•å…¥æ¯”ç‰¹çš„ä¸–ç•Œæ—¶ï¼Œæœ€å¤§çš„å¥½å¤„ä¾¿æ˜¯ï¼Œè¿™ä»¥åå‘ç”Ÿçš„æ¯ä¸€èµ·äº‹ä»¶ï¼Œéƒ½æœ‰ç€æ¸…æ¥šçš„è®°å½•ã€‚å»ºç«‹ Blog è¿™ä»¶äº‹ä¹Ÿä¸ä¾‹å¤–ã€‚ä½†ä»…è¿‡ 1 å¤©ï¼Œæˆ‘å°±åˆ é™¤äº† github ä¸Šçš„ repoã€‚å½“æ—¶çš„è‡ªå·±è¿™æ ·å†™é“ï¼š</p><blockquote><p>ä¸¤å¤©çš„å°è¯•å‘ç°ï¼šæ²¡æœ‰è¶³å¤Ÿçš„çŸ¥è¯†ç§¯ç´¯ï¼ŒæŒ‘æˆ˜å°±æ˜¯ã€Œæ‘¸ç€çŸ³å¤´è¿‡æ²³ã€ï¼Œåˆ°å¤„éƒ½æ˜¯å›°éš¾ï¼Œè€å¿ƒè¢«ä¸€ç‚¹ä¸€ç‚¹æ¶ˆç£¨ï¼Œç›´åˆ°åƒä¸€åªæ— å¤´è‹è‡ä¹±æ’ï¼Œè€Œæ— æ³•å†è€å¿ƒåœ°è§£å†³é—®é¢˜ã€‚æ‰€ä»¥ï¼Œåšå®¢å¹³å°æ­å»ºè®¡åˆ’æš‚åœã€‚</p></blockquote><p>é‚£æ—¶è‡ªå·±æ‰åˆšå¼€å§‹å­¦ Pythonï¼Œä¹Ÿæ‰åˆšå¼€å§‹æ¥è§¦ Githubã€‚å…¶ä»–æ–¹é¢æ›´æ˜¯ç»éªŒç”šå°‘ï¼Œå¤„å¤„ç¢°å£ã€‚ä¸€å¹´ä»¥åï¼Œ 2017 å¹´ 3 æœˆï¼Œè‡ªå·±ä½¿ç”¨ Hexo å»ºç«‹äº†è¿™ä¸ª Blogï¼Œå¹¶åœ¨ Godaddy ä¸Šè´­ä¹°äº†åŸŸåï¼Œé‡‡ç”¨ Hexo é¢„ç½®ä¸»é¢˜ Next ã€‚å…¨é¢ï¼Œç®€æ´ï¼Œç¾è§‚å¤§æ–¹ã€‚è¿™ä¸ªä¸»é¢˜è¶³å¤Ÿå¥½ç”¨ã€‚å½“æ—¶çš„ä¸»é¢˜å¹¶ä¸å¤šï¼Œæ‰€ä»¥ç»å¸¸çœ‹åˆ°å…¶ä»–ä½¿ç”¨ Hexo æ­å»ºçš„ Blog ï¼Œå¾€å¾€éƒ½æ˜¯å·®ä¸å¤šçš„æ ·å¼ï¼Œæˆ‘å½“æ—¶ä¹Ÿåªæ˜¯æ”¹äº†ä»¥ä¸‹ bannerï¼Œæ‰æ˜¾å¾—ç¨æœ‰ä¸åŒã€‚è¿™ä¹Ÿè®©æˆ‘æƒ³è¯•ç€è‡ªå·±å»å†™ä¸€ä¸ªä¸»é¢˜ã€‚</p><p>ç›®å‰çœ‹åˆ°çš„è¿™ä¸ª theme æ‰€æœ‰æ ·å¼ï¼Œå¹¶éæˆ‘æœ¬äººè®¾è®¡ã€‚å®ƒæ¥è‡ªäºä¸€æ¬¾ä»˜è´¹çš„ WordPress theme typologyã€‚æˆ‘æ˜¯ä¸€æ¬¡å¶ç„¶çš„æœºä¼šçœ‹åˆ°å®ƒã€‚è€ƒè™‘åˆ°å¯èƒ½çš„ç‰ˆæƒé—®é¢˜ã€‚è‡ªå·±å¯èƒ½ä¸ä¼šæŠŠå®ƒå‘å¸ƒåˆ° <a href="https://hexo.io/themes/index.html" target="_blank" rel="noopener">Themes | Hexo</a> æˆ–å¼€æºåˆ° Github ä¸Šï¼ˆæ— æ³•è”ç³»åˆ°è¿™ä¸ª theme çš„ä½œè€…ï¼‰ã€‚ä»¥ä¸‹æˆ‘æ‰€åšçš„å¤§éƒ¨åˆ†å·¥ä½œï¼Œä¸è¿‡æ˜¯ä»¥ Hexo çš„å½¢å¼å¯¹ typology çš„å†ç°ã€‚ä¸ºäº†æ–¹ä¾¿ã€‚æˆ‘æŠŠè¿™ä¸ªæ¨¡ä»¿ä¹‹ä½œå‘½åä¸º hagoromoï¼ˆç¾½è¡£ï¼‰ã€‚è‡³äºä¸ºä»€ä¹ˆä¼šå«è¿™ä¸ªåå­—ï¼ŒGoogle ä¼šç»™ä½ ç­”æ¡ˆã€‚</p><a id="more"></a><h2 id="template-engine-çš„æ¯”è¾ƒï¼Œswigï¼Œejs-or-pug"><a href="#template-engine-çš„æ¯”è¾ƒï¼Œswigï¼Œejs-or-pug" class="headerlink" title="template engine çš„æ¯”è¾ƒï¼Œswigï¼Œejs or pug"></a>template engine çš„æ¯”è¾ƒï¼Œswigï¼Œejs or pug</h2><p>Hexo æœ¬èº«æ˜¯åŸºäº Nodejs ï¼Œå®ƒé¦–å…ˆé€šè¿‡æ¨¡ç‰ˆçš„ render engineï¼Œæ¸²æŸ“ markdown å’Œå†™å¥½çš„ template æ–‡ä»¶ï¼Œç”Ÿæˆç›¸åº”çš„ html ã€‚è¿™äº›ç”Ÿæˆçš„ html æ–‡ä»¶å­˜å‚¨åœ¨ <code>public</code> æ–‡ä»¶å¤¹ä¸­ã€‚å†é€šè¿‡ git å°†è¿™ä¸ªæ–‡ä»¶å¤¹çš„å†…å®¹å‘å¸ƒåˆ° github ä¸Šã€‚æ•´ä¸ª Hexo å¤§ä½“çš„å·¥ä½œé€»è¾‘æ˜¯è¿™æ ·çš„ã€‚å·¥ä½œçš„ç¬¬ä¸€æ­¥æ˜¯é€‰æ‹©åˆé€‚çš„ template engineã€‚</p><p>ç›®å‰å¯ç”¨çš„ template engine æœ‰å¤šç§é€‰æ‹©ï¼Œåœ¨ <a href="https://js.libhunt.com/categories/13-templating-engines" target="_blank" rel="noopener">Awesome JS</a> ä¸Šä¼šç»™å‡ºå„ä¸ª template engine çš„æ¯”è¾ƒã€‚æˆ‘æœ€ç»ˆé€‰æ‹©ä½¿ç”¨ ejsã€‚å› ä¸ºï¼Œ ejs æœ¬èº«å­¦ä¹ æˆæœ¬å¾ˆä½ã€‚ejs å…¨ç§° Embedded JavaScript Templateï¼Œç±»ä¼¼äº jsxï¼Œç›´æ¥å°±æ˜¯åœ¨ html é‡Œå†™ js ä»£ç å°±è¡Œäº†ã€‚è€Œ Next ä¸»é¢˜æ˜¯ç”¨ swig å†™çš„ï¼Œä¸é€‰æ‹© swig çš„ä¸€ä¸ªå¾ˆé‡è¦åŸå› æ˜¯å®ƒä¸å†ç»´æŠ¤äº†ï¼Œæœ€åä¸€æ¬¡ commit æ˜¯ä¸¤å¹´å‰ã€‚pug ä¹Ÿæ˜¯ä¸ªå¤‡å—æ¨å´‡çš„é€‰æ‹©ï¼Œå®ƒçš„å‰èº«æ˜¯ jadeï¼Œjade çš„ logo å¾ˆæ¼‚äº®ï¼Œç°åœ¨æ›´åä¸º pugï¼Œicon æ˜¯ä¸€ä¸ªå“ˆå·´ç‹—ï¼Œä¸ªäººä¸æ˜¯å¤ªå–œæ¬¢ã€‚pug çš„æ ¼å¼å’Œ html åŒºåˆ«ä¹Ÿå¾ˆå¤§ï¼Œæ˜¯ç±»ä¼¼ python é‚£ç§ç¼©è¿›å½¢å¼ï¼Œå¦‚æœé€‰æ‹© pug æ˜¯éœ€è¦ä¸€æ®µæ—¶é—´å»é€‚åº”çš„ã€‚</p><p>ejs å¸¸ç”¨ patternï¼š</p><ul><li><code>&lt;% %&gt;</code>: ä¸è¾“å‡ºä»»ä½•å†…å®¹ï¼Œç”¨äºåµŒå¥— if æˆ– for æ§åˆ¶è¯­å¥ï¼›</li><li><code>&lt;%- %&gt;</code>: è¾“å‡º raw html æ–‡æœ¬ï¼›</li><li><code>&lt;%= %&gt;</code>:  è¾“å‡ºæ–‡æœ¬ï¼Œhtml ä¸­çš„ tag å¦‚ <code>&lt;div&gt;</code> ä¼š escape æˆ <code>&amp;lt;div&amp;gt;</code></li></ul><h2 id="æ–‡ä»¶ç»“æ„"><a href="#æ–‡ä»¶ç»“æ„" class="headerlink" title="æ–‡ä»¶ç»“æ„"></a>æ–‡ä»¶ç»“æ„</h2><p>è¿™æ˜¯æˆ‘ç›®å‰æ•´ä¸ªä¸»é¢˜çš„æ–‡ä»¶ç»“æ„ã€‚</p><pre><code class="shell">.â”œâ”€â”€ _config.ymlâ”œâ”€â”€ languagesâ”œâ”€â”€ layoutâ”‚   â”œâ”€â”€ _partialsâ”‚   â”‚   â”œâ”€â”€ footer.ejsâ”‚   â”‚   â”œâ”€â”€ head.ejsâ”‚   â”‚   â”œâ”€â”€ header.ejsâ”‚   â”‚   â”œâ”€â”€ pagination.ejsâ”‚   â”‚   â””â”€â”€ sidebar.ejsâ”‚   â”œâ”€â”€ archive.ejsâ”‚   â”œâ”€â”€ category.ejsâ”‚   â”œâ”€â”€ index.ejsâ”‚   â”œâ”€â”€ layout.ejsâ”‚   â”œâ”€â”€ page.ejsâ”‚   â”œâ”€â”€ post.ejsâ”‚   â””â”€â”€ tag.ejsâ”œâ”€â”€ scriptsâ””â”€â”€ source    â”œâ”€â”€ css    â”‚   â”œâ”€â”€ highlight.css    â”‚   â””â”€â”€ main.css    â”œâ”€â”€ images    â”‚   â”œâ”€â”€ footer.png    â”‚   â””â”€â”€ logo.png    â””â”€â”€ js        â”œâ”€â”€ highlight.min.js        â”œâ”€â”€ highlightjs-line-numbers.js        â”œâ”€â”€ jquery-3.3.1.min.js        â””â”€â”€ main.js</code></pre><p><code>layout</code> é‡Œå­˜æ”¾çš„æ˜¯ <code>ejs</code> æ¨¡ç‰ˆæ–‡ä»¶ã€‚<code>source</code> é‡Œåˆ†äº†ä¸‰ä¸ªæ–‡ä»¶å¤¹ï¼Œåˆ†åˆ«å­˜æ”¾ç”¨åˆ°çš„ cssï¼Œå›¾ç‰‡å’Œ js æ–‡ä»¶ã€‚<code>languages</code> å’Œ <code>scripts</code> è¿™ä¸¤ä¸ªæ–‡ä»¶å¤¹æ²¡æœ‰ç”¨åˆ°ã€‚</p><p>åœ¨ ejs é‡Œä½¿ç”¨ source ä¸­çš„æ–‡ä»¶ï¼š</p><pre><code class="ejs">&lt;%- js(&#39;js/main.js&#39;) %&gt;&lt;%- css(&#39;css/main.css&#39;) %&gt;&lt;img class=&quot;typology-logo&quot; src=&quot;/images/logo.png&quot; alt=&quot;hagoromo&quot; style=&quot;width: 125px;&quot;&gt;</code></pre><p>å› ä¸º source çš„é‡Œæ–‡ä»¶ä¼šåŸå°ä¸åŠ¨çš„ copy è¿› <code>public</code> æ–‡ä»¶å¤¹ä¸€ä»½ã€‚æ‰€ä»¥å¯ä»¥ç›´æ¥ä»¥ä¸Šè¿°çš„å½¢å¼è¿›è¡Œå¼•ç”¨ã€‚</p><h2 id="æµ‹è¯•ç¯å¢ƒæ­å»º"><a href="#æµ‹è¯•ç¯å¢ƒæ­å»º" class="headerlink" title="æµ‹è¯•ç¯å¢ƒæ­å»º"></a>æµ‹è¯•ç¯å¢ƒæ­å»º</h2><p>æœ€ç®€å•åŠæ³•æ˜¯ç›´æ¥ copy äº†ä¸€ä»½æˆ‘ä¸ªäºº blog æ–‡ä»¶å¤¹åˆ° Desktop ä¸Šã€‚æŠŠä¸»é¢˜æ–‡ä»¶å¤¹ç§»åˆ° themes æ–‡ä»¶å¤¹ä¸­ã€‚ä½¿ç”¨ <code>hexo s</code> è¿›è¡Œæœ¬åœ°æµ‹è¯•ã€‚</p><p>æˆ‘æœ€å¼€å§‹è¿˜æƒ³ç€ï¼Œå› ä¸ºéœ€è¦ render  ejs æ–‡ä»¶ï¼Œè¿˜å»çœ‹äº† nodejs å’Œ koa ç­‰ç­‰å†…å®¹ã€‚åæ¥å‘ç°é‚£æ ·åšä¼šèµ°ä¸å°‘å¼¯è·¯ã€‚æœ€å¥½çš„æµ‹è¯•ç¯å¢ƒï¼Œå°±æ˜¯æ‹¿çœŸå®çš„ç¯å¢ƒå»æ¨¡æ‹Ÿï¼Œå¯èƒ½ä¼šå‡ºç°çš„ç§ç§çŠ¶å†µã€‚</p><h2 id="traps-ä¸å®Œå…¨ç»Ÿè®¡"><a href="#traps-ä¸å®Œå…¨ç»Ÿè®¡" class="headerlink" title="traps ä¸å®Œå…¨ç»Ÿè®¡"></a>traps ä¸å®Œå…¨ç»Ÿè®¡</h2><h3 id="archive-é¡µé¢æ„å»º"><a href="#archive-é¡µé¢æ„å»º" class="headerlink" title="archive é¡µé¢æ„å»º"></a>archive é¡µé¢æ„å»º</h3><p>æˆ‘æœ€å¼€å§‹æ„å»º archive é¡µé¢æ—¶ï¼Œæ²¡å¤ªå¼„æ˜ç™½å¦‚ä½•ä½¿ç”¨æ’ä»¶ hexo-genrator-archive ã€‚æ‰€ä»¥å½“æ—¶é€‰æ‹©æ–°å»ºäº†ä¸€ä¸ª pageï¼Œå†åœ¨ page é‡Œå¼•å…¥ <code>partial(archive)</code>ã€‚loop æ‰€æœ‰ posts æ—¶ä½¿ç”¨ global variable <code>site.posts</code>ã€‚è¿™æ ·å†™ï¼Œä¸€ä¸ªæœ€å¤§çš„é—®é¢˜æ˜¯ï¼Œæœ€å archive é¡µé¢å±•ç¤ºçš„ post é¡ºåºï¼Œä¸æ˜¯æŒ‰ç…§æ—¶é—´é¡ºåºæ¥æ˜¾ç¤ºçš„ã€‚æˆ‘ä¹Ÿè¯•äº†å¾ˆå¤šåŠæ³•ï¼Œè®¾æ³•å¯¹ <code>site.posts</code> æ’åºï¼Œä½†éƒ½ä¸€ä¸€å‘ŠåŒ—ã€‚ç›´åˆ°ææ¸…æ¥šäº† hexo-genrator-archive plugin çš„é€»è¾‘ã€‚</p><p>å®é™…ä¸Šï¼Œå®‰è£…äº† hexo-generator-archive plugin åï¼Œåœ¨ hexo çš„é…ç½®æ–‡ä»¶æœ¬èº«å°±æœ‰é‡Œï¼š</p><pre><code class="yaml">archive_dir: archives</code></pre><p>è¿™æ ·åœ¨æ‰§è¡Œå®Œ <code>hexo g</code> æ—¶å€™ï¼Œä¼šè‡ªåŠ¨åœ¨ <code>public</code> æ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆä¸€ä¸ª <code>archives</code> æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å¤¹é‡Œçš„å†…å®¹æ˜¯å’Œ template æ–‡ä»¶ <code>archive.ejs</code> æ–‡ä»¶ç›¸å…³è”çš„ã€‚ä¹Ÿå°±æ˜¯ï¼Œè¿™ä¸ªæ’ä»¶å·²ç»åšäº†æ‰€æœ‰çš„ã€Œrouterã€è·¯ç”±å·¥ä½œã€‚æ‰€ä»¥åœ¨ template æƒ³è¦åˆ›å»ºä¸€ä¸ª archive ç‚¹å‡»é“¾æ¥ï¼Œåªéœ€è¦å³å¯ã€‚</p><pre><code class="ejs">&lt;a href=&quot;/archives&quot;&gt;Archive&lt;/a&gt;</code></pre><p>æ¥ä¸‹æ¥æ•´ä¸ª archive çš„é¡µé¢ï¼Œå°±æ˜¯åœ¨  <code>archive.ejs</code>  ä¸­è¿›è¡Œçš„ã€‚åœ¨ archive é¡µé¢é‡Œï¼Œé‡‡ç”¨å˜é‡ <code>page.posts</code>ï¼Œè¾“å‡ºçš„ posts åˆšå¥½æ˜¯æŒ‰ç…§æ—¶é—´é¡ºåºä»è¿‘åˆ°è¿œæ’åˆ—ã€‚</p><h3 id="pagination-åˆ†é¡µå®ç°"><a href="#pagination-åˆ†é¡µå®ç°" class="headerlink" title="pagination åˆ†é¡µå®ç°"></a>pagination åˆ†é¡µå®ç°</h3><p>ä½¿ç”¨ pagination åˆ†é¡µåŠŸèƒ½ï¼Œéœ€è¦ç°åœ¨ config é‡Œé…ç½®ï¼š</p><pre><code class="yaml">per_page: 10pagination_dir: page</code></pre><p>æ­¤å¤–ï¼Œhexo è¿˜å¾ˆè´´å¿ƒåœ°æä¾›äº†æœ‰å…³ pagination åˆ†é¡µçš„ç›¸å…³ APIã€‚å¤§ä½“çš„å®ç°æ˜¯å°±å˜çš„å¾ˆç®€å•ã€‚</p><pre><code class="ejs">&lt;% if (page.total &gt; 1){ %&gt;&lt;div class=&quot;hagoromo-pagination&quot;&gt;    &lt;nav class=&quot;navigation pagination&quot; role=&quot;navigation&quot;&gt;        &lt;% let prev_text = &quot;&amp;laquo; &quot; + __(&#39;prev&#39;); %&gt;        &lt;% let next_text = __(&#39;next&#39;) + &quot; &amp;raquo;&quot;; %&gt;        &lt;%- paginator({          prev_text: prev_text,          next_text: next_text        }) %&gt;    &lt;/nav&gt;&lt;/div&gt;&lt;% } %&gt;</code></pre><p>å¦‚æœè‡ªå·±å»å®ç°çš„è¯ï¼Œè¿˜æ˜¯å¾ˆå¤æ‚çš„ï¼Œè¦è€ƒè™‘å½“å‰ç¬¬å‡ é¡µï¼Œæœ€åä¸€é¡µå’Œç¬¬ä¸€é¡µã€‚å½“å‰é¡µå’Œç¬¬ä¸€é¡µï¼Œæœ€åä¸€é¡µå·®å€¼ç­‰ç­‰ã€‚ä½¿ç”¨ hexo æä¾›çš„ <code>paginator()</code> å‡½æ•°ï¼Œå°±ç›´æ¥è‡ªåŠ¨ç”Ÿæˆäº†æ•´ä¸ªåˆ†é¡µ moduleã€‚è¿™ä¹‹å css æ ·å¼ï¼ŒæŒ‰ç…§ç”Ÿæˆçš„ html tag ä¸Šç»™çš„ class æ¥å†™å°±è¡Œäº†ã€‚</p><h3 id="banner-ä¸‹æ‹‰åŠ¨ç”»"><a href="#banner-ä¸‹æ‹‰åŠ¨ç”»" class="headerlink" title="banner ä¸‹æ‹‰åŠ¨ç”»"></a>banner ä¸‹æ‹‰åŠ¨ç”»</h3><p>æˆ‘å¸Œæœ›å®ç°çš„ banner ä¸‹æ‹‰åŠ¨ç”»æ•ˆæœæ˜¯ï¼Œåœ¨çª—å£ä¸‹æ‹‰å¤§æ¦‚ 600 pixel æ—¶ï¼Œä¹Ÿå°±æ˜¯ scrollY&gt;600 æ—¶ï¼Œbanner ä»é¡¶éƒ¨å‡ºç°å¹¶å›ºå®šï¼Œå½“ scrollY&lt;600 æ—¶ï¼Œbanner éšå»ã€‚</p><p>å¤§ä½“æ€è·¯æ˜¯ç»™ <code>window</code> bind ä¸€ä¸ª scroll äº‹ä»¶ï¼Œå®æ—¶ listen çª—å£çš„ scrollY ä½ç½®ã€‚å¯¹äºåŠ¨ç”»çš„å®ç°ï¼Œæœ‰å¤šç§æ–¹å¼ï¼Œå¯ä»¥ç”¨ cssï¼Œä¹Ÿå¯ä»¥ç”¨ jsã€‚æˆ‘è¿™é‡Œä½¿ç”¨äº† jQuery çš„ <code>animate()</code> å‡½æ•°ï¼Œç›¸æ¯” cssï¼Œæ§åˆ¶èµ·æ¥æ›´åŠ çµæ´»æ–¹ä¾¿ã€‚</p><pre><code class="javascript">$(window).on(&#39;scroll&#39;, function() {    let scrollPosition = $(this).scrollTop();    let $header = $(&#39;.hagoromo-header&#39;);            if ($(window).width() &gt; 800) {        if (scrollPosition &lt; 200) {            $header.finish();            $header.css({                &#39;top&#39;: &#39;0&#39;,            });        }        if (scrollPosition &gt; 600 &amp;&amp; !$header.hasClass(&#39;hagoromo-header-sticky&#39;)) {            $header.addClass(&#39;hagoromo-header-sticky&#39;);            $header.css({                &#39;top&#39;: &#39;-70px&#39;,            });            $header.animate({                top: &quot;0&quot;            },160)        }        if (scrollPosition &lt; 550 &amp;&amp; $header.hasClass(&#39;hagoromo-header-sticky&#39;)) {            $header.animate({                top: &quot;-70px&quot;            },160, function() {                $header.removeClass(&#39;hagoromo-header-sticky&#39;);                $header.finish();                $header.css(&#39;top&#39;, &#39;0&#39;);            })        }    } else {        if (scrollPosition &gt; 55) {            $header.addClass(&#39;hagoromo-header-hidden&#39;)        } else {            $header.removeClass(&#39;hagoromo-header-hidden&#39;)        }    }});</code></pre><p>å…¶ä¸­å‡ºç°çš„é—®é¢˜æ˜¯ï¼Œå› ä¸ºåªè¦æœ‰ animationï¼Œéƒ½è¦æ¶‰åŠæ—¶é—´çš„é—®é¢˜ï¼Œæ¶‰åŠæ—¶é—´çš„é—®é¢˜å°±å¯ä»¥çœ‹ä½œä¸€æ¬¡ asynchronous è°ƒç”¨ï¼Œè¿™æ ·ç›¸æ¯”å¹³æ—¶ synchronous è°ƒç”¨ï¼Œé€Ÿåº¦çš„å¿«æ…¢ï¼Œæ—¶é—´çš„é•¿çŸ­ï¼Œæ€»ä¼šå¸¦æ¥é¢å¤–çš„é—®é¢˜ã€‚æˆ‘å½“æ—¶é‡åˆ°çš„é—®é¢˜æ—¶ï¼Œå¦‚æœè¿‡å¿«çš„ä»ä¸‹åˆ°ä¸Šæ»‘åˆ°é¡¶éƒ¨ï¼Œä¼šå‡ºç°å¾ªç¯åŠ¨ç”»ï¼Œå³ banner ä¸åœçš„ä¸Šä¸‹æŠ–åŠ¨ã€‚é—®é¢˜çš„åŸå› ä¹Ÿå¾ˆæµ…æ˜¾ï¼Œå°±æ˜¯åœ¨ä¸Šä¸€ä¸ªåŠ¨ç”»è¿˜æ²¡ç»“æŸæ—¶ï¼Œæœ‰è§¦å‘äº†æ–°ä¸€è½®çš„åŠ¨ç”»ï¼Œä¸€ä¸å°å¿ƒè¿›å…¥ infinite loopã€‚æœ€åä¸ºäº†è§£å†³å®ƒï¼Œæ‰¾åˆ°äº† <code>finish()</code> ï¼Œå¼ºåˆ¶ç»“æŸä¹‹å‰åŠ¨ç”»ã€‚è¿™æ ·ä¸€æ¥æ•´ä½“çš„æ•ˆæœå°±å¥½å¤šäº†ã€‚</p><h3 id="coding-highlight-å’Œ-line-number-æ˜¾ç¤º"><a href="#coding-highlight-å’Œ-line-number-æ˜¾ç¤º" class="headerlink" title="coding highlight å’Œ line number æ˜¾ç¤º"></a>coding highlight å’Œ line number æ˜¾ç¤º</h3><p>hexo è‡ªå¸¦äº†ä»£ç é«˜äº®ã€‚å¯èƒ½æ˜¯å› ä¸ºæˆ‘æ²¡æœ‰å®šä¹‰ç›¸å…³çš„ css ï¼Œå®é™…æ¸²æŸ“åï¼Œcode block æœ‰è¡Œå·ï¼Œä½†æ˜¯æ²¡æœ‰é«˜äº®ã€‚è€Œä¸” code block æ¸²æŸ“åçš„ html åæ˜¯ <code>&lt;figure&gt;&lt;table&gt;</code> è¿™æ ·å½¢å¼ã€‚å‚è€ƒç½‘ä¸Šæ„è§åï¼Œé€šå¸¸çš„è§£å†³æ–¹æ¡ˆæ˜¯é‡‡å– <code>highlight.js</code>ã€‚ä½¿ç”¨ä¹‹å‰å…ˆæŠŠ hexo å†…ç½®çš„ highlight å…³é—­ï¼Œè¿™æ · code block æ¸²æŸ“å›åˆ°äº†ä¼ ç»Ÿ <code>&lt;pre&gt;&lt;code&gt;</code> å½¢å¼ã€‚å¼•å…¥ <code>highlight.js</code>  æä¾›çš„ jsï¼Œcss æ–‡ä»¶åï¼Œåˆå§‹åŒ–åå°±èƒ½çœ‹åˆ°é«˜äº®çš„ä»£ç ã€‚è¿™ä¸ªè¦æ³¨æ„ï¼š</p><pre><code class="javascript">hljs.initHighlightingOnLoad();</code></pre><p>è¿™ä¸ªå‡½æ•°æ˜¯è¦å†™åœ¨è‡ªå·± js æ–‡ä»¶çš„ <code>$(document).ready()</code> <strong>å¤–é¢</strong>ã€‚å› ä¸ºå‡½æ•°æœ¬èº«å·²ç»åŒ…å« onload äº†ã€‚</p><p> <code>highlight.js</code> è‡ªèº«æ˜¯æ²¡æœ‰ line number æ˜¾ç¤ºçš„ã€‚è¿™é‡Œéœ€è¦å¦å¤–ä¸€ä¸ªæ‰©å±• <a href="https://github.com/wcoder/highlightjs-line-numbers.js/" target="_blank" rel="noopener">highlightjs-line-numbers.js</a>, ä½¿ç”¨æ–¹æ³•åŒ  <code>highlight.js</code> ã€‚åˆå§‹åŒ–çš„æ—¶å€™åŒæ ·è¦å†™åœ¨  <code>$(document).ready()</code> <strong>å¤–é¢</strong>ã€‚</p><h3 id="æœç´¢åŠŸèƒ½çš„æ›¿ä»£æ€§å®ç°"><a href="#æœç´¢åŠŸèƒ½çš„æ›¿ä»£æ€§å®ç°" class="headerlink" title="æœç´¢åŠŸèƒ½çš„æ›¿ä»£æ€§å®ç°"></a>æœç´¢åŠŸèƒ½çš„æ›¿ä»£æ€§å®ç°</h3><p>æœç´¢ï¼Œå¹³æ—¶ä¸ç»æ„å°±ä¼šç”¨åˆ°åŠŸèƒ½ï¼Œå‡­æˆ‘ä¸ªäººå´å†™ä¸€ä¸ª search engineï¼Œå·¥ä½œé‡æ—¶å¾ˆå¤§çš„ã€‚è¿™é‡Œæœ‰å‡ ç§æ–¹æ¡ˆã€‚</p><p>ç¬¬ä¸€ç§æ˜¯è°ƒç”¨ algolia æ¥å£ï¼Œhexo æœ¬èº«æä¾›äº† hexo-algolia æ’ä»¶ã€‚è¿™æ ·å®ç°åçš„å½¢å¼æ˜¯ï¼Œç‚¹å‡»æœç´¢åï¼Œé¡µé¢ä¼šå‡ºç°ä¸€ä¸ªç±»ä¼¼ macOS ä¸­ spotlight é‚£æ ·çš„è¾“å…¥å¼¹çª—ï¼Œè¾“å…¥è¦æœç´¢çš„å†…å®¹ï¼Œä¾¿ä¼šå®æ—¶ç»™å‡ºç»“æœã€‚</p><p>ç¬¬äºŒç§æš‚æ—¶åªæ˜¯æˆ‘ä¸ªäººæƒ³æ³•ã€‚å°±æ˜¯å€ŸåŠ© Google çš„ <a href="https://developers.google.com/custom-search/v1/overview" target="_blank" rel="noopener">Custom Search JSON API</a>ã€‚ä½†è¿™ä¸ªéœ€è¦æ–°å»ºä¸€ä¸ª search page é¡µé¢æ¥å±•ç¤º search ç»“æœã€‚éœ€è¦ js é€šè¿‡ ajax å¾—åˆ°è¿”å›çš„ jsonï¼Œå®æ—¶æ¸²æŸ“åˆ° search é¡µé¢ä¸Šã€‚</p><p>ç¬¬ä¸‰ç§ï¼Œä¹Ÿå°±æ˜¯æˆ‘ç°åœ¨ä½¿ç”¨çš„æ¯”è¾ƒç®€å•çš„åŠæ³•ã€‚è®°å¾— <a href="www.v2ex.com">V2EX</a> ä¹Ÿæ˜¯è¿™ä¹ˆå®ç°çš„ã€‚åˆ©ç”¨ Google æœç´¢ä¸­çš„ <code>site:</code> è¯­å¥ã€‚ç‚¹å‡» <code>SEARCH</code> åæ˜¯ç›´æ¥æ‰“å¼€ Googleï¼Œå±•ç¤º Google çš„ç«™å†…æœç´¢ç»“æœã€‚</p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>æ–‡ç« ä¸»è¦å†™äº†è‡ªå·±å¼€å‘è¿‡ç¨‹ä¸­ç¢°åˆ°çš„å‡ ä¸ªæ£˜æ‰‹çš„éš¾é¢˜ã€‚å¦å¤–è¿˜æœ‰ä¸€å¤§éƒ¨åˆ†å…³äºè®¾è®¡çš„å†…å®¹æ²¡æœ‰æ¶‰åŠã€‚åŒ…æ‹¬å­—ä½“ï¼Œé¢œè‰²ï¼Œlayoutï¼Œz-indexï¼Œfooterï¼Œresponsive design ç­‰ç­‰ã€‚è™½ç„¶å¤§éƒ¨åˆ†çš„è®¾è®¡ä½¿ç”¨äº† typology çš„ css æ–‡ä»¶ï¼Œä½†å¼„æ‡‚å…¶ä¸­çš„é€»è¾‘ç»“æ„ï¼Œå†™å‡ºæ›´ä¼˜é›…çš„ css ï¼Œè¿˜éœ€è¦ä¸€ç•ªåŠªåŠ›å’ŒåŠŸå¤«ã€‚</p><h2 id="ç•ªå¤–"><a href="#ç•ªå¤–" class="headerlink" title="ç•ªå¤–"></a>ç•ªå¤–</h2><h3 id="é…ç½®-favicon"><a href="#é…ç½®-favicon" class="headerlink" title="é…ç½® favicon"></a>é…ç½® favicon</h3><p>éœ€è¦å°†è‡ªå·±å‡†å¤‡å¥½ icon æ–‡ä»¶ï¼Œé€šå¸¸æ˜¯ .ico æ ¼å¼çš„æ–‡ä»¶ï¼Œå­˜å‚¨åœ¨ <code>source</code> æ–‡ä»¶å¤¹ä¸‹ã€‚åœ¨ <code>head.ejs</code> ä¸­åŠ å…¥ä¸€æ¡ <code>&lt;link&gt;</code> æ¥å£°æ˜ favicon åœ°å€ï¼š</p><pre><code class="ejs">&lt;% if (theme.favicon){ %&gt;    &lt;link rel=&quot;icon&quot; href=&quot;&lt;%- theme.favicon %&gt;&quot;&gt;&lt;% } %&gt;</code></pre><p>è¿™é‡Œä½¿ç”¨ if ç»“æ„æ˜¯ä¸ºäº†æ–¹ä¾¿åœ¨ <code>config.yaml</code> ä¸­è¿›è¡Œé…ç½®ã€‚</p><p>åœ¨ theme çš„é…ç½®æ–‡ä»¶ <code>config.yaml</code> ä¸­æ·»åŠ ï¼Œ</p><pre><code class="yaml">favicon: ./favicon.ico</code></pre><p>å³å¯ã€‚</p><p>æµ‹è¯•çš„è¯ï¼Œlocal æœ¬åœ°æµ‹è¯•æ˜¯æ²¡æœ‰çœ‹åˆ° iconã€‚ä½† deploy ä¹‹åï¼ŒæŠŠç½‘é¡µåŠ å…¥æ”¶è—ï¼Œåœ¨ iOS ç«¯çš„ Safari ç­‰å¾…ç‰‡åˆ»å°±èƒ½çœ‹åˆ° iconï¼Œåœ¨æ¡Œé¢ç«¯çš„ Chrome ä¹Ÿå¯ä»¥ã€‚ä½†å”¯ç‹¬æ¡Œé¢ç«¯çš„ Safari ä¸æ˜¾ç¤ºã€‚åœ¨ <code>/Users/reyshawn/Library/Safari/Touch\ Icons\ Cache</code> è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹èƒ½çœ‹åˆ°ï¼ŒSafari éœ€è¦çš„ icon éƒ½æ˜¯ png æ ¼å¼å›¾ç‰‡ï¼Œå¤§å°é€šå¸¸æ˜¯ 180*180ï¼Œå‚è€ƒäº†ä»¥ä¸‹å…¶ä»–èƒ½æ­£å¸¸æ˜¾ç¤º icon çš„ç½‘ç«™ï¼Œå®ƒä»¬ head çš„å†™æ³•ã€‚æ‰€ä»¥è¦åœ¨ <code>&lt;head&gt;</code> ä¸­åŠ å…¥ä¸‹é¢ä¸¤ä¸ª <code>&lt;link&gt;</code>:</p><pre><code class="html">&lt;link rel=&quot;icon&quot; type=&quot;image/png&quot; href=&quot;./favicon.png&quot;&gt;&lt;link rel=&quot;apple-touch-icon&quot; href=&quot;./favicon180x180.png&quot; sizes=&quot;180x180&quot;&gt;</code></pre><p>åŒæ—¶è¦æŠŠ png çš„icon ç§»åŠ¨åˆ° <code>source</code> æ–‡ä»¶å¤¹ä¸‹ã€‚è¿™æ ·åœ¨æ¡Œé¢ç«¯çš„ Safari ä¹Ÿèƒ½æ­£å¸¸æ˜¾ç¤º favicon äº†ã€‚ä¸å¾—ä¸è®²ï¼Œè‹¹æœå¯¹äº icon åˆ†è¾¨ç‡çš„æ§åˆ¶ä¹‹ä¸¥è‹›ï¼Œä¹Ÿä¾§é¢åæ˜ å¯¹è®¾è®¡ï¼Œæ•´ä½“ icon ä¸€è‡´æ€§çš„é‡è§†ã€‚</p><p>å‚è€ƒï¼š</p><ul><li><a href="https://stackoverflow.com/questions/25952907/favicon-ico-vs-link-rel-shortcut-icon" target="_blank" rel="noopener">What is the best practice for creating a favicon on a web site?</a></li><li><a href="https://stackoverflow.com/questions/2997437/what-size-should-apple-touch-icon-png-be-for-ipad-and-iphone" target="_blank" rel="noopener">What size should apple-touch-icon.png be for iPad and iPhone?</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å†³å®šå»ºç«‹ä¸€ä¸ªé™æ€ Blogï¼Œå·²ç»æ˜¯ 2016 å¹´çš„äº‹äº†ã€‚åœ¨é‚£ä¹‹å‰ï¼Œä¹Ÿå°±æ˜¯åœ¨ 2016 å¹´ 4 æœˆ 5 æ—¥ï¼Œè‡ªå·±æ›¾ç»ä½¿ç”¨ &lt;a href=&quot;https://github.com/getpelican/pelican&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Pelican&lt;/a&gt; è¿›è¡Œè¿‡çŸ­æš‚çš„å°è¯•ã€‚ç”Ÿæ´»åœ¨äº’è”ç½‘æ—¶ä»£ï¼Œå½“ä½ å†³å®šå°†ä¸€åˆ‡ç”µå­åŒ–ï¼Œä¹‰æ— åé¡¾åœ°æŠ•å…¥æ¯”ç‰¹çš„ä¸–ç•Œæ—¶ï¼Œæœ€å¤§çš„å¥½å¤„ä¾¿æ˜¯ï¼Œè¿™ä»¥åå‘ç”Ÿçš„æ¯ä¸€èµ·äº‹ä»¶ï¼Œéƒ½æœ‰ç€æ¸…æ¥šçš„è®°å½•ã€‚å»ºç«‹ Blog è¿™ä»¶äº‹ä¹Ÿä¸ä¾‹å¤–ã€‚ä½†ä»…è¿‡ 1 å¤©ï¼Œæˆ‘å°±åˆ é™¤äº† github ä¸Šçš„ repoã€‚å½“æ—¶çš„è‡ªå·±è¿™æ ·å†™é“ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸¤å¤©çš„å°è¯•å‘ç°ï¼šæ²¡æœ‰è¶³å¤Ÿçš„çŸ¥è¯†ç§¯ç´¯ï¼ŒæŒ‘æˆ˜å°±æ˜¯ã€Œæ‘¸ç€çŸ³å¤´è¿‡æ²³ã€ï¼Œåˆ°å¤„éƒ½æ˜¯å›°éš¾ï¼Œè€å¿ƒè¢«ä¸€ç‚¹ä¸€ç‚¹æ¶ˆç£¨ï¼Œç›´åˆ°åƒä¸€åªæ— å¤´è‹è‡ä¹±æ’ï¼Œè€Œæ— æ³•å†è€å¿ƒåœ°è§£å†³é—®é¢˜ã€‚æ‰€ä»¥ï¼Œåšå®¢å¹³å°æ­å»ºè®¡åˆ’æš‚åœã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é‚£æ—¶è‡ªå·±æ‰åˆšå¼€å§‹å­¦ Pythonï¼Œä¹Ÿæ‰åˆšå¼€å§‹æ¥è§¦ Githubã€‚å…¶ä»–æ–¹é¢æ›´æ˜¯ç»éªŒç”šå°‘ï¼Œå¤„å¤„ç¢°å£ã€‚ä¸€å¹´ä»¥åï¼Œ 2017 å¹´ 3 æœˆï¼Œè‡ªå·±ä½¿ç”¨ Hexo å»ºç«‹äº†è¿™ä¸ª Blogï¼Œå¹¶åœ¨ Godaddy ä¸Šè´­ä¹°äº†åŸŸåï¼Œé‡‡ç”¨ Hexo é¢„ç½®ä¸»é¢˜ Next ã€‚å…¨é¢ï¼Œç®€æ´ï¼Œç¾è§‚å¤§æ–¹ã€‚è¿™ä¸ªä¸»é¢˜è¶³å¤Ÿå¥½ç”¨ã€‚å½“æ—¶çš„ä¸»é¢˜å¹¶ä¸å¤šï¼Œæ‰€ä»¥ç»å¸¸çœ‹åˆ°å…¶ä»–ä½¿ç”¨ Hexo æ­å»ºçš„ Blog ï¼Œå¾€å¾€éƒ½æ˜¯å·®ä¸å¤šçš„æ ·å¼ï¼Œæˆ‘å½“æ—¶ä¹Ÿåªæ˜¯æ”¹äº†ä»¥ä¸‹ bannerï¼Œæ‰æ˜¾å¾—ç¨æœ‰ä¸åŒã€‚è¿™ä¹Ÿè®©æˆ‘æƒ³è¯•ç€è‡ªå·±å»å†™ä¸€ä¸ªä¸»é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ç›®å‰çœ‹åˆ°çš„è¿™ä¸ª theme æ‰€æœ‰æ ·å¼ï¼Œå¹¶éæˆ‘æœ¬äººè®¾è®¡ã€‚å®ƒæ¥è‡ªäºä¸€æ¬¾ä»˜è´¹çš„ WordPress theme typologyã€‚æˆ‘æ˜¯ä¸€æ¬¡å¶ç„¶çš„æœºä¼šçœ‹åˆ°å®ƒã€‚è€ƒè™‘åˆ°å¯èƒ½çš„ç‰ˆæƒé—®é¢˜ã€‚è‡ªå·±å¯èƒ½ä¸ä¼šæŠŠå®ƒå‘å¸ƒåˆ° &lt;a href=&quot;https://hexo.io/themes/index.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Themes | Hexo&lt;/a&gt; æˆ–å¼€æºåˆ° Github ä¸Šï¼ˆæ— æ³•è”ç³»åˆ°è¿™ä¸ª theme çš„ä½œè€…ï¼‰ã€‚ä»¥ä¸‹æˆ‘æ‰€åšçš„å¤§éƒ¨åˆ†å·¥ä½œï¼Œä¸è¿‡æ˜¯ä»¥ Hexo çš„å½¢å¼å¯¹ typology çš„å†ç°ã€‚ä¸ºäº†æ–¹ä¾¿ã€‚æˆ‘æŠŠè¿™ä¸ªæ¨¡ä»¿ä¹‹ä½œå‘½åä¸º hagoromoï¼ˆç¾½è¡£ï¼‰ã€‚è‡³äºä¸ºä»€ä¹ˆä¼šå«è¿™ä¸ªåå­—ï¼ŒGoogle ä¼šç»™ä½ ç­”æ¡ˆã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Coding" scheme="http://reyshawn.com/categories/Coding/"/>
    
    
      <category term="JavaScript" scheme="http://reyshawn.com/tags/JavaScript/"/>
    
      <category term="Front-end" scheme="http://reyshawn.com/tags/Front-end/"/>
    
  </entry>
  
  <entry>
    <title>1/n- Cycle | 6kyu</title>
    <link href="http://reyshawn.com/2018/07/10/1n-%20Cycle%20%7C%206kyu/"/>
    <id>http://reyshawn.com/2018/07/10/1n- Cycle | 6kyu/</id>
    <published>2018-07-10T14:58:13.061Z</published>
    <updated>2019-01-23T01:31:08.687Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Details"><a href="#Details" class="headerlink" title="Details"></a>Details</h2><p>Let be <code>n</code> an integer prime with <code>10</code> e.g. <code>7</code>. </p><p><code>1/7 = 0.142857 142857 142857 ...</code>.</p><p>We see that the decimal part has a cycle: <code>142857</code>. The length of this cycle is <code>6</code>. In the same way:</p><p><code>1/11 = 0.09 09 09 ...</code>. Cycle length is <code>2</code>.</p><p><strong>Task</strong></p><p>Given an integer n (n &gt; 1), the function cycle(n) returns the length of the cycle if n and 10 are coprimes, otherwise returns -1.</p><p><strong>Exemples:</strong></p><pre><code class="python">cycle(5) = -1cycle(13) = 6 -&gt; 0.076923 076923 0769cycle(21) = 6 -&gt; 0.047619 047619 0476cycle(27) = 3 -&gt; 0.037 037 037 037 0370cycle(33) = 2 -&gt; 0.03 03 03 03 03 03 03 03cycle(37) = 3 -&gt; 0.027 027 027 027 027 0cycle(94) = -1 cycle(22) = -1 since 1/22 ~ 0.0 45 45 45 45 ...</code></pre><p>Note</p><ul><li>Translators are welcome for all languages.</li></ul><a id="more"></a><h2 id="My-Solution"><a href="#My-Solution" class="headerlink" title="My Solution"></a>My Solution</h2><pre><code class="python">import mathimport fractionsdef cycle(n) :    if n==2 or n==5 :        return -1    t = phi(n)    p = primes(t)    divisor = []    for i in p:        x = i        while t % i == 0:            divisor.append(i)            t //= i        if isprime(t):            divisor.append(t)            break    divisor.sort()    print(divisor)    for i in divisor:        if 10**i % n == 1:            break    return idef phi(n):    &#39;&#39;&#39;compute Euler&#39;s totient function values.&#39;&#39;&#39;    amount = 0    for k in range(1, n + 1):        if math.gcd(n, k) == 1:            amount += 1    return amountdef isprime(n):    &quot;&quot;&quot;Returns True if n is prime.&quot;&quot;&quot;    if n == 2:        return True    if n == 3:        return True    if n % 2 == 0:        return False    if n % 3 == 0:        return False    i = 5    w = 2    while i * i &lt;= n:        if n % i == 0:            return False        i += w        w = 6 - w    return Truedef primes(limit):    D = {}    q = 2    while q &lt;= limit:        if q not in D:            yield q            D[q * q] = [q]        else:            for p in D[q]:                D.setdefault(p + q, []).append(p)            del D[q]        q += 1print(cycle(219199))</code></pre><p>è¿™é“é¢˜æ˜¯æ±‚ $1/n$ çš„å¾ªç¯å°æ•°ä½æ•°çš„ã€‚é€šè¿‡è§‚å¯Ÿå…¶å®å¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„æ€§è´¨ï¼Œå‡è®¾ $1/n$ çš„å¾ªç¯å°æ•°ä½æ•°æœ‰ $p$ ä½ï¼Œåˆ™æœ‰ï¼š</p><pre><code class="python">10**p % n == 1</code></pre><p>å…¶å®ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯ 10 æ‰©å¤§ $p$ å€ï¼Œå°æ•°ç‚¹å‘å³ç§»åŠ¨ $p$ ä½ï¼Œæ•´æ•°éƒ¨åˆ†æ°å¥½ä½ä¸€ä¸ªå¾ªç¯æ•°ï¼Œå°æ•°éƒ¨åˆ†åˆ™ç­‰äº $1/n$ ã€‚</p><p>ä½†æ˜¯å¦‚æœæŒ‰ç…§è¿™ä¸ªæ€è·¯æ¥è¿›è¡Œæ±‚è§£ï¼Œå†™ä¸€ä¸ªå¾ªç¯ï¼Œå¯¹ä¸€ä¸ªç¨å¾®å¤§ä¸€ç‚¹çš„æ•°ï¼Œå¦‚ä¸Šé¢çš„ <code>219199</code>ï¼Œå®ƒçš„å¾ªç¯ä½æ•°æ˜¯ <code>36180</code>ã€‚æš´åŠ›å†™å¾ªç¯æ ¹æœ¬å°±è¡Œä¸é€šï¼</p><h2 id="Other-Solutions"><a href="#Other-Solutions" class="headerlink" title="Other Solutions"></a>Other Solutions</h2><p> <a href="https://www.codewars.com/users/lechevalier" target="_blank" rel="noopener">lechevalier</a></p><pre><code class="python">def cycle(n):    if not n % 2 or not n % 5:        return -1    x, mods = 1, set()    while x not in mods:        mods.add(x)        x = 10 * x % n    return len(mods)</code></pre><p>lechevalier æ‰€ç”¨çš„è¿™ä¸ªæ–¹æ³•çš„æ€è·¯ï¼Œæ­£æ˜¯æˆ‘ä¸Šé¢è¯´çš„ï¼Œåªæ˜¯å¹¶éæš´åŠ›å¾ªç¯ï¼Œè€Œæ˜¯ä¸æ–­è¿­ä»£ã€‚æˆ‘çš„ç–‘é—®æ˜¯ï¼Œä¸ºä½•ä¸€å®šèƒ½ä¿è¯ï¼Œ<code>mods</code> é•¿åº¦åˆšå¥½æ˜¯å¾ªç¯çš„ä½æ•°ï¼Ÿ</p><p>æ–¹æ³•ç±»ä¼¼è¿™é‡Œç»™å‡ºçš„ç­”æ¡ˆï¼š<a href="https://stackoverflow.com/questions/249372/how-to-calculate-recurring-digits" target="_blank" rel="noopener">How to Calculate Recurring Digits?</a></p><blockquote><p>You can calculate the decimal representation of <code>a / b</code> using the long-division algorithm you learned at school, as Mark Ransom said. To calculate each successive digit, divide the current dividend (numerator or remainder) by <code>b</code>, and find the next dividend as the remainder multiplied by 10 (â€œbringing down a 0â€). When a remainder is the same as some previous remainder, it means that the digits from then on will repeat as well, so you can note this fact and stop.</p></blockquote><p>æ˜ç™½äº†ã€‚å…¶å®æ•´ä¸ªè¿­ä»£çš„è¿‡ç¨‹å°±æ˜¯å»åšä¸€æ¬¡ long divisionã€‚long division å°±æ˜¯æˆ‘ä»¬å°å­¦å­¦è¿‡çš„é‚£ç§é™¤æ³•è®¡ç®—ã€‚</p><p><img src="/images/long division.png" alt="long division"></p><p>é‚£ä¹ˆä¸ºä»€ä¹ˆè¿™æ ·ä¸€ç§å¾ªç¯å°±æ¯”ä¹‹å‰æˆ‘æƒ³çš„é‚£ç§æš´åŠ›ç ´è§£å¿«å‘¢ï¼Ÿç­”æ¡ˆå°±åœ¨äºè¿­ä»£ã€‚æ¯æ¬¡åªç”¨ remainder ä¹˜ 10 è¿›è¡Œè¿­ä»£ï¼Œä¸€ä¸ªéå¸¸å°çš„æ•°ï¼Œç®—èµ·æ¥è‡ªç„¶æ¯”ç”¨ $10^{n}$ ç›´æ¥å»é™¤è¦å¿«å¾—å¤šã€‚ </p><p>å‚è€ƒæ–‡ç« ï¼š</p><ul><li><a href="https://math.stackexchange.com/questions/1122203/calculating-eulers-totient-function-values" target="_blank" rel="noopener">Calculating Eulerâ€™s totient function values.</a></li><li><a href="https://stackoverflow.com/questions/249372/how-to-calculate-recurring-digits" target="_blank" rel="noopener">How to Calculate Recurring Digits?</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Details&quot;&gt;&lt;a href=&quot;#Details&quot; class=&quot;headerlink&quot; title=&quot;Details&quot;&gt;&lt;/a&gt;Details&lt;/h2&gt;&lt;p&gt;Let be &lt;code&gt;n&lt;/code&gt; an integer prime with &lt;code&gt;10&lt;/code&gt; e.g. &lt;code&gt;7&lt;/code&gt;. &lt;/p&gt;
&lt;p&gt;&lt;code&gt;1/7 = 0.142857 142857 142857 ...&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;We see that the decimal part has a cycle: &lt;code&gt;142857&lt;/code&gt;. The length of this cycle is &lt;code&gt;6&lt;/code&gt;. In the same way:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;1/11 = 0.09 09 09 ...&lt;/code&gt;. Cycle length is &lt;code&gt;2&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Task&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Given an integer n (n &amp;gt; 1), the function cycle(n) returns the length of the cycle if n and 10 are coprimes, otherwise returns -1.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Exemples:&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;python&quot;&gt;cycle(5) = -1
cycle(13) = 6 -&amp;gt; 0.076923 076923 0769
cycle(21) = 6 -&amp;gt; 0.047619 047619 0476
cycle(27) = 3 -&amp;gt; 0.037 037 037 037 0370
cycle(33) = 2 -&amp;gt; 0.03 03 03 03 03 03 03 03
cycle(37) = 3 -&amp;gt; 0.027 027 027 027 027 0
cycle(94) = -1 

cycle(22) = -1 since 1/22 ~ 0.0 45 45 45 45 ...
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Note&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Translators are welcome for all languages.&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="Coding" scheme="http://reyshawn.com/categories/Coding/"/>
    
    
      <category term="Algorithm" scheme="http://reyshawn.com/tags/Algorithm/"/>
    
      <category term="codewars" scheme="http://reyshawn.com/tags/codewars/"/>
    
      <category term="Python" scheme="http://reyshawn.com/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>Lowest base system | 4kyu</title>
    <link href="http://reyshawn.com/2018/06/29/Lowest%20base%20system%20%7C%204kyu/"/>
    <id>http://reyshawn.com/2018/06/29/Lowest base system | 4kyu/</id>
    <published>2018-06-29T01:58:30.647Z</published>
    <updated>2019-01-22T15:16:13.178Z</updated>
    
    <content type="html"><![CDATA[<h2 id="è¦ç‚¹"><a href="#è¦ç‚¹" class="headerlink" title="è¦ç‚¹"></a>è¦ç‚¹</h2><ul><li>é™¤æ³•ï¼Œæ±‚ä½™ï¼Œå› å­</li><li><code>Number.MAX_SAFE_INTEGER</code></li><li>äºŒåˆ†æ³•æ±‚æ–¹ç¨‹æ ¹</li></ul><h2 id="Details"><a href="#Details" class="headerlink" title="Details"></a>Details</h2><p>Your task is determine lowest number base system in which the input <code>n</code> (base 10), expressed in this number base system, is all <code>1</code> in its digit. See an example:</p><p>â€˜7â€™ in base 2 is â€˜111â€™ - fits! answer is 2</p><p>â€˜21â€™ in base 2 is â€˜10101â€™ - contains â€˜0â€™ does not fit â€˜21â€™ in base 3 is â€˜210â€™ - contains â€˜0â€™ and â€˜2â€™ does not fit â€˜21â€™ in base 4 is â€˜111â€™ - contains only â€˜1â€™ it fits! answer is 4</p><p><code>n</code> is always less than <code>Number.MAX_SAFE_INTEGER</code>.</p><p>è¿™ä¸ªé¢˜ç›®çš„éš¾åº¦ä¸»è¦åœ¨äºæ€§èƒ½ performance æ–¹é¢ï¼Œå¯¹äºæ•°å€¼è¾ƒå°çš„æ•°å­—ï¼Œé€šå¸¸æ–¹æ³•å¾ˆå®¹æ˜“è®¡ç®—ï¼Œä¸€æ—¦æ¶‰åŠåˆ°ä¹ä½åä½å¾€ä¸Šçš„å¤§æ•°ï¼Œä¸€èˆ¬çš„å¾ªç¯æ–¹æ³•å°±ä¼šè€—æ—¶å¾ˆä¹…ã€‚</p><a id="more"></a><h2 id="My-Solution"><a href="#My-Solution" class="headerlink" title="My Solution"></a>My Solution</h2><pre><code class="javascript">function getMinBase (number) {    if (number == 3) return 2;    var divisor = number -1    for (let i = 2; i != divisor; i++) {        var k = number - 1;        if (i &gt; 5999) break;        while (!(k % i)) {            divisor = k / i            k = divisor - 1;            if (k == 0) return i;        }    }    var _root = [2,3,4,5]    var k = 11    for (let i=0; i&lt;_root.length; i++){        var possible = parseInt(Math.pow(number, 1/_root[i]))        var k = 10 * k + 1        if (toTenBase(k,possible) == number) return possible    }    return number -1;}function toTenBase (number, base) {    n = number + &#39;&#39;;    n = n.split(&#39;&#39;).map(a =&gt; parseInt(a));    res = 0    for (var i = n.length -1; i &gt; -1; i--) {        res += Math.pow(base,i) * n[i]    }    return res;}</code></pre><p>æˆ‘çš„è¿™ä¸ªæ–¹æ³•ï¼Œä¼¼ä¹æœ‰äº›æ ¹æ®æµ‹è¯•çš„æ•°æ®ï¼Œæœ‰äº›å–å·§ã€‚ä»£ç åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œç¬¬ä¸€æ­¥æ˜¯é€šå¸¸æ„ä¹‰çš„æŸ¥æ‰¾ï¼Œ<code>i</code> ä» 2 å¼€å§‹ï¼Œä¾æ­¤ç±»åŠ ï¼Œæ‰¾åˆ°æ¯æ¬¡å‡ 1 éƒ½èƒ½è¢«æ•´é™¤çš„æœ€å° <code>i</code> å€¼ã€‚è¿™é‡Œé¢ä¸ºäº†ä¼˜åŒ–ç”¨äº†ä¸€äº›æŠ€å·§ï¼Œæ¯”å¦‚æœ€å¼€å§‹ä¸€éƒ¨å…¶å®æ˜¯è¦æ‰¾ <code>number - 1</code> çš„æ‰€æœ‰å› å­ï¼Œä½†æ³¨æ„ï¼Œå› ä¸ºä¸€ä¸ªæ•°çš„æ‰€æœ‰å› å­éƒ½æ˜¯å¯¹ç§°çš„ã€‚è­¬å¦‚ 12 çš„å› å­ï¼š1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ6ï¼Œ12ã€‚ä» 3 å¼€å§‹å¾€åçš„æ¯ä¸€ä¸ªæ•°ï¼Œåœ¨ä¹‹å‰çš„ç›¸é™¤è¿‡ç¨‹ä¸­éƒ½å¾—åˆ°äº†ã€‚æ¯”å¦‚å’Œ 2 ç›¸é™¤å¾—åˆ° 6ï¼Œå’Œ 3 ç›¸é™¤å¾—åˆ° 4ã€‚</p><p>æ‰€ä»¥æˆ‘åœ¨ä»£ç çš„ç¬¬ä¸€éƒ¨åˆ†åŠ å…¥äº†å˜é‡ <code>divisor</code>ï¼Œå¹¶æŠŠå®ƒåŠ å…¥äº†è·³å‡ºå¾ªç¯çš„æ¡ä»¶ã€‚å› ä¸ºä¸€æ—¦ <code>i</code> è¶…è¿‡äº† <code>number - 1</code>  çš„ä¸€åŠï¼Œé‚£ä¹ˆå°±ä¸å¯èƒ½å­˜åœ¨é™¤äº† <code>number -1</code> ä¹‹å¤–çš„æ•°ï¼Œä½¿å¾—ä»¥ä¹‹ä¸º base èƒ½å¾—åˆ° <code>111...</code>ã€‚</p><p>ä½†å› ä¸ºæ¯æ¬¡ <code>i</code> éƒ½æ˜¯ç±»åŠ  1ï¼Œç»è¿‡å¤šæ¬¡åå¤å®éªŒï¼Œ<code>i</code> è¶…è¿‡ 5000 ä¹‹åï¼Œå†è®¡ç®—é€Ÿåº¦å·²ç»å¾ˆæ…¢äº†ã€‚äºæ˜¯æˆ‘å†™äº†å¦ä¸€ä¸ªå‡½æ•° <code>toTenBase()</code> ï¼Œç»™å‡ºä»»æ„ number å’Œ baseï¼Œè®¡ç®—ä»¥ 10 base çš„æ•°ã€‚æœ€å¼€å§‹å†™è¿™ä¸ªå‡½æ•°ï¼Œä¸è¿‡æ˜¯ä¸ºäº†å»æ‰¾ä¸€äº›è§„å¾‹ã€‚å¯¹äºæµ‹è¯•ä¸­å‡ºç°çš„é‚£äº›å¾ˆå¤§çš„æ•°ï¼Œå¤§éƒ¨åˆ†çš„ç»“æœéƒ½æ˜¯ <code>number - 1</code>ï¼Œç„¶è€Œåœ¨ç‰¹æ®Šæµ‹è¯•éƒ¨åˆ†ï¼Œç±»ä¼¼è¿™æ ·çš„ <code>Test.assertEquals(getMinBase(2500050001), 50000);</code> æ•°å°±å¾ˆéš¾åŠã€‚</p><p>åæ¥ä¹Ÿæ˜¯å€ŸåŠ©å‡½æ•° <code>toTenBase()</code> æ‰å‘ç°ï¼Œç‰¹æ®Šæµ‹è¯•ä¸­çš„æ•°å­—ï¼ŒåŒ–æˆ <code>111â€¦</code> å½¢å¼çš„è¯ï¼Œå¤§å¤šéƒ½æ˜¯ <code>111</code>ï¼Œ<code>1111</code> å’Œ <code>11111</code>ï¼Œå†å¤§çš„è¯å°±æ²¡æœ‰äº†ã€‚å¦‚æœæˆ‘ä»¬è®¾ <code>getMinBase()</code> å‡½æ•°æ‰€å¾—å€¼ä¸º $x$ï¼Œè€Œå¯¹åº” number ä¸º $n$ï¼Œå¯¹äº <code>111</code> çš„ç±»å‹ï¼Œåˆ™å˜æˆä¸€ä¸ªäºŒæ¬¡æ–¹ç¨‹æ±‚è§£ï¼š</p><p>$$x^2 +x+1=n$$</p><p>ç›¸åº”çš„ <code>1111</code> ç±»å‹ï¼Œåˆ™æ˜¯ä¸‰æ¬¡æ–¹ç¨‹æ±‚è§£ï¼š</p><p>$$x^3+x^2 +x+1=n$$</p><p>å¯¹äº <code>11111</code> ï¼ŒæŒ‰ç…§ä¸Šè¿°å½¢å¼ä¹Ÿå¯å†™å‡ºå››æ¬¡æ–¹ç¨‹æ¥ã€‚é‚£ä¹ˆé—®é¢˜å°±æ˜¯ï¼Œé’ˆå¯¹è¿™æ ·çš„æ–¹ç¨‹ï¼Œè¯¥å¦‚ä½•è§£å‘¢ï¼Ÿé‚£ä¹ˆæˆ‘ä»¬å°±è¦æ„è¯†åˆ°ï¼Œ$n$ æ­¤æ—¶å·²ç»å¾ˆå¤§äº†ï¼Œç›¸åº” $x$ ä¹Ÿå¾ˆå¤§ã€‚æ‰€ä»¥å®ƒå¯ä»¥è½¬åŒ–æˆä¸€ä¸ªçƒæé™çš„é—®é¢˜ï¼Œå³ï¼š</p><p>$\lim\limits_{x \to \infty }x^3+x^2 +x+1=\lim\limits_{n \to \infty }n$<br>$\lim\limits_{x \to \infty }x^3=\lim\limits_{n \to \infty }n$</p><p>å› æ­¤å¯¹äºç¬¬ä¸€ä¸ªæ–¹ç¨‹ï¼Œn ç›´æ¥å¼€æ–¹ï¼Œå¯¹äºç¬¬äºŒä¸ªæ–¹ç¨‹ï¼Œn ç›´æ¥å¼€ä¸‰æ¬¡æ–¹ã€‚ç†è®ºç»ˆç©¶åªæ˜¯ç†è®ºï¼Œå®é™…æ£€éªŒä¸€ä¸‹ï¼Œå‘ç°å¯ä»¥ï¼Œäºæ˜¯å°±æ˜¯æœ‰ä»£ç çš„ç¬¬äºŒéƒ¨åˆ†ã€‚</p><h2 id="Other-Solutions"><a href="#Other-Solutions" class="headerlink" title="Other Solutions"></a>Other Solutions</h2><p> <a href="https://www.codewars.com/users/Voile" target="_blank" rel="noopener">Voile</a></p><pre><code class="javascript">function getMinBase(n) {  for(let i=Math.ceil(Math.log2(n)); i&gt;1; i--) {    let root=Math.round(findRoot(n,i));    if([...&#39;1&#39;.repeat(i)].reduce((s,_)=&gt;s*root+1,0)===n) return root;  }}function findRoot(n,i) {  var l=1, r=Number.MAX_SAFE_INTEGER;  while((r-l)/l&gt;1e-12) {    let m=(r+l)/2, g=(Math.pow(m,i)-1)/(m-1);    g&lt;n?l=m:r=m;  }  return (r+l)/2;}</code></pre><p><code>Number.MAX_SAFE_INTEGER</code> æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨ JavaScript ä¸­è¿›è¡Œ <strong>å‡†ç¡®è®¡ç®—</strong>çš„æœ€å¤§æ•°å­—ï¼Œæ¯”ä¹‹æ›´å¤§çš„æ•°ä¾ç„¶å­˜åœ¨ï¼Œä½†å¦‚æœå‚ä¸è®¡ç®—å°±ä¼šè¯¯å·®å¾ˆå¤§ã€‚</p><blockquote><p>The <strong>Number.MAX_SAFE_INTEGER</strong> constant represents the maximum safe integer in JavaScript (<code>253 - 1</code>).</p><p>The reasoning behind that number is that JavaScript uses <a href="http://www.wikiwand.com/en/Double_precision_floating-point_format" target="_blank" rel="noopener">double-precision floating-point format numbers</a> as specified in <a href="http://www.wikiwand.com/en/IEEE_floating_point" target="_blank" rel="noopener">IEEE 754</a> and can only safely represent numbers between <code>-(253 - 1)</code> and <code>253 - 1</code>.</p></blockquote><p> <code>findRoot(n,i)</code> æ­£æ˜¯æ±‚æˆ‘ä¸Šé¢æ‰€è¯´ $i-1$ é˜¶çš„ä¸€å…ƒæ–¹ç¨‹ã€‚</p><pre><code class="javascript">&gt;x = findRoot(1000,4)9.641969245752986&gt;Math.pow(x,3) + Math.pow(x,2) + Math.pow(x,1) + 1999.9999999995179</code></pre><p>å…³é”®ä¸€æ­¥ï¼š<code>g=(Math.pow(m,i)-1)/(m-1)</code>ï¼Œå†™æˆæ•°å­¦å¼æ˜¯ï¼š</p><p>$g = \dfrac{m^i -1}{m-1} = m^{i-1}+m^{i-2} + â€¦ + m + 1$</p><p>æ±‚è§£çš„æ–¹ç¨‹æ˜¯ï¼š</p><p>$f(x) = x^{i-1}+x^{i-2} + â€¦ + x + 1 = n$</p><p>æ³¨æ„åˆ° <code>r</code> å’Œ <code>l</code>ï¼Œåˆ†åˆ«ä¸ºè®¡ç®—çš„ä¸Šç•Œå’Œä¸‹å±Šã€‚æ±‚  <code>r</code> å’Œ <code>l</code> å¹³å‡å€¼ï¼Œå¸¦å…¥å‡ $n$ï¼Œæ¯”è¾ƒ 0ï¼Œå¤§å°ï¼ŒæŒ‰ç»“æœåˆ†åˆ«å†æ¬¡å¸¦å…¥åˆ° <code>r</code> å’Œ <code>l</code>  ä¸­ã€‚æ ‡å‡†çš„äºŒåˆ†æ³•æ±‚æ ¹çš„è¿­ä»£è¿‡ç¨‹ï¼Œbisection methodã€‚</p><p>ä¸‹é¢çœ‹ä¸€ä¸‹å‡½æ•°çš„ä¸»ä½“éƒ¨åˆ†ã€‚ä¸»è¦æ˜¯ for å¾ªç¯ä¸­ <code>i</code> çš„åˆå§‹å€¼ï¼š<code>i=Math.ceil(Math.log2(n))</code>ã€‚<code>i</code> å¯èƒ½çš„ 1 çš„æœ€å¤§ä½æ•°ï¼Œå·²çŸ¥å½“ base ä¸º 2 çš„æ—¶å€™ï¼Œ1 çš„ä½æ•°æ˜¯æœ€å¤šäº†ï¼Œæ‰€ä»¥è¿™é‡Œæ‰ä¼šæ±‚ 2 çš„å¯¹æ•°ã€‚ç„¶åå¾—åˆ° i å€¼çš„ä¸Šç•Œï¼Œä¹‹åå†ä¾æ¬¡å‡ 1ã€‚</p><p><a href="https://www.codewars.com/users/spiderPan" target="_blank" rel="noopener">spiderPan</a></p><pre><code class="javascript">function getMinBase(number) {  for (var b =2; b&lt;= Math.floor(Math.sqrt(number)); b++) {    var num = number;    while (num % b == 1) {      num = Math.floor(num / b);      if (num == 1) {        return b;      }    }  }  return number - 1;}</code></pre><p> <a href="https://www.codewars.com/users/LesRamer" target="_blank" rel="noopener">LesRamer</a>, <a href="https://www.codewars.com/users/yurak" target="_blank" rel="noopener">yurak</a></p><pre><code class="javascript">function getMinBase(x) {  function test(b) {    var z = x;    while(z % b == 1)      z = (z - 1) / b;    return z == 0;  }  for(var n = Math.ceil(Math.log2(x)); n &gt;= 1; --n) {    var b = Math.floor(Math.pow(x,1/n));    if (test(b)) return b;    if (test(b-1)) return b-1;  }  return -1;}</code></pre><p>å‚è€ƒæ–‡ç« ï¼š</p><ul><li><a href="https://math.stackexchange.com/questions/900869/prove-xn-1-x-1xn-1xn-2-x1" target="_blank" rel="noopener">Prove $x^nâˆ’1=(xâˆ’1)(x^{nâˆ’1}+x^{nâˆ’2}+â€¦+x+1)$</a></li><li><a href="http://www.wikiwand.com/zh/äºŒåˆ†æ³•_(æ•¸å­¸" target="_blank" rel="noopener">äºŒåˆ†æ³• (æ•¸å­¸)</a>)</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;è¦ç‚¹&quot;&gt;&lt;a href=&quot;#è¦ç‚¹&quot; class=&quot;headerlink&quot; title=&quot;è¦ç‚¹&quot;&gt;&lt;/a&gt;è¦ç‚¹&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;é™¤æ³•ï¼Œæ±‚ä½™ï¼Œå› å­&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Number.MAX_SAFE_INTEGER&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;äºŒåˆ†æ³•æ±‚æ–¹ç¨‹æ ¹&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;Details&quot;&gt;&lt;a href=&quot;#Details&quot; class=&quot;headerlink&quot; title=&quot;Details&quot;&gt;&lt;/a&gt;Details&lt;/h2&gt;&lt;p&gt;Your task is determine lowest number base system in which the input &lt;code&gt;n&lt;/code&gt; (base 10), expressed in this number base system, is all &lt;code&gt;1&lt;/code&gt; in its digit. See an example:&lt;/p&gt;
&lt;p&gt;â€˜7â€™ in base 2 is â€˜111â€™ - fits! answer is 2&lt;/p&gt;
&lt;p&gt;â€˜21â€™ in base 2 is â€˜10101â€™ - contains â€˜0â€™ does not fit â€˜21â€™ in base 3 is â€˜210â€™ - contains â€˜0â€™ and â€˜2â€™ does not fit â€˜21â€™ in base 4 is â€˜111â€™ - contains only â€˜1â€™ it fits! answer is 4&lt;/p&gt;
&lt;p&gt;&lt;code&gt;n&lt;/code&gt; is always less than &lt;code&gt;Number.MAX_SAFE_INTEGER&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªé¢˜ç›®çš„éš¾åº¦ä¸»è¦åœ¨äºæ€§èƒ½ performance æ–¹é¢ï¼Œå¯¹äºæ•°å€¼è¾ƒå°çš„æ•°å­—ï¼Œé€šå¸¸æ–¹æ³•å¾ˆå®¹æ˜“è®¡ç®—ï¼Œä¸€æ—¦æ¶‰åŠåˆ°ä¹ä½åä½å¾€ä¸Šçš„å¤§æ•°ï¼Œä¸€èˆ¬çš„å¾ªç¯æ–¹æ³•å°±ä¼šè€—æ—¶å¾ˆä¹…ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Coding" scheme="http://reyshawn.com/categories/Coding/"/>
    
    
      <category term="Algorithm" scheme="http://reyshawn.com/tags/Algorithm/"/>
    
      <category term="codewars" scheme="http://reyshawn.com/tags/codewars/"/>
    
      <category term="JavaScript" scheme="http://reyshawn.com/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>@wraps | 6kyu</title>
    <link href="http://reyshawn.com/2018/06/25/@wraps%20%7C%206kyu/"/>
    <id>http://reyshawn.com/2018/06/25/@wraps | 6kyu/</id>
    <published>2018-06-25T02:21:13.613Z</published>
    <updated>2019-01-22T15:14:53.756Z</updated>
    
    <content type="html"><![CDATA[<h2 id="è¦ç‚¹"><a href="#è¦ç‚¹" class="headerlink" title="è¦ç‚¹"></a>è¦ç‚¹</h2><ul><li><code>decorator</code> è£…é¥°å™¨ç”¨æ³•</li><li><code>try</code>â€¦<code>except</code>â€¦ <code>else</code> control flow</li><li><code>getattr()</code> å’Œ <code>setattr()</code></li><li><code>__dict__.update()</code></li></ul><h2 id="Details"><a href="#Details" class="headerlink" title="Details"></a>Details</h2><p>Implement the functools.wraps decorator, which is used to preserve the name and docstring of a decorated function. Your decorator must not modify the behavior of the decorated function. Hereâ€™s an example :</p><pre><code class="python">def identity(func):  @wraps(func)  def wrapper(*args, **kwargs):    &quot;&quot;&quot;Wraps func&quot;&quot;&quot;    return func(*args, **kwargs)  return wrapper@identitydef return_one():  &quot;&quot;&quot;Return one&quot;&quot;&quot;  return 1return_one.__name__ == &#39;return_one&#39; # If wraps hadn&#39;t been used, __name__ would be equal to &#39;wrapper&#39;return_one.__doc__ == &#39;Return one&#39; # If wraps hadn&#39;t been used, __doc__ would be equal to &#39;Wraps func&#39;</code></pre><p><strong>Note: of course, you may not use the functools module for this kata.</strong></p><p>é¢˜ç›®è¦æ±‚ï¼Œç»è¿‡ä¸€æ¬¡äºŒé‡çš„è£…é¥°å™¨ï¼Œä¿ç•™åŸæ¥å‡½æ•°çš„ <code>__name__</code> å’Œ <code>__doc__</code>ã€‚äºŒé‡è£…é¥°å™¨ decoratorï¼Œå°±æ˜¯ç”¨ä¸€ä¸ª decorator å» decorate å¦ä¸€ä¸ª decoratorã€‚è¯¥äºŒé‡è£…é¥°å™¨è£…é¥°åçš„å‡½æ•°ï¼Œ è¾“å‡ºçš„æ˜¯ä¸€é‡è£…é¥°å™¨è£…é¥°è¿‡çš„å‡½æ•°ï¼Œä½†æ˜¯ <code>__name__</code> å’Œ <code>__doc__</code>  å¾—åˆ°ä¿ç•™ï¼ŒåŠä¸ºåŸå‡½æ•°çš„å€¼ã€‚</p><p>ä¾ç…§é¢˜ç›®ç»™çš„ä¾‹å­ï¼Œå°±æ˜¯è¾“å‡ºæ˜¯è¢« decorator wraps ä¿®é¥°è¿‡çš„ <code>wrapper</code> å‡½æ•°ï¼Œå³å‡½æ•°ä¸»ä½“å’ŒåŠŸèƒ½è¿˜æ˜¯ <code>wrapper</code>ï¼Œä½†å› ä¸ºè¢« <code>wraps</code> è£…é¥°äº†ï¼Œè¾“å‡ºçš„ <code>wrapper</code> å‡½æ•°çš„  <code>__name__</code> å’Œ <code>__doc__</code>  å€¼ä¸ºåŸå‡½æ•° <code>return_one</code> çš„å€¼ã€‚</p><a id="more"></a><h2 id="My-Solution"><a href="#My-Solution" class="headerlink" title="My Solution"></a>My Solution</h2><pre><code class="python">def wraps(func):    def first(wrapper):        return func    return first</code></pre><p>æˆ‘çš„è¿™ä¸ªæ–¹æ³•ï¼Œå…¶å®æ˜¯ä¸æ­£ç¡®çš„ã€‚å› ä¸ºæˆ‘è¿™ä¸ªç»è¿‡å‡ æ¬¡ decorate åˆè¾“å‡ºäº†åŸå‡½æ•°ï¼ŒæŒ‰é“ç†åº”è¯¥æ˜¯è¾“å‡º <code>wrapper</code> å‡½æ•°çš„ã€‚</p><h2 id="Other-Solution"><a href="#Other-Solution" class="headerlink" title="Other Solution"></a>Other Solution</h2><p> <a href="https://www.codewars.com/users/siebenschlaefer" target="_blank" rel="noopener">siebenschlaefer</a></p><pre><code class="python">def wraps(wrapped):    def wrapper(func):        for attr in (&#39;__module__&#39;, &#39;__name__&#39;, &#39;__qualname__&#39;, &#39;__doc__&#39;, &#39;__annotations__&#39;):            try:                value = getattr(wrapped, attr)            except AttributeError:                pass            else:                setattr(func, attr, value)        func.__dict__.update(getattr(wrapped, attr, {}))        func.__wrapped__ = wrapped        return func    return wrapper</code></pre><p>é¦–å…ˆæ³¨æ„ä¸€ä¸‹å¯¹åº”å…³ç³»ã€‚ç»è¿‡ä¸€æ¬¡äºŒé‡çš„è£…é¥°åï¼Œ<br><code>wrapped</code> â¡ï¸ <code>return_one</code><br><code>func</code> â¡ï¸ <code>wrapper</code></p><p>ç›®æ ‡æ˜¯è¾“å‡º <code>func</code> ï¼Œä½†è¦æŠŠ <code>func</code> çš„ <code>__name__</code> å’Œ <code>__doc__</code> è¿›è¡Œä¿®æ”¹ã€‚ä¿®æ”¹è¿™äº› built-in çš„å€¼ç”¨åˆ°äº† <code>getattr()</code> å’Œ <code>setattr()</code>ã€‚</p><blockquote><p>You use them if the attribute you want to access is a variable and not a literal string. They let you parameterize attribute access/setting.</p><p>Thereâ€™s no reason to do <code>getattr(x, &#39;foobar&#39;)</code>, but you might have a variable called <code>attr</code> that could be set to â€œfoobarâ€ or â€œotherAttrâ€, and then do <code>getattr(x, attr)</code>.</p></blockquote><p><code>try</code>â€¦<code>except</code>â€¦ <code>else</code>ï¼Œ<code>else</code> åé¢æ˜¯å½“ <code>try</code> ä¸­çš„å†…å®¹æ— é”™è¯¯æ—¶æ‰æ‰§è¡Œçš„ï¼Œå¦åˆ™æ—¶æ‰§è¡Œ <code>except</code> ä¸­çš„å†…å®¹ã€‚</p><blockquote><p><code>try</code>:<br>   Normal execution block<br><code>except</code> A:<br>   Exception A handle<br><code>except</code> B:<br>   Exception B handle<br><code>except</code>:<br>   Other exception handleelse:<br><code>else</code>:<br>   if no exception,get here<br><code>finally</code>:<br>   print(â€œfinallyâ€)   </p></blockquote><p> <a href="https://www.codewars.com/users/Voile" target="_blank" rel="noopener">Voile</a></p><pre><code class="python">def wraps(func):    def f(g):        g.__name__ = func.__name__        g.__doc__ = func.__doc__        return g    return f</code></pre><p>Voile çš„è§£æ³•æ›´ç®€æ´ã€‚</p><p>å‚è€ƒæ–‡ç« ï¼š</p><ul><li><a href="https://stackoverflow.com/questions/19123707/why-use-setattr-and-getattr-built-ins" target="_blank" rel="noopener">Why use setattr() and getattr() built-ins?</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;è¦ç‚¹&quot;&gt;&lt;a href=&quot;#è¦ç‚¹&quot; class=&quot;headerlink&quot; title=&quot;è¦ç‚¹&quot;&gt;&lt;/a&gt;è¦ç‚¹&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;decorator&lt;/code&gt; è£…é¥°å™¨ç”¨æ³•&lt;/li&gt;
&lt;li&gt;&lt;code&gt;try&lt;/code&gt;â€¦&lt;code&gt;except&lt;/code&gt;â€¦ &lt;code&gt;else&lt;/code&gt; control flow&lt;/li&gt;
&lt;li&gt;&lt;code&gt;getattr()&lt;/code&gt; å’Œ &lt;code&gt;setattr()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;__dict__.update()&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;Details&quot;&gt;&lt;a href=&quot;#Details&quot; class=&quot;headerlink&quot; title=&quot;Details&quot;&gt;&lt;/a&gt;Details&lt;/h2&gt;&lt;p&gt;Implement the functools.wraps decorator, which is used to preserve the name and docstring of a decorated function. Your decorator must not modify the behavior of the decorated function. Hereâ€™s an example :&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;python&quot;&gt;def identity(func):
  @wraps(func)
  def wrapper(*args, **kwargs):
    &amp;quot;&amp;quot;&amp;quot;Wraps func&amp;quot;&amp;quot;&amp;quot;
    return func(*args, **kwargs)
  return wrapper

@identity
def return_one():
  &amp;quot;&amp;quot;&amp;quot;Return one&amp;quot;&amp;quot;&amp;quot;
  return 1

return_one.__name__ == &amp;#39;return_one&amp;#39; # If wraps hadn&amp;#39;t been used, __name__ would be equal to &amp;#39;wrapper&amp;#39;
return_one.__doc__ == &amp;#39;Return one&amp;#39; # If wraps hadn&amp;#39;t been used, __doc__ would be equal to &amp;#39;Wraps func&amp;#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Note: of course, you may not use the functools module for this kata.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é¢˜ç›®è¦æ±‚ï¼Œç»è¿‡ä¸€æ¬¡äºŒé‡çš„è£…é¥°å™¨ï¼Œä¿ç•™åŸæ¥å‡½æ•°çš„ &lt;code&gt;__name__&lt;/code&gt; å’Œ &lt;code&gt;__doc__&lt;/code&gt;ã€‚äºŒé‡è£…é¥°å™¨ decoratorï¼Œå°±æ˜¯ç”¨ä¸€ä¸ª decorator å» decorate å¦ä¸€ä¸ª decoratorã€‚è¯¥äºŒé‡è£…é¥°å™¨è£…é¥°åçš„å‡½æ•°ï¼Œ è¾“å‡ºçš„æ˜¯ä¸€é‡è£…é¥°å™¨è£…é¥°è¿‡çš„å‡½æ•°ï¼Œä½†æ˜¯ &lt;code&gt;__name__&lt;/code&gt; å’Œ &lt;code&gt;__doc__&lt;/code&gt;  å¾—åˆ°ä¿ç•™ï¼ŒåŠä¸ºåŸå‡½æ•°çš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;ä¾ç…§é¢˜ç›®ç»™çš„ä¾‹å­ï¼Œå°±æ˜¯è¾“å‡ºæ˜¯è¢« decorator wraps ä¿®é¥°è¿‡çš„ &lt;code&gt;wrapper&lt;/code&gt; å‡½æ•°ï¼Œå³å‡½æ•°ä¸»ä½“å’ŒåŠŸèƒ½è¿˜æ˜¯ &lt;code&gt;wrapper&lt;/code&gt;ï¼Œä½†å› ä¸ºè¢« &lt;code&gt;wraps&lt;/code&gt; è£…é¥°äº†ï¼Œè¾“å‡ºçš„ &lt;code&gt;wrapper&lt;/code&gt; å‡½æ•°çš„  &lt;code&gt;__name__&lt;/code&gt; å’Œ &lt;code&gt;__doc__&lt;/code&gt;  å€¼ä¸ºåŸå‡½æ•° &lt;code&gt;return_one&lt;/code&gt; çš„å€¼ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="Coding" scheme="http://reyshawn.com/categories/Coding/"/>
    
    
      <category term="Algorithm" scheme="http://reyshawn.com/tags/Algorithm/"/>
    
      <category term="codewars" scheme="http://reyshawn.com/tags/codewars/"/>
    
      <category term="JavaScript" scheme="http://reyshawn.com/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>Binary Search Trees | 5kyu</title>
    <link href="http://reyshawn.com/2018/06/23/Binary%20Search%20Trees%20%7C%205kyu/"/>
    <id>http://reyshawn.com/2018/06/23/Binary Search Trees | 5kyu/</id>
    <published>2018-06-23T05:01:32.183Z</published>
    <updated>2019-01-22T15:15:34.410Z</updated>
    
    <content type="html"><![CDATA[<h2 id="è¦ç‚¹"><a href="#è¦ç‚¹" class="headerlink" title="è¦ç‚¹"></a>è¦ç‚¹</h2><ul><li><code>__str__()</code> çš„å‡ ç§å®šä¹‰æ–¹æ³•ï¼šå¦‚  <code>&quot;%s&quot; % value</code>  å’Œ <code>&#39;{}&#39;.format()</code></li><li>A <code>and</code> B <code>and</code> C</li><li><code>if</code>  â€¦ <code>else</code> å•è¡Œè¯­å¥</li><li><code>for</code> â€¦ <code>in</code> å•è¡Œè¯­å¥</li><li><code>join()</code> å‡½æ•°</li><li><code>str()</code> å‡½æ•°ä¸ <code>__str__()</code> æ–¹æ³•</li></ul><h2 id="Details"><a href="#Details" class="headerlink" title="Details"></a>Details</h2><p>A <code>Tree</code> consists of a root, which is of type <code>Node</code>, and possibly a left subtree of type <code>Tree</code> and possibly a right subtree of type <code>Tree</code>. If the left subtree is present, then all its nodes are less than the parent treeâ€™s root and if the right tree is present, then all its nodes are greater than the parent treeâ€™s root. In this kata, classes <code>Tree</code> and <code>Node</code> have been provided. However, the methods <code>__eq__</code>, <code>__ne__</code>, and <code>__str__</code> are missing from the <code>Tree</code> class. Your job is to provide the implementation of these methods. The example test cases should provide enough information to implement these methods correctly.</p><p>As an illustrative example, here is the string representation of a tree that has two nodes, â€˜Bâ€™ at the root and â€˜Câ€™ at the root of the right subtree. The left subtree is missing and the right subtree is a leaf, i.e., has no subtrees: </p><pre><code class="python">&#39;[_ B [C]]&#39;</code></pre><p>This tree is obtained by evaluating the following expression:</p><pre><code class="python">Tree(Node(&#39;B&#39;), None, Tree(Node(&#39;C&#39;))))</code></pre><p>Notice in particular that when one subtree, but not both, is missing, an underscore is in its place, a single space separates the root node from the subtrees, and when both subtrees are missing, the root node is enclosed in brackets.</p><a id="more"></a><h2 id="My-Solution"><a href="#My-Solution" class="headerlink" title="My Solution"></a>My Solution</h2><pre><code class="python">class Tree(object):    def __init__(self, root, left=None, right=None):        assert root and type(root) == Node        if left: assert type(left) == Tree and left.root &lt; root        if right: assert type(right) == Tree and root &lt; right.root        self.left = left        self.root = root        self.right = right    def is_leaf(self):        return not(self.left or self.right)    def __str__(self):        rep = &#39;[&#39;        if self.left is not None:            rep += self.left.__str__() + &#39; &#39;        elif self.right is not None:            rep += &#39;_ &#39; + self.root.__str__() + &#39; &#39; + self.right.__str__()            return rep + &#39;]&#39;        rep += self.root.__str__()        if self.right is not None:            rep += &#39; &#39; + self.right.__str__()        elif self.left is not None:            rep = self.left.__str__() + &#39; &#39; + self.root.__str__() + &#39; _&#39;            return rep + &#39;]&#39;        return rep + &#39;]&#39;    def __eq__(self, other):        if (self is None) and (other is None):            return True        if self and other and self.root == other.root:            return (self.left == other.left) and (self.right == other.right)        else:            return False    def __ne__(self, other):        return not self == otherclass Node(object):    def __init__(self, value, weight=1):        self.value = value        self.weight = weight    def __str__(self):        return str(self.value)    def __lt__(self, other):        return self.value &lt; other.value    def __gt__(self, other):        return self.value &gt; other.value    def __eq__(self, other):        return self.value == other.value    def __ne__(self, other):        return self.value != other.value</code></pre><h2 id="Other-Solution"><a href="#Other-Solution" class="headerlink" title="Other Solution"></a>Other Solution</h2><p> <a href="https://www.codewars.com/users/siebenschlaefer" target="_blank" rel="noopener">siebenschlaefer</a></p><pre><code class="python">class Tree(object):    # ... å…¶ä½™é‡å¤éƒ¨åˆ†çœç•¥    def __str__(self):        if self.is_leaf():            return &quot;[%s]&quot; % self.root        return &quot;[%s %s %s]&quot; % (            self.left if self.left else &quot;_&quot;,            self.root,            self.right if self.right else &quot;_&quot;)    def __eq__(self, other):        if not other:            return False        return (            self.root == other.root and            self.left == other.left and            self.right == other.right)    def __ne__(self, other):        return not (self == other)# ... å…¶ä½™é‡å¤éƒ¨åˆ†çœç•¥</code></pre><p>è¿™ä¸ªåœ¨ <code>__str__()</code> éƒ¨åˆ†å†™å¾—å¼‚å¸¸ç®€æ´ï¼Œå¹¶ä¸”åˆ©ç”¨åˆ°äº† <code>is_leaf()</code> æ–¹æ³•ã€‚å¦‚æœ  <code>is_leaf()</code> è¿”å›å€¼ä¸º <code>True</code>ï¼Œåˆ™è¯´æ˜ self æ²¡æœ‰ left å’Œ rightã€‚è¿˜æœ‰ <code>if</code> çš„å•è¡Œå†™æ³•ï¼Œä¹Ÿè¦å­¦ä¼šä½¿ç”¨ã€‚</p><p><code>__eq__()</code> æ–¹æ³•çš„ <code>and</code> è¿ç»­ä½¿ç”¨ï¼Œè¦ç”¨æ‹¬å·æ‹¬èµ·æ¥ã€‚</p><p><a href="https://www.codewars.com/users/Voile" target="_blank" rel="noopener">Voile</a></p><pre><code class="python">class Tree(object):    def __init__(self, root, left=None, right=None):        assert root and type(root) == Node        if left: assert type(left) == Tree and left.root &lt; root        if right: assert type(right) == Tree and root &lt; right.root        self.left = left        self.root = root        self.right = right    def is_leaf(self):        return not(self.left or self.right)    def __str__(self):        if type(self.left) != Tree and type(self.right) != Tree: return &#39;[{}]&#39;.format(self.root)        if type(self.left) == Tree and type(self.right) == Tree: return &#39;[{} {} {}]&#39;.format(self.left, self.root, self.right)        return &#39;[{}]&#39;.format(&#39; &#39;.join(str(v) if v else &#39;_&#39; for v in [self.left, self.root, self.right]))    def __eq__(self, other):        if self.root != other.root: return False        if type(self.left) != type(other.left): return False        if type(self.right) != type(other.right): return False        return self.left == other.left and self.right == other.right    def __ne__(self, other):        return not self == other</code></pre><p>Voile åœ¨ <code>__str__()</code> ä¸­ç”¨çš„ return å½¢å¼æ˜¯ <code>&#39;[{}]&#39;.format()</code>ï¼Œä¹Ÿæ˜¯åˆ†äº†ä¸‰ç§æƒ…å†µã€‚æ³¨æ„ç¬¬ä¸‰ç§çš„å•è¡Œå†™æ³•ï¼Œå½¢å¦‚ï¼š</p><pre><code class="python">&gt;&gt;&gt; &#39; &#39;.join(str(v) if v else &#39;_&#39; for v in [1, 0, 3])&#39;1 _ 3&#39;&gt;&gt;&gt; &#39;&#39;.join(str(v) if v else &#39;_&#39; for v in [1, 0, 3])&#39;1_3&#39;</code></pre><p><code>__eq__()</code> å†™æ³•æ€è·¯å’Œæˆ‘çš„å†™æ³•å·®ä¸å¤šï¼Œéƒ½æ˜¯åœ¨ä¿è¯ <code>self.root == other.root</code> çš„æƒ…å†µä¸‹ï¼Œè¾“å‡ºä¸€ä¸ª <code>and</code> å¹¶åˆ—è¯­å¥ï¼Œ<code>self.left == other.left and self.right == other.right</code>ã€‚å½“ç„¶ï¼Œä»–è¿™é‡Œç”¨ <code>type</code> æ¥åˆ¤æ–­æ˜¯å¦æ˜¯ Node è¿˜æ˜¯ Noneã€‚</p><p> <a href="https://www.codewars.com/users/brettso" target="_blank" rel="noopener">brettso</a></p><pre><code class="python">class Tree(object):    def __init__(self, root, left=None, right=None):        assert root and type(root) == Node        if left: assert type(left) == Tree and left.root &lt; root        if right: assert type(right) == Tree and root &lt; right.root        self.left = left        self.root = root        self.right = right    def is_leaf(self):        return not(self.left or self.right)    def __str__(self):        if self.is_leaf():            return &#39;[&#39; + self.root.value + &#39;]&#39;        left = &quot;_&quot; if not self.left else self.left.__str__()        right = &quot;_&quot; if not self.right else self.right.__str__()        return &#39;[&#39; + left + &#39; &#39; + self.root.value + &#39; &#39; + right + &#39;]&#39;        def __eq__(self, other):        return self.__str__() == other.__str__()    def __ne__(self, other):        return self.__str__() != other.__str__()</code></pre><p>è¿™ä¸ª <code>__eq__()</code> çš„å†™æ³•å¾ˆå·§å¦™å•Šï¼Œç›´æ¥åˆ©ç”¨äº† <code>__str__()</code> æ¥è¿›è¡Œåˆ¤æ–­ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;è¦ç‚¹&quot;&gt;&lt;a href=&quot;#è¦ç‚¹&quot; class=&quot;headerlink&quot; title=&quot;è¦ç‚¹&quot;&gt;&lt;/a&gt;è¦ç‚¹&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;__str__()&lt;/code&gt; çš„å‡ ç§å®šä¹‰æ–¹æ³•ï¼šå¦‚  &lt;code&gt;&amp;quot;%s&amp;quot; % value&lt;/code&gt;  å’Œ &lt;code&gt;&amp;#39;{}&amp;#39;.format()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;A &lt;code&gt;and&lt;/code&gt; B &lt;code&gt;and&lt;/code&gt; C&lt;/li&gt;
&lt;li&gt;&lt;code&gt;if&lt;/code&gt;  â€¦ &lt;code&gt;else&lt;/code&gt; å•è¡Œè¯­å¥&lt;/li&gt;
&lt;li&gt;&lt;code&gt;for&lt;/code&gt; â€¦ &lt;code&gt;in&lt;/code&gt; å•è¡Œè¯­å¥&lt;/li&gt;
&lt;li&gt;&lt;code&gt;join()&lt;/code&gt; å‡½æ•°&lt;/li&gt;
&lt;li&gt;&lt;code&gt;str()&lt;/code&gt; å‡½æ•°ä¸ &lt;code&gt;__str__()&lt;/code&gt; æ–¹æ³•&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;Details&quot;&gt;&lt;a href=&quot;#Details&quot; class=&quot;headerlink&quot; title=&quot;Details&quot;&gt;&lt;/a&gt;Details&lt;/h2&gt;&lt;p&gt;A &lt;code&gt;Tree&lt;/code&gt; consists of a root, which is of type &lt;code&gt;Node&lt;/code&gt;, and possibly a left subtree of type &lt;code&gt;Tree&lt;/code&gt; and possibly a right subtree of type &lt;code&gt;Tree&lt;/code&gt;. If the left subtree is present, then all its nodes are less than the parent treeâ€™s root and if the right tree is present, then all its nodes are greater than the parent treeâ€™s root. In this kata, classes &lt;code&gt;Tree&lt;/code&gt; and &lt;code&gt;Node&lt;/code&gt; have been provided. However, the methods &lt;code&gt;__eq__&lt;/code&gt;, &lt;code&gt;__ne__&lt;/code&gt;, and &lt;code&gt;__str__&lt;/code&gt; are missing from the &lt;code&gt;Tree&lt;/code&gt; class. Your job is to provide the implementation of these methods. The example test cases should provide enough information to implement these methods correctly.&lt;/p&gt;
&lt;p&gt;As an illustrative example, here is the string representation of a tree that has two nodes, â€˜Bâ€™ at the root and â€˜Câ€™ at the root of the right subtree. The left subtree is missing and the right subtree is a leaf, i.e., has no subtrees: &lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;python&quot;&gt;&amp;#39;[_ B [C]]&amp;#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This tree is obtained by evaluating the following expression:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;python&quot;&gt;Tree(Node(&amp;#39;B&amp;#39;), None, Tree(Node(&amp;#39;C&amp;#39;))))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Notice in particular that when one subtree, but not both, is missing, an underscore is in its place, a single space separates the root node from the subtrees, and when both subtrees are missing, the root node is enclosed in brackets.&lt;/p&gt;
    
    </summary>
    
      <category term="Coding" scheme="http://reyshawn.com/categories/Coding/"/>
    
    
      <category term="Algorithm" scheme="http://reyshawn.com/tags/Algorithm/"/>
    
      <category term="codewars" scheme="http://reyshawn.com/tags/codewars/"/>
    
      <category term="Python" scheme="http://reyshawn.com/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>Born to be chained | 4kyu</title>
    <link href="http://reyshawn.com/2018/06/20/Born%20to%20be%20chained%20%7C%204kyu/"/>
    <id>http://reyshawn.com/2018/06/20/Born to be chained | 4kyu/</id>
    <published>2018-06-20T03:14:56.675Z</published>
    <updated>2019-01-22T15:15:53.626Z</updated>
    
    <content type="html"><![CDATA[<ul><li>å¯¹äº Object çš„éå†ï¼›</li></ul><h2 id="Details"><a href="#Details" class="headerlink" title="Details"></a>Details</h2><p>Function composition is a powerful technique. For example:</p><pre><code class="javascript">function sum(x, y) {  return x + y;}function double(x) {  return sum(x, x);}function minus (x, y) {  return x - y;}function addOne(x) {  return sum(x, 1);}double(sum(2, 3)); // 10</code></pre><p>But in complex expressions, composition may be difficult to understand. For example:</p><pre><code class="javascript">double(double(addOne(sum(7, minus(sum(5, sum(4, 5)), 4))))); // 72</code></pre><p>In this kata, we will implement a function that allows us to perform this by applying a fluid style:</p><pre><code class="javascript">c.sum(4, 5).sum(5).minus(4).sum(7).addOne().double().double().execute(); // 72</code></pre><p>Your job is implement the <code>chain</code> function:</p><pre><code class="javascript">function chain(fns) {}var c = chain({sum: sum, minus: minus, double: double, addOne: addOne});</code></pre><p>As you can see, this function receives the methods to be chained and returns an object that allows you to call the chained methods. The result is obtained by calling the <code>execute</code>method.</p><p>Chained functions receive an arbitrary number of arguments. The first function in the chain receives all its arguments. In the other functions, the first argument is the result of the previous function and then it only receives the remainder arguments (second, third, etc.). The tests always pass the appropriate arguments and you do not have to worry about checking this.</p><p>Note that the chain can be reused (the internal state is not stored):</p><a id="more"></a><pre><code class="javascript">c.sum(3, 4).execute(); //7c.sum(1, 2).execute(); //3</code></pre><p>Other examples:</p><pre><code class="javascript">var c1 = c.sum(1, 2);c1.execute(); // == fns.sum(1, 2) == 3c1.double().execute(); // == fns.double(fns.sum(1, 2)) == 6c1.addOne().execute(); // == fns.addOne(fns.sum(1, 2)) == 4c1.execute(); // == fns.sum(1, 2) == 3var c2 = c1.sum(5);c2.addOne().execute(); // == fns.addOne(fns.sum(fns.sum(1, 2) 5)) == 9c2.sum(3).execute(); // == fns.sum(c1.sum(fns.sum(1, 2), 5), 3) == 11c2.execute(); // == fns.sum(fns.sum(1, 2), 5) == 8c1.execute(); // == fns.sum(1, 2) == 3</code></pre><h2 id="Other-Solutions"><a href="#Other-Solutions" class="headerlink" title="Other Solutions"></a>Other Solutions</h2><p> <a href="https://www.codewars.com/users/ooflorent" target="_blank" rel="noopener">ooflorent</a>, <a href="https://www.codewars.com/users/ChungGor" target="_blank" rel="noopener">ChungGor</a>, <a href="https://www.codewars.com/users/pompeu2004" target="_blank" rel="noopener">pompeu2004</a>, <a href="https://www.codewars.com/users/guilhermeconti" target="_blank" rel="noopener">guilhermeconti</a>, <a href="https://www.codewars.com/users/lwio" target="_blank" rel="noopener">lwio</a> (plus 2 more warriors)</p><pre><code class="javascript">function chain(fns) {  function ChainWrapper(x) {    this._ = x  }  Object.keys(fns).forEach(function(prop) {    var fn = fns[prop]    ChainWrapper.prototype[prop] = function() {      var args = [].slice.call(arguments)      if (this._ != null) args.unshift(this._)      var x = fn.apply(null, args)      return new ChainWrapper(x)    }  })  ChainWrapper.prototype.execute = function() {    return this._  }  return new ChainWrapper()}</code></pre><p>line 6: å…³æ³¨ä¸€ä¸‹å¯¹äºä¸€èˆ¬ Object  çš„éå†æ–¹æ³•ã€‚ä¸»è¦ç”¨åˆ° <code>Object.keys()</code> å’Œ <code>forEach()</code>ï¼Œå¦å¤–ç›¸å¯¹åº”çš„ä¹Ÿæœ‰ <code>Object.values()</code>ã€‚</p><p>line 9: ChainWrapper æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç»™è¿™ä¸ªå‡½æ•°æ·»åŠ è‹¥å¹²å­å‡½æ•°ï¼ˆæˆ–ä¹Ÿç§° methodï¼‰çš„åŠæ³•ã€‚è¿™é‡Œè¦å¼„æ˜ç™½ä¸€ä¸ªé—®é¢˜ï¼Œç›´æ¥ç”¨ <code>ChainWrapper[prop]</code> å’Œä½¿ç”¨ <code>ChainWrapper.prototype[prop]</code> çš„åŒºåˆ«åœ¨å“ªé‡Œã€‚å‰è€…åªç»™è¯¥å‡½æ•°åŠ å…¥äº†ä¸€ä¸ªå­å‡½æ•°ï¼Œè€Œåè€…é€è¿‡åŸå‹é“¾ï¼Œç»™æœ€åŸå§‹çš„<strong>å‡½æ•°å¯¹è±¡</strong>åŠ å…¥äº†ä¸€ä¸ªå­å‡½æ•°ï¼Œå¦‚æœè®²å‡½æ•°ä½œä¸º Object è¿›è¡Œåˆ›å»ºï¼Œå½¢å¦‚ <code>var a = new ChainWrapper(3)</code> è¿™æ ·ï¼Œå‰è€…åˆ›å»ºçš„å­å‡½æ•°ä¸å¤å­˜åœ¨ï¼Œåè€…åˆ›å»ºçš„å­å‡½æ•°ä¾ç„¶å­˜åœ¨ã€‚å¦‚ä¸‹ä¾‹å­ï¼š</p><pre><code class="javascript">function ChainWrapper(x) {    this._ = x}ChainWrapper[&#39;sum&#39;] = (a,b) =&gt; (a+b)ChainWrapper.sum(2,3) //5ChainWrapper[&#39;sum&#39;](2,3) //5var a = new ChainWrapper(1) //ChainWrapper { _: 1 }a.sum(2,3) //TypeError: a.sum is not a functionChainWrapper.prototype[&#39;sum&#39;] = (a,b) =&gt; (a+b)var a = new ChainWrapper(1) //ChainWrapper { _: 1 }a.sum(2,3) //5</code></pre><p>å½“å°†å‡½æ•°åˆ©ç”¨ new å…³é”®å­—è¿›è¡Œåˆ›å»ºçš„æ—¶å€™ï¼Œå¾—åˆ°çš„æ˜¯ä¸€ä¸ª Object è€Œä¸æ˜¯ functionã€‚</p><p>line 11: åˆæ¬¡å®šä¹‰æ—¶ï¼Œ<code>chain()</code> å‡½æ•°è¿”å›çš„æ˜¯ <code>return new ChainWrapper()</code>ï¼Œæ­¤æ—¶ Object å†…çš„ <code>this._</code> ä¸º <code>undefined</code>ã€‚å½“ Object å¼€å§‹ chain ç¬¬ä¸€ä¸ªå­å‡½æ•°æ—¶ï¼Œå¾—åˆ°çš„è¿ç®—ç»“æœè®°å½•åœ¨ <code>this._</code> ä¸­ï¼Œæ­¤æ—¶ä¸ºé null å€¼ï¼Œåˆ™åœ¨ä¸‹ä¸€æ¬¡ chain çš„æ—¶å€™ï¼Œå‰ä¸€æ¬¡å‡½æ•°çš„è¿ç®—ç»“æœè¦ä½œä¸ºä¸‹ä¸€æ¬¡ chain çš„å‚æ•°ä¼ å…¥è¿›å»ï¼Œæ‰€ä»¥è¦ <code>args.unshift(this._)</code>ã€‚</p><p>ä½†è¿™é‡Œæœ‰ä¸€ä¸ªå° bugï¼Œå½“ <code>this._</code> å‡ºç° <code>NaN</code> æ—¶ï¼Œæ­¤æ—¶åˆ¤å®š <code>NaN != null</code>  çš„ç»“æœä¼šæ˜¯ <code>true</code>ã€‚ç„¶åä¼šæŠŠ <code>NaN</code> ä¼ å…¥åˆ°å‚æ•°çš„æœ€å¼€å¤´ï¼Œé‚£ä¹ˆæ¯æ¬¡ç»“æœéƒ½ä¼šæ˜¯ <code>NaN</code>ã€‚ä¿®å¤çš„åŠæ³•å°±æ˜¯åˆ¤å®š <code>x</code> æ˜¯å¦ä¸º <code>NaN</code>ï¼Œåœ¨ <code>apply()</code> æ–¹æ³•ä½¿ç”¨ååŠ ä¸€ä¸ªæ¡ä»¶ç»“æ„ã€‚</p><pre><code class="javascript">if (isNaN(x)) return new ChainWrapper();</code></pre><p>ä½†æ³¨æ„ï¼Œè¿™é‡Œé»˜è®¤äº†å½“è¾“å‡ºä¸º <code>NaN</code> ä¸ºè¾“å‡ºæ— æ•ˆï¼Œä¸ä¼šä¿ç•™ä¹‹å‰çš„å‚æ•°ã€‚å¦‚æœè¦ä¿ç•™å‚æ•°ï¼Œä½†ä¸åŒå‡½æ•°å‚æ•°æ•°é‡éƒ½ä¸ä¸€æ ·ï¼Œå°±æ¯”è¾ƒå¤æ‚äº†ã€‚æ¯”å¦‚ <code>sum()</code> ä¸¤ä¸ªæ•°ç›¸åŠ ï¼Œåªè¾“å…¥ 1 ä¸ªæ•°æ—¶ä¼šå¾—åˆ° <code>NaN</code>ï¼Œæ­¤æ—¶è¾“å…¥çš„é‚£ä¸ªæ•°ä¹Ÿæ˜¯ç›´æ¥èˆå¼ƒä¸å†ä¿ç•™äº†ã€‚</p><p><a href="https://www.codewars.com/users/evk" target="_blank" rel="noopener">evk</a>, <a href="https://www.codewars.com/users/niweic" target="_blank" rel="noopener">niweic</a>, <a href="https://www.codewars.com/users/marek_mistrzuk" target="_blank" rel="noopener">marek_mistrzuk</a></p><pre><code class="javascript">function chain(fns) {  let Chain = function(val){    this.execute = () =&gt; val;  };  for(let i in fns) Chain.prototype[i] = function (a, b) {    let val = this.execute(),        args = val === null ? [a, b] : [val, a];    return new Chain(fns[i](...args));  }  return new Chain(null);}</code></pre><p>å‚è€ƒæ–‡ç« ï¼š</p><ul><li><a href="https://stackoverflow.com/questions/115548/why-is-isnannull-false-in-js" target="_blank" rel="noopener">Why is isNaN(null) == false in JS?</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;ul&gt;
&lt;li&gt;å¯¹äº Object çš„éå†ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;Details&quot;&gt;&lt;a href=&quot;#Details&quot; class=&quot;headerlink&quot; title=&quot;Details&quot;&gt;&lt;/a&gt;Details&lt;/h2&gt;&lt;p&gt;Function composition is a powerful technique. For example:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;javascript&quot;&gt;function sum(x, y) {
  return x + y;
}

function double(x) {
  return sum(x, x);
}

function minus (x, y) {
  return x - y;
}

function addOne(x) {
  return sum(x, 1);
}

double(sum(2, 3)); // 10
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;But in complex expressions, composition may be difficult to understand. For example:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;javascript&quot;&gt;double(double(addOne(sum(7, minus(sum(5, sum(4, 5)), 4))))); // 72
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In this kata, we will implement a function that allows us to perform this by applying a fluid style:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;javascript&quot;&gt;c.sum(4, 5).sum(5).minus(4).sum(7).addOne().double().double().execute(); // 72
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Your job is implement the &lt;code&gt;chain&lt;/code&gt; function:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;javascript&quot;&gt;function chain(fns) {
}

var c = chain({sum: sum, minus: minus, double: double, addOne: addOne});
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As you can see, this function receives the methods to be chained and returns an object that allows you to call the chained methods. The result is obtained by calling the &lt;code&gt;execute&lt;/code&gt;method.&lt;/p&gt;
&lt;p&gt;Chained functions receive an arbitrary number of arguments. The first function in the chain receives all its arguments. In the other functions, the first argument is the result of the previous function and then it only receives the remainder arguments (second, third, etc.). The tests always pass the appropriate arguments and you do not have to worry about checking this.&lt;/p&gt;
&lt;p&gt;Note that the chain can be reused (the internal state is not stored):&lt;/p&gt;
    
    </summary>
    
      <category term="Coding" scheme="http://reyshawn.com/categories/Coding/"/>
    
    
      <category term="Algorithm" scheme="http://reyshawn.com/tags/Algorithm/"/>
    
      <category term="codewars" scheme="http://reyshawn.com/tags/codewars/"/>
    
      <category term="JavaScript" scheme="http://reyshawn.com/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>è±¡æ£‹ (Xiangqi/Chinese Chess) Board Validator | 4kyu</title>
    <link href="http://reyshawn.com/2018/06/10/%E8%B1%A1%E6%A3%8B%20(XiangqiChinese%20Chess)%20Board%20Validator%20%7C%204kyu/"/>
    <id>http://reyshawn.com/2018/06/10/è±¡æ£‹ (XiangqiChinese Chess) Board Validator | 4kyu/</id>
    <published>2018-06-10T03:54:25.832Z</published>
    <updated>2019-01-22T15:18:52.661Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Details"><a href="#Details" class="headerlink" title="Details"></a>Details</h2><p>Your friend recently has shown you some chess puzzles he found somewhere. Itâ€™s not your ordinary chess: but the mysterious, distinct relative of chess, the legendary <a href="http://www.wikiwand.com/en/Xiangqi" target="_blank" rel="noopener">è±¡æ£‹</a>, also known as Xiangqi/Chinese chess! As a Chinese, you know that your friend doesnâ€™t know anything in Chinese besides recognizing a few sigils (for example, he doesnâ€™t know what is <code>ä¸ƒæ­¥æ“’å£«</code> or <code>é›™é¦¬é£²æ³‰</code>), so itâ€™s probably likely that the â€œpuzzlesâ€ he got is actually bogus, and the pieces are not placed properly. However, you donâ€™t want to actually teach him Xiangqi either (yet), so the best tactic you could come up with is to write a validator program and let your friend use it instead of using you.</p><hr><p>You will be given an ASCII board. Xiangqi board is 9 tiles wide and 10 tiles high, with the pieces placed as follows:</p><pre><code>Example (the starting Xiangqi board):è»Šé¦¬è±¡å£«å°‡å£«è±¡é¦¬è»Šã€€ã€€ã€€ï½œï¼¸ï½œã€€ã€€ã€€ã€€ç ²ã€€ï¼‹ï¼ï¼‹ã€€ç ²ã€€å’ã€€å’ã€€å’ã€€å’ã€€å’ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼å…µã€€å…µã€€å…µã€€å…µã€€å…µã€€ç‚®ã€€ï¼‹ï¼ï¼‹ã€€ç‚®ã€€ã€€ã€€ã€€ï½œï¼¸ï½œã€€ã€€ã€€ä¿¥å‚Œç›¸ä»•å¸¥ä»•ç›¸å‚Œä¿¥The bottom and top half corresponds to red and black pieces, respectively.Note that red and black have different characters to distinguish the same piece of both sides.</code></pre><p>Your function, <code>chessValidator</code>, should determine whether the pieces in argument <code>board</code> are placed legally. Unlike the chess youâ€™re familiar with, there are restrictions as to where the various chess pieces can be at:</p><a id="more"></a><pre><code>ä¿¥/è»Š, å‚Œ/é¦¬, ç‚®/ç ² (2 max): no restrictionsç›¸/è±¡ (2 max): they can only stay at 7 spots at their side of the board:ï¼ï¼ï¼¯ï¼ï¼ï¼ï¼¯ï¼ï¼ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ï¼¯ã€€ã€€ï¼‹ï¼¯ï¼‹ã€€ã€€ï¼¯ã€€ã€€ã€€ï½œï¼¸ï½œã€€ã€€ã€€ã€€ã€€ï¼¯ï¼‹ï¼ï¼‹ï¼¯ã€€ã€€Don&#39;t let them go to the other side of the board: it&#39;s called é£›è±¡éæ²³, which is bad and you should feel bad about it.ä»•/å£« (2 max): they can only stay at the center or the 4 corners of the 3x3 &quot;palace&quot; (ä¹å®®):ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ï¼¯ï¼ï¼¯ã€€ã€€ã€€ã€€ã€€ã€€ï½œï¼¯ï½œã€€ã€€ã€€ã€€ã€€ã€€ï¼¯ï¼ï¼¯ã€€ã€€ã€€å¸¥/å°‡ (always 1): they can stay at every tile inside the palace, and nowhere else:ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ï¼‹ï¼ï¼‹ã€€ã€€ã€€ã€€ã€€ã€€ï½œï¼¸ï½œã€€ã€€ã€€ã€€ã€€ã€€ï¼‹ï¼ï¼‹ã€€ã€€ã€€    // anywhere inside this 3x3 block is okayBecause they are your &quot;kings&quot; in Xiangqi, it is mandatory that one and only one exists.Additionally, å¸¥/å°‡ cannot face each other vertically without any pieces inbetween:ã€€ã€€ã€€ï¼‹å°‡ï¼‹ã€€ã€€ã€€ã€€ã€€ã€€ï½œï¼¸ï½œã€€ã€€ã€€ã€€ã€€ã€€ï¼‹ï¼ï¼‹ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ï¼‹å¸¥ï¼‹ã€€ã€€ã€€ã€€ã€€ã€€ï½œï¼¸ï½œã€€ã€€ã€€ã€€ã€€ã€€ï¼‹ï¼ï¼‹ã€€ã€€ã€€  // this is illegal because they&#39;re directly facing each other at the same columnå…µ/å’ (5 max): at their starting positions (look at the above starting board), they can only move forward. However, once they reached the other side, they can move sideways as well as moving forward, at least until they reach the last row of the opponent side (no falling back, though!):ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ï¼ï¼ï¼ï¼å…µï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼å…µå…µã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€The left and right å…µs can do nothing but moving forward. The center one, however, can move sideways since it has crossed the center line.(By the way, there is no such thing as pawn promotion in Xiangqi.)</code></pre><hr><p>You program should validate that:</p><ul><li>Number of pieces of each side is within their respective limits</li><li>The pieces are placed in a legal position</li><li>Said configuration is legal (in respect to å¸¥/å°‡ and å…µ/å’ rules). Note that we donâ€™t care about whether it is practically reachable in-game, Xiangqi endgame puzzles can be pretty ridiculous at piece placements, and you might even start out being checked. We only care about whether it is legal. For example:</li></ul><pre><code>ï¼ï¼ï¼ï¼å…µï¼å…µï¼å…µå…µï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼å…µ</code></pre><p>would be illegal because å…µ cannot move sideways before they go across the center row, which means the above configuration is fundamentally impossible.</p><p>You can assume that the board will always be well-formatted. Always assume red is at the bottom.</p><p>See example test cases for some examples.</p><h2 id="My-Solution"><a href="#My-Solution" class="headerlink" title="My Solution"></a>My Solution</h2><pre><code class="javascript">function chessValidator(board) {    let b = board.split(&#39;\n&#39;).map(x =&gt; x.split(&#39;&#39;));    // check the number of ä¿¥/è»Š, å‚Œ/é¦¬, ç‚®/ç ²    let chariot1 = chessIndex(b, &#39;è»Š&#39;);    let chariot2 = chessIndex(b, &#39;ä¿¥&#39;);    let horse1 = chessIndex(b, &#39;é¦¬&#39;);    let horse2 = chessIndex(b, &#39;å‚Œ&#39;);    let cannon1 = chessIndex(b, &#39;ç ²&#39;);    let cannon2 = chessIndex(b, &#39;ç‚®&#39;);    let elep1 = chessIndex(b, &#39;è±¡&#39;);    let elep2 = chessIndex(b, &#39;ç›¸&#39;);    let advisor1 = chessIndex(b, &#39;å£«&#39;);    let advisor2 = chessIndex(b, &#39;ä»•&#39;);    let two = [chariot1, chariot2, horse1, horse2,cannon1,cannon2, elep1, elep2, advisor1, advisor2];    for (var i = 0; i &lt; two.length; i++) {        if (two[i].length &gt; 2) {            console.log(&#39;over two pieces for the same kind&#39;)            return false;        }    }    // ç›¸/è±¡    let elep1T = [[0,2], [0,6], [2,0], [2,4], [2,8], [4,2], [4,6]];    let elep2T = [[9,2], [9,6], [7,0], [7,4], [7,8], [5,2], [5,6]];    for (var i = 0; i &lt; elep1.length; i++) {        if(!isArrayInArray(elep1T,elep1[i])) {            console.log(&#39;è±¡ at the wrong position&#39;)            return false;        }    }    for (var i = 0; i &lt; elep2.length; i++) {        if(!isArrayInArray(elep2T,elep2[i])) {            console.log(&#39;ç›¸ at the wrong position&#39;)            return false;        }    }    // ä»•/å£«    let advisor1T = [[0,3], [0,5], [1,4], [2,3], [2,5]]    let advisor2T = [[9,3], [9,5], [8,4], [7,3], [7,5]]    for (var i = 0; i &lt; advisor1.length; i++) {        if(!isArrayInArray(advisor1T,advisor1[i])) {            console.log(&#39;å£« at the wrong position&#39;)            return false;        }    }    for (var i = 0; i &lt; advisor2.length; i++) {        if(!isArrayInArray(advisor2T,advisor2[i])) {            console.log(&#39;ä»• at the wrong position&#39;)            return false;        }    }    // å…µ/å’    let soldier1 = chessIndex(b, &#39;å’&#39;);    let soldier2 = chessIndex(b, &#39;å…µ&#39;);    for (var i = 0; i &lt; soldier1.length; i++) {        if (soldier1[i][0] &lt; 3) {            console.log(&#39;å’ at the wrong position&#39;)            return false;        } else if(soldier1[i][0] &lt; 5 &amp;&amp; soldier1[i][1] % 2 === 1 ) {            console.log(&#39;å’ at the wrong position&#39;)            return false;        }    }    for (var i = 0; i &lt; soldier2.length; i++) {        if (soldier2[i][0] &gt; 6) {            console.log(&#39;å…µ at the wrong position&#39;)            return false;        } else if(soldier2[i][0] &gt; 4 &amp;&amp; soldier2[i][1] % 2 === 1 ) {            console.log(&#39;å…µ at the wrong position&#39;)            return false;        }    }    for (var i = 0; i &lt; 9; i++) {        if(b[3][i] === &#39;å’&#39; &amp;&amp; b[4][i] === &#39;å’&#39;) {            console.log(&#39;å’ at the wrong position&#39;)            return false;        }        if(b[5][i] === &#39;å…µ&#39; &amp;&amp; b[6][i] === &#39;å…µ&#39;) {            console.log(&#39;å…µ at the wrong position&#39;)            return false;        }    }    // å¸¥/å°‡    let general1 = chessIndex(b, &#39;å°‡&#39;);    let general2 = chessIndex(b, &#39;å¸¥&#39;);    if (general1.length !== 1 || general2.length !== 1) {        console.log( &#39;å¸¥/å°‡ lost &#39;)        return false;    }    if (general1[0][0] &gt; 2 ||        general1[0][1] &lt; 3 ||        general1[0][1] &gt; 5 ||        general2[0][0] &lt; 7 ||        general2[0][1] &lt; 3 ||        general2[0][1] &gt; 5) {        console.log( &#39;å¸¥/å°‡ at the wrong position &#39;)        return false;    }    if(general1[0][1] === general2[0][1]) {        let k = general1[0][1]        for (var i = general1[0][0]+1; i &lt; general2[0][0]; i++) {            if (b[i][k] !== &#39;ï¼¸&#39; &amp;&amp;                b[i][k] !== &#39;ï¼&#39; &amp;&amp;                b[i][k] !== &#39;ã€€&#39; &amp;&amp;                b[i][k] !== &#39;ï½œ&#39; &amp;&amp;                b[i][k] !== &#39;ï¼‹&#39;) {                break;            }        }        if(i === general2[0][0]) {            console.log(&#39;å¸¥/å°‡ are directly facing each other at the same column&#39;)            return false;        }    }    //if a flipped starting board    return true;}function chessIndex(b, s) {    let res = [];    for (var i = 0; i &lt; b.length; i++) {        let k = -1;        while((k = b[i].indexOf(s,k+1)) !== -1) {            res.push([i,k]);        }    }    return res;}function isArrayInArray(arr, item){  var item_as_string = JSON.stringify(item);  var contains = arr.some(function(ele){    return JSON.stringify(ele) === item_as_string;  });  return contains;}</code></pre><p>ä¸»è¦è®²ä¸€ä¸‹é‡å¤ç”¨åˆ°çš„ä¸¤ä¸ª function å§ï¼Œä¸€ä¸ªæ˜¯ <code>chessIndex()</code> æ¥å¾—åˆ°æ£‹ç›˜ä¸ŠæŸä¸ªæ£‹å­çš„åæ ‡ï¼Œè¾“å‡ºçš„æ˜¯ä¸€ä¸ªäºŒç»´ arrayã€‚å¦ä¸€ä¸ª <code>isArrayInArray(arr, item)</code> ï¼Œarr æ˜¯ä¸€ä¸ªäºŒç»´ arrayï¼Œitem æ˜¯ä¸€ä¸ª arrayï¼Œæ£€æµ‹ item æ˜¯å¦å† arr é‡Œé¢ã€‚</p><p><code>chessIndex()</code> éš¾ç‚¹åœ¨ä¸å¤„ç†ä¸€è¡Œå†…é‡å¤çš„å…ƒç´ ã€‚æ¯”å¦‚:</p><pre><code class="javascript">&gt;a = a.split(&quot;&quot;)[ &#39;ã€€&#39;, &#39;ç ²&#39;, &#39;ã€€&#39;, &#39;ï¼‹&#39;, &#39;ï¼&#39;, &#39;ï¼‹&#39;, &#39;ã€€&#39;, &#39;ç ²&#39;, &#39;ã€€&#39; ]&gt;a.indexOf(&#39;ç ²&#39;)1&gt;a.indexOf(&#39;ç ²&#39;,2)7&gt;</code></pre><p>è¿™é‡Œ array ä¸­å«æœ‰ä¸¤ä¸ª <code>&#39;ç ²&#39;</code>ã€‚è¦è·å–ç¬¬äºŒä¸ª <code>&#39;ç ²&#39;</code>ï¼Œå°±è¦ç»™ <code>indexOf()</code> åŠ ä¸Šç¬¬äºŒä¸ªå‚æ•°ã€‚</p><p><code>isArrayInArray()</code> æ–¹æ³•ä¸­ç”¨åˆ° <code>JSON.stringfy</code>ï¼š</p><pre><code class="javascript">&gt;a = [[1,2],[2,3]][ [ 1, 2 ], [ 2, 3 ] ]&gt;JSON.stringify(a)&#39;[[1,2],[2,3]]&#39;&gt;obj = { &quot;name&quot;:&quot;John&quot;, &quot;age&quot;:30, &quot;city&quot;:&quot;New York&quot;};{ name: &#39;John&#39;, age: 30, city: &#39;New York&#39; }&gt;JSON.stringify(obj)&#39;{&quot;name&quot;:&quot;John&quot;,&quot;age&quot;:30,&quot;city&quot;:&quot;New York&quot;}&#39;&gt;obj = { &quot;name&quot;:&quot;John&quot;, &quot;today&quot;:new Date(), &quot;city&quot;:&quot;New York&quot;};{ name: &#39;John&#39;,  today: 2018-06-10T03:44:24.742Z,  city: &#39;New York&#39; }&gt;JSON.stringify(obj)&#39;{&quot;name&quot;:&quot;John&quot;,&quot;today&quot;:&quot;2018-06-10T03:44:24.742Z&quot;,&quot;city&quot;:&quot;New York&quot;}&#39;&gt; obj = { &quot;name&quot;:&quot;John&quot;, &quot;age&quot;:function () {return 30;}, &quot;city&quot;:&quot;New York&quot;};{ name: &#39;John&#39;, age: [Function: age], city: &#39;New York&#39; }&gt;JSON.stringify(obj)&#39;{&quot;name&quot;:&quot;John&quot;,&quot;city&quot;:&quot;New York&quot;}&#39;&gt;obj.age = obj.age.toString()&#39;function () {return 30;}&#39;&gt;obj { name: &#39;John&#39;,  age: &#39;function () {return 30;}&#39;,  city: &#39;New York&#39; }&gt;JSON.stringify(obj)&#39;{&quot;name&quot;:&quot;John&quot;,&quot;age&quot;:&quot;function () {return 30;}&quot;,&quot;city&quot;:&quot;New York&quot;}&#39;&gt;</code></pre><p>ä¸Šé¢çš„ä¾‹å­ï¼Œåé¢ä¸€å¤§éƒ¨åˆ†æ‘˜è‡ª <a href="https://www.w3schools.com/js/js_json_stringify.asp" target="_blank" rel="noopener">JSON.stringify()</a>ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå¯ä»¥æŠŠ  arrayï¼Œobject ç­‰ç›´æ¥è½¬åŒ–æˆ stringã€‚æœ€åä¸¤ä¸ªä¾‹å­æ˜¯è®²ï¼Œå¦‚æœ object ä¸­åŒ…å«å‡½æ•°ï¼Œåˆ™ä¼šè¢«å¿½ç•¥ã€‚</p><p>ç”¨åˆ°äº† <code>some()</code> æ–¹æ³•ï¼Œ<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/some" target="_blank" rel="noopener">MDN docs</a> ç»™å‡ºçš„è§£é‡Šï¼š</p><blockquote><p>The <code>some()</code> method tests whether at least one element in the array passes the test implemented by the provided function.</p></blockquote><p>ä¸Šè¿°ä¸¤ä¸ªå‡½æ•°æ–¹æ³•çš„æ„é€ æ˜¯å…³é”®ã€‚åœ¨è¿™ä¸¤ä¸ªå‡½æ•°çš„åŸºç¡€ä¸Šï¼Œå¯¹æ£‹ç›˜çš„æ£‹å­è¿›è¡Œä¾æ­¤æŒ‰ç…§ç›¸åº”çš„çš„è§„åˆ™è¿›è¡Œæ£€æµ‹ï¼Œå‰©ä¸‹çš„åªæ˜¯ä¸€äº›æ¯”è¾ƒç¹ççš„å·¥ä½œï¼Œå’Œç»†èŠ‚ä¸Šçš„ä¿®é¥°ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Details&quot;&gt;&lt;a href=&quot;#Details&quot; class=&quot;headerlink&quot; title=&quot;Details&quot;&gt;&lt;/a&gt;Details&lt;/h2&gt;&lt;p&gt;Your friend recently has shown you some chess puzzles he found somewhere. Itâ€™s not your ordinary chess: but the mysterious, distinct relative of chess, the legendary &lt;a href=&quot;http://www.wikiwand.com/en/Xiangqi&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;è±¡æ£‹&lt;/a&gt;, also known as Xiangqi/Chinese chess! As a Chinese, you know that your friend doesnâ€™t know anything in Chinese besides recognizing a few sigils (for example, he doesnâ€™t know what is &lt;code&gt;ä¸ƒæ­¥æ“’å£«&lt;/code&gt; or &lt;code&gt;é›™é¦¬é£²æ³‰&lt;/code&gt;), so itâ€™s probably likely that the â€œpuzzlesâ€ he got is actually bogus, and the pieces are not placed properly. However, you donâ€™t want to actually teach him Xiangqi either (yet), so the best tactic you could come up with is to write a validator program and let your friend use it instead of using you.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;You will be given an ASCII board. Xiangqi board is 9 tiles wide and 10 tiles high, with the pieces placed as follows:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Example (the starting Xiangqi board):

è»Šé¦¬è±¡å£«å°‡å£«è±¡é¦¬è»Š
ã€€ã€€ã€€ï½œï¼¸ï½œã€€ã€€ã€€
ã€€ç ²ã€€ï¼‹ï¼ï¼‹ã€€ç ²ã€€
å’ã€€å’ã€€å’ã€€å’ã€€å’
ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼
ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼
å…µã€€å…µã€€å…µã€€å…µã€€å…µ
ã€€ç‚®ã€€ï¼‹ï¼ï¼‹ã€€ç‚®ã€€
ã€€ã€€ã€€ï½œï¼¸ï½œã€€ã€€ã€€
ä¿¥å‚Œç›¸ä»•å¸¥ä»•ç›¸å‚Œä¿¥

The bottom and top half corresponds to red and black pieces, respectively.
Note that red and black have different characters to distinguish the same piece of both sides.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Your function, &lt;code&gt;chessValidator&lt;/code&gt;, should determine whether the pieces in argument &lt;code&gt;board&lt;/code&gt; are placed legally. Unlike the chess youâ€™re familiar with, there are restrictions as to where the various chess pieces can be at:&lt;/p&gt;
    
    </summary>
    
      <category term="Coding" scheme="http://reyshawn.com/categories/Coding/"/>
    
    
      <category term="Algorithm" scheme="http://reyshawn.com/tags/Algorithm/"/>
    
      <category term="codewars" scheme="http://reyshawn.com/tags/codewars/"/>
    
      <category term="JavaScript" scheme="http://reyshawn.com/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>Argument Mapper | 5kyu</title>
    <link href="http://reyshawn.com/2018/06/07/Argument%20Mapper%20%7C%205kyu/"/>
    <id>http://reyshawn.com/2018/06/07/Argument Mapper | 5kyu/</id>
    <published>2018-06-07T07:32:38.890Z</published>
    <updated>2019-01-22T15:15:24.035Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Details"><a href="#Details" class="headerlink" title="Details"></a>Details</h2><p>As part of a broader functionality you need to develop an argument mapper.</p><p>The function receives a function object as first parameter and an unknown number of arguments [zero to many]. You have to return an associative array that maps the name of an argument and its related value.</p><p>The usage is:</p><pre><code class="javascript">function func1(arg1, arg2) { ... }var map = createArgumentMap(func1,&#39;valueOfArg1&#39;, &#39;valueOfArg2&#39;);console.log(map[&#39;arg1&#39;]);  // writes &#39;valueOfArg1&#39;console.log(map[&#39;arg2&#39;]);  // writes &#39;valueOfArg2&#39;</code></pre><p>The passed values are in the same order as they appear in the function object.</p><p>Invalid inputs, e.g. non-function objects, or wrong number of arguments, are not considered.</p><p>Hajime!</p><a id="more"></a><h2 id="My-Solution"><a href="#My-Solution" class="headerlink" title="My Solution"></a>My Solution</h2><pre><code class="javascript">function createArgumentMap(func) {    // create an argument map and return it    let args = Array.prototype.slice.call(arguments,1);    let res = {};    for (var i = 1; i &lt;= args.length; i++) {        res[&#39;a&#39; + i] = args[i-1]    }    return res  }</code></pre><p>å…³äº JavaScript ä¸­ arguments çš„æ€§è´¨å‚çœ‹ï¼š<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/arguments" target="_blank" rel="noopener">Arguments object</a></p><p><code>res[&#39;a&#39;+i]</code> æ˜¯ä¸ºäº†å¥‘åˆ test ä¸­éƒ½æ˜¯ç”¨å½¢å¦‚ map[a1] map[a2] ç­‰æ¥ check ç­”æ¡ˆçš„ã€‚è¿™é‡Œæˆ‘çš„æ–¹æ³•æœ‰äº›å–å·§ã€‚å®é™…ä¸Šéœ€è¦å¾—åˆ°çš„æ˜¯å®é™…å®šä¹‰å‡½æ•°æ—¶ä½¿ç”¨çš„å‚æ•°åç§°ï¼Œå°±åƒä¸Šæ¬¡ review ä¸­é‚£æ ·ï¼Œè¦ç”¨åˆ° <code>.toString()</code> å’Œæ­£åˆ™è¡¨è¾¾å¼ã€‚</p><h2 id="Other-Solutions"><a href="#Other-Solutions" class="headerlink" title="Other Solutions"></a>Other Solutions</h2><p><a href="https://www.codewars.com/users/colbydauph" target="_blank" rel="noopener">colbydauph</a></p><pre><code class="javascript">function createArgumentMap(func) {  var args = (/function\s[^(]*\(([^)]+)\)/g.exec(func.toString()) || [&#39;&#39;]).pop().split(/,/g);  return Array.prototype.slice.call(arguments, 1).reduce(function(p, c, i){ return p[args[i]] = c, p }, {});}</code></pre><p><code>reduce()</code> ä¸­ callback å‡½æ•°çš„ä¸‰ä¸ªå‚æ•°ï¼Œä¾æ¬¡åˆ†åˆ«æ˜¯ <code>accumulator</code>, <code>currentValue</code>, <code>currentIndex</code>ã€‚å¯¹åº”ä»£ç ä¸­çš„ <code>function(p, c, i){...}</code></p><p>æ­£åˆ™è¡¨è¾¾å¼åˆ†æï¼š</p><p><code>/function\s[^(]*\(([^)]+)\)/g</code></p><ul><li><code>/â€¦/g</code> : è¡¨æ˜æ­£åˆ™è¡¨è¾¾å¼ global æ¨¡å¼ï¼Œæ‰¾åˆ°æ‰€æœ‰å¯èƒ½çš„ matchï¼Œè€Œä¸æ˜¯ä»…ä»…æ˜¯æ‰¾åˆ°ç¬¬ä¸€ä¸ª mathc å°±åœä¸‹æ¥ã€‚</li><li><code>function\s</code> : ä»¥ function å¼€å¤´ï¼Œç´§æ¥ç€æ˜¯ä¸€ä¸ª space ç©ºæ ¼ <code>\s</code>ã€‚</li><li><code>[^(]*</code> : 0 ä¸ªæˆ–å¤šä¸ªé <code>(</code> çš„å­—ç¬¦ã€‚</li><li><code>\(</code>: åŒ¹é…å·¦æ‹¬å· <code>(</code>ã€‚</li><li><code>([^)]+)</code>: 1ä¸ªæˆ–å¤šä¸ªé <code>)</code> çš„å­—ç¬¦ã€‚æ³¨æ„è¿™é‡Œç”¨æ‹¬å·æ‹¬ä½ï¼Œé‚£ä¹ˆè¾“å‡ºåŒ¹é…ç»“æœæ—¶ä¹Ÿä¼šæŠŠè¿™ä¸ªæ‹¬å·æ‹¬ä½çš„åŒ¹é…è¾“å‡ºæ¥ã€‚</li><li><code>\)</code>: åŒ¹é…å³æ‹¬å· <code>)</code>ã€‚</li></ul><pre><code class="javascript">&gt;(/function\s[^(]*\(([^)]+)\)/g.exec(func1.toString()))[ &#39;function func1(arg1, arg2)&#39;,  &#39;arg1, arg2&#39;,  index: 0,  input: &#39;function func1(arg1, arg2) { console.log(arg1, arg2) }&#39; ]&gt;(/function\s[^(]*\([^)]+\)/g.exec(func1.toString()))[ &#39;function func1(arg1, arg2)&#39;,  index: 0,  input: &#39;function func1(arg1, arg2) { console.log(arg1, arg2) }&#39; ]&gt;</code></pre><p>ä¸Šè¿°å±•ç¤ºäº†åŠ ä¸­é—´é‚£å¯¹æ‹¬å·ï¼Œå’Œä¸åŠ æ‹¬å·æ—¶çš„åŒºåˆ«ã€‚</p><p>å¦å¤–æ³¨æ„è¿™é‡Œçš„ <code>.split(/,/g)</code> æ–¹æ³•çš„å‚æ•°ã€‚è¿™é‡Œçš„å‚æ•°å¹¶ä¸æ˜¯ä¸¤ä¸ªã€‚è€Œæ˜¯ä¸€ä¸ªï¼Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œglobal æ¨¡å¼åŒ¹é…å•å­—ç¬¦ <code>,</code>ï¼Œç”¨æ­£åˆ™è¡¨è¾¾å¼çš„ <code>/.../g</code> æ‰©èµ·æ¥ã€‚åŒç†ä¹Ÿå¯ä»¥å†™æˆ <code>.split(&#39;,&#39;)</code>ã€‚</p><p><code>.reduce()</code>æ–¹æ³•ä½¿ç”¨åŠå‚æ•°è¯´æ˜ï¼š<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce" target="_blank" rel="noopener">Array.prototype.reduce()</a></p><p>å…³äºæœ€ååœ¨ reduce çš„ callback å‡½æ•°ä¸­ï¼Œreturn é‚£é‡Œå‡ºç°çš„ commaï¼Œ<code>return p[args[i]] = c, p</code>ï¼Œå…¶å®å°±æ˜¯å¤šä¸ªè¯­å¥çš„ç®€å†™ï¼Œå…ˆè¿›è¡Œèµ‹å€¼ï¼Œç„¶åè¾“å‡º <code>p</code>ã€‚å‚è§ stack overflow ä¸Šçš„è§£é‡Šï¼š<a href="https://stackoverflow.com/questions/10284536/return-statement-with-multiple-comma-separated-values" target="_blank" rel="noopener">return statement with multiple comma separated values</a></p><blockquote><p>Itâ€™s the <a href="http://es5.github.com/#x11.14" target="_blank" rel="noopener">comma operator</a>. It runs a series of expressions, in order, and then returns the result of the <em>last</em> of them.  </p></blockquote><p><a href="https://www.codewars.com/users/stnever" target="_blank" rel="noopener">stnever</a></p><pre><code class="javascript">function createArgumentMap(func) {  var argumentNames = getArgumentNames(func);  var argumentValues = arguments;  var result = {};  argumentNames.forEach(function(key, index) {    result[key] = argumentValues[index+1];      });  return result;}// shamelessly copied from http://stackoverflow.com/questions/1007981var STRIP_COMMENTS = /((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg;var ARGUMENT_NAMES = /([^\s,]+)/g;function getArgumentNames(func) {  var fnStr = func.toString().replace(STRIP_COMMENTS, &#39;&#39;)  var result = fnStr.slice(fnStr.indexOf(&#39;(&#39;)+1, fnStr.indexOf(&#39;)&#39;)).match(ARGUMENT_NAMES)  if(result === null)     result = []  return result}</code></pre>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Details&quot;&gt;&lt;a href=&quot;#Details&quot; class=&quot;headerlink&quot; title=&quot;Details&quot;&gt;&lt;/a&gt;Details&lt;/h2&gt;&lt;p&gt;As part of a broader functionality you need to develop an argument mapper.&lt;/p&gt;
&lt;p&gt;The function receives a function object as first parameter and an unknown number of arguments [zero to many]. You have to return an associative array that maps the name of an argument and its related value.&lt;/p&gt;
&lt;p&gt;The usage is:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;javascript&quot;&gt;function func1(arg1, arg2) { ... }

var map = createArgumentMap(func1,&amp;#39;valueOfArg1&amp;#39;, &amp;#39;valueOfArg2&amp;#39;);
console.log(map[&amp;#39;arg1&amp;#39;]);  // writes &amp;#39;valueOfArg1&amp;#39;
console.log(map[&amp;#39;arg2&amp;#39;]);  // writes &amp;#39;valueOfArg2&amp;#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The passed values are in the same order as they appear in the function object.&lt;/p&gt;
&lt;p&gt;Invalid inputs, e.g. non-function objects, or wrong number of arguments, are not considered.&lt;/p&gt;
&lt;p&gt;Hajime!&lt;/p&gt;
    
    </summary>
    
      <category term="Coding" scheme="http://reyshawn.com/categories/Coding/"/>
    
    
      <category term="Algorithm" scheme="http://reyshawn.com/tags/Algorithm/"/>
    
      <category term="codewars" scheme="http://reyshawn.com/tags/codewars/"/>
    
      <category term="JavaScript" scheme="http://reyshawn.com/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>Default Arguments | 4kyu</title>
    <link href="http://reyshawn.com/2018/06/05/Default%20Arguments%20%7C%204kyu/"/>
    <id>http://reyshawn.com/2018/06/05/Default Arguments | 4kyu/</id>
    <published>2018-06-05T08:56:46.278Z</published>
    <updated>2019-01-22T15:14:34.880Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Details"><a href="#Details" class="headerlink" title="Details"></a>Details</h2><p>Write a function <code>defaultArguments</code>. It takes a function as an argument, along with an object containing default values for that functionâ€™s arguments, and returns another function which defaults to the right values. </p><p>You cannot assume that the functionâ€™s arguments have any particular names.</p><p>You should be able to call <code>defaultArguments</code> repeatedly to change the defaults.</p><pre><code class="javascript">function add(a,b) { return a+b;};var add_ = defaultArguments(add,{b:9});add_(10); // returns 19add_(10,7); // returns 17add_(); // returns NaNadd_ = defaultArguments(add_,{b:3, a:2});add_(10); // returns 13 nowadd_(); // returns 5add_ = defaultArguments(add_,{c:3}); // doesn&#39;t do anything, since c isn&#39;t an argumentadd_(10); // returns NaNadd_(10,10); // returns 20</code></pre><p>HINT: This problem requires using <code>Fuction.prototype.toString()</code> in order to extract a functionâ€™s argument list</p><a id="more"></a><h2 id="My-Solution"><a href="#My-Solution" class="headerlink" title="My Solution"></a>My Solution</h2><pre><code class="javascript">function defaultArguments(func, params) {    // get the properties list of params    let defArg = Object.keys(params);    // use Function.prototype.toString() to get the arguments list    let args = func.args || func.toString().replace(/\/\/.*$|\/\*.*?\*\/|\s/gm, &#39;&#39;).match(/(?:[\w]+(?:,[\w]+)*)?(?=\))/m)[0].split(&#39;,&#39;);    // pass the properties into func    let newArgs = {};    for (var i = 0; i &lt; defArg.length; i++) {        if (args.indexOf(defArg[i]) &gt; -1) {            let idx = args.indexOf(defArg[i]);            newArgs[idx] = params[defArg[i]];        }    }    // bind the func and params into a new function    let detour = function() {                let argsArray = [].slice.call(arguments);                let x = Object.keys(newArgs);                for (var i = 0; i &lt; x.length; i++) {                    if(x[i] &gt;= argsArray.length) {                        argsArray[x[i]] = newArgs[x[i]];                    }                }                return func.apply(this,argsArray);            }    detour.args = args;    return detour;}</code></pre><p><code>args</code> é‚£ä¸€å¤§ä¸²æ­£åˆ™è¡¨è¾¾å¼ï¼Œè·å¾—çš„æ˜¯åŸå‡½æ•°çš„å‚æ•°åˆ—è¡¨ï¼Œæ˜¯ä¸€ä¸ª arrayã€‚<code>defArg</code> æ˜¯å‡½æ•° <code>defaultArguments()</code> é¢„å…ˆç»™å®šçš„å‚æ•°ã€‚å°†ä¸¤è€…åˆå¹¶æˆæ–°çš„å‚æ•° <code>newArgs</code> ï¼Œç±»å‹ä¸º objectã€‚</p><p>ä¸¾ä¾‹è¯´æ˜ï¼Œå¦‚æœ <code>params</code> ä¼ å…¥çš„å€¼æ˜¯ <code>{ b: 3, a: 2 }</code>ï¼Œé‚£ä¹ˆç»è¿‡ä¸­é—´ 10 è¡Œåˆ° 16 è¡Œçš„å¾ªç¯è¿ç®—å¾—åˆ°çš„ <code>newArgs</code> å€¼æ˜¯ <code>{ &#39;0&#39;: 2, &#39;1&#39;: 3 }</code>ã€‚</p><p>20 è¡Œ <code>argsArray = [].slice.call(arguments);</code>ä½œç”¨æ˜¯æ‰“å°å‚æ•°åˆ—è¡¨ã€‚ä¸¾ä¾‹è¯´æ˜ï¼š</p><pre><code class="javascript">&gt;function add(a,b) { console.log([].slice.call(arguments));return a+b;};undefined&gt;add(1,2)[ 1, 2 ]3&gt;add(1,2,3)[ 1, 2, 3 ]3&gt;add(1,2,3,4)[ 1, 2, 3, 4 ]3</code></pre><p>å› ä¸ºæ•´ä¸ªå‡½æ•°æœ€å return çš„æ˜¯ detourã€‚ä¹Ÿå°±æ˜¯è¯´å½“ç¬¬ä¸€æ¬¡è¿è¡Œ <code>defaultArguments()</code> æ—¶ï¼Œä»…ä»…æ˜¯å£°æ˜äº† <code>detour()</code> å‡½æ•°ä½†æ˜¯å¹¶æ²¡æœ‰è¿è¡Œã€‚æŒ‰ç…§ details é‡Œç»™å‡ºçš„ä¾‹å­ï¼Œåªæœ‰å½“ <code>add_(10)</code> è°ƒç”¨æ—¶ï¼Œ <code>detour()</code> å‡½æ•°æ‰çœŸæ­£è¢«è¿è¡Œã€‚æ­¤æ—¶çš„ <code>arguments</code> å€¼ä¸º <code>[10]</code>ã€‚</p><p>27 è¡Œ <code>apply()</code> æ–¹æ³•çš„åº”ç”¨ï¼Œå°±æ˜¯è°ƒå– <code>func</code> å‡½æ•°ï¼Œå¹¶ç»™ä»–ç‰¹å®šçš„ arguments å€¼ï¼Œå¹¶è·å¾—ç»“æœã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¿®æ”¹ <code>func</code> å‡½æ•°çš„ <code>this</code> æŒ‡å‘çš„ï¼Œ æ˜¯ <code>this</code> è¿˜æ˜¯ <code>null</code> å¯¹ç»“æœéƒ½æ˜¯æ²¡æœ‰å½±å“çš„ã€‚<a href="https://stackoverflow.com/questions/9644044/javascript-this-pointer-within-nested-function" target="_blank" rel="noopener">å› ä¸ºéƒ½æ˜¯å¯¹å‡½æ•°çš„ç›´æ¥è°ƒç”¨ï¼Œä¸å­˜åœ¨å¯¹æŸä¸ª object çš„ method è¿›è¡Œè°ƒç”¨ã€‚</a></p><p>æ³¨æ„ç¬¬ 29 è¡Œçš„ï¼Œå‡½æ•°ä¹Ÿæ˜¯ objectï¼Œè€Œä¸”è¿™ä¸ªå®šä¹‰ä½¿å¾—è¿”å›çš„å‡½æ•°å¯¹è±¡å¤šæºå¸¦äº† args ä¿¡æ¯ã€‚è¿™ä¸€ç‚¹å½“æ—¶è‡ªå·±æ²¡æœ‰æƒ³åˆ°ï¼Œä¹Ÿæ˜¯çœ‹äº†ç­”æ¡ˆåæ‰æ˜ç™½çš„ã€‚</p><h2 id="Other-Solutions"><a href="#Other-Solutions" class="headerlink" title="Other Solutions"></a>Other Solutions</h2><p> <a href="https://www.codewars.com/users/mrkishi" target="_blank" rel="noopener">mrkishi</a>, <a href="https://www.codewars.com/users/guyingll" target="_blank" rel="noopener">guyingll</a>, <a href="https://www.codewars.com/users/iphp" target="_blank" rel="noopener">iphp</a>, <a href="https://www.codewars.com/users/willin" target="_blank" rel="noopener">willin</a>, <a href="https://www.codewars.com/users/marek_mistrzuk" target="_blank" rel="noopener">marek_mistrzuk</a></p><pre><code class="javascript">function defaultArguments(func, params) {  var names = func.names || func.toString()    .replace(/\/\/.*$|\/\*.*?\*\/|\s/gm, &#39;&#39;)    .match(/(?:[\w]+(?:,[\w]+)*)?(?=\))/m)[0].split(&#39;,&#39;);  var detour = function () {    var input = arguments;    return func.apply(this, names.map(function (val, i) {      return i &lt; input.length ? input[i] : params[names[i]];    }));  };  detour.names = names;  return detour;}</code></pre>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Details&quot;&gt;&lt;a href=&quot;#Details&quot; class=&quot;headerlink&quot; title=&quot;Details&quot;&gt;&lt;/a&gt;Details&lt;/h2&gt;&lt;p&gt;Write a function &lt;code&gt;defaultArguments&lt;/code&gt;. It takes a function as an argument, along with an object containing default values for that functionâ€™s arguments, and returns another function which defaults to the right values. &lt;/p&gt;
&lt;p&gt;You cannot assume that the functionâ€™s arguments have any particular names.&lt;/p&gt;
&lt;p&gt;You should be able to call &lt;code&gt;defaultArguments&lt;/code&gt; repeatedly to change the defaults.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;javascript&quot;&gt;function add(a,b) { return a+b;};

var add_ = defaultArguments(add,{b:9});
add_(10); // returns 19
add_(10,7); // returns 17
add_(); // returns NaN

add_ = defaultArguments(add_,{b:3, a:2});
add_(10); // returns 13 now
add_(); // returns 5

add_ = defaultArguments(add_,{c:3}); // doesn&amp;#39;t do anything, since c isn&amp;#39;t an argument
add_(10); // returns NaN
add_(10,10); // returns 20
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;HINT: This problem requires using &lt;code&gt;Fuction.prototype.toString()&lt;/code&gt; in order to extract a functionâ€™s argument list&lt;/p&gt;
    
    </summary>
    
      <category term="Coding" scheme="http://reyshawn.com/categories/Coding/"/>
    
    
      <category term="Algorithm" scheme="http://reyshawn.com/tags/Algorithm/"/>
    
      <category term="codewars" scheme="http://reyshawn.com/tags/codewars/"/>
    
      <category term="JavaScript" scheme="http://reyshawn.com/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>ES5 Generators(i) å’Œé—­åŒ… closure</title>
    <link href="http://reyshawn.com/2018/02/18/Codewars.com%20%7C%20ES5%20Generators(i)/"/>
    <id>http://reyshawn.com/2018/02/18/Codewars.com | ES5 Generators(i)/</id>
    <published>2018-02-18T06:37:13.949Z</published>
    <updated>2019-01-18T14:30:30.906Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Kata"><a href="#Kata" class="headerlink" title="Kata"></a>Kata</h2><p>Description:</p><p>This is the first part of three (<a href="http://www.codewars.com/kata/es5-generators-ii" target="_blank" rel="noopener">part2</a>, <a href="http://www.codewars.com/kata/es5-generators-iii" target="_blank" rel="noopener">part3</a>).</p><p>Generators and Iterators are new ES6 features that will allow things like this:</p><pre><code class="javascript">function* fibonacci() {    let [prev, curr] = [0, 1];    for (;;) {        [prev, curr] = [curr, prev + curr];        yield curr;    }}</code></pre><p>Using them in this way, we can do amazing things:</p><pre><code class="javascript">let seq = fibonacci();print(seq.next()); // 1print(seq.next()); // 2print(seq.next()); // 3print(seq.next()); // 5print(seq.next()); // 8</code></pre><p>This is powerful, but until a few months later, ES6 will not be born.</p><p>The goal of this kata is to implement pseudo-generators with ES5.</p><a id="more"></a><p>The first thing to do is to implement the generator function:</p><pre><code class="javascript">function generator(sequencer) {   ...}</code></pre><p><code>generator(sequencer[, arg1, arg2, â€¦])</code> receives a sequencer function to generate the sequence and returns and object with a <code>next()</code> method. When the <code>next()</code> method is invoked, the next value is generated. The method could receive as well optional arguments to be passed to the sequencer function.</p><p>This is an example of a dummy sequencer:</p><pre><code class="javascript">function dummySeq() {  return function() {    return &quot;dummy&quot;;  };}</code></pre><p>To test generator(), you could use <code>dummySeq()</code> in this way:</p><pre><code class="javascript">var seq = generator(dummySeq);seq.next(); // &#39;dummy&#39;seq.next(); // &#39;dummy&#39;seq.next(); // &#39;dummy&#39;....</code></pre><p>When youâ€™re done, you should implement the following generators (I think the functions are self explanatory):</p><pre><code class="javascript">function factorialSeq() {...} // 1, 1, 2, 6, 24, ...function fibonacciSeq() {...} // 1, 1, 2, 3, 5, 8, 13, ...function rangeSeq(start, step) {...} // rangeSeq(1, 2)  -&gt; 1, 3, 5, 7, ...function primeSeq() {...} // 2, 3, 5, 7, 11, 13, ...partialSumSeq(1, 3, 7, 2, 0) {...} // 1, 4, 11, 13, 13, end</code></pre><p>You can use any of them in the same way:</p><pre><code class="javascript">var seq = generator(factorialSeq);seq.next(); // !0 = 1seq.next(); // !1 = 1seq.next(); // !2 = 2seq.next(); // !3 = 6seq.next(); // !4 = 24...</code></pre><p>There are some sequences which are infinite and others are not. For example:</p><ul><li>primeSeq: Is infinite</li><li>partialSumSeq: Is limited to the passed values.</li></ul><p>When the sequence is done (in finite sequences), if you call seq.next() again, it should produce an error.</p><p>Good luck!</p><h2 id="Solutions"><a href="#Solutions" class="headerlink" title="Solutions"></a>Solutions</h2><p>é¢˜ç›®çš„å¤§ä½“å«ä¹‰æ˜¯æƒ³è¦é€šè¿‡ ES5 æ¥æ¨¡æ‹Ÿ ES6 ä¸­æ‰æœ‰çš„ generator ç”Ÿæˆå™¨åŠŸèƒ½ã€‚ä¸»è¦æ€è·¯å°±æ˜¯ä½¿ç”¨é—­åŒ… closure è¿™ä¸€ç‰¹æ€§ï¼š</p><pre><code class="javascript">function generator(sequencer) {    var args = Array.prototype.slice.call(arguments, 1);    return {        next: sequencer.apply(this,args)    };}function fibonacciSeq() {    var prev = 0    var current = 1    return function() {        var old = current        current = prev + current        prev = old        return prev    }}// ç›´æ¥è°ƒç”¨console.log(fibonacciSeq()())// ä½¿ç”¨ closurevar seq = fibonacciSeq()console.log(seq())</code></pre><p>å…³äº Closureï¼Œéå¸¸æ¨èé˜…è¯» Kyle Simpson å†™çš„ <em>You Donâ€™t Know JS: Scope &amp; Closures</em> ï¼Œä¸åˆ° 100 é¡µçš„å°å†Œå­ï¼Œç”±æµ…å…¥æ·±ï¼Œé€šä¿—æ˜“æ‡‚ã€‚Closure ç®€å•æ¥è®²ï¼Œå°±æ˜¯åœ¨ä¸€ä¸ªå‡½æ•°å†…éƒ¨å®šä¹‰ä¸€ä¸ªåµŒå¥—çš„å­å‡½æ•°ï¼Œå¹¶ return å®ƒï¼Œreturn è¿™ä¸ªå­å‡½æ•°ã€‚å½¢å¼å°±åƒä¸Šé¢ä»£ç ï¼Œåœ¨ <code>fibonacciSeq()</code> å‡½æ•°é‡Œ return äº†ä¸€ä¸ª anonymous functionï¼ŒåŒ¿åå‡½æ•°ã€‚è¿™æ ·åšçš„å¥½å¤„å°±æ˜¯ï¼ŒæŠŠ <code>fibonacciSeq()</code> ç§æœ‰å˜é‡ <code>prev</code>, <code>current</code> ä¿æŠ¤èµ·æ¥ï¼Œ<strong>åŒæ—¶åˆèƒ½é€šè¿‡è¿”å›çš„ anonymous function å»ä¿®æ”¹å‡½æ•°çš„ç§æœ‰å˜é‡</strong>ã€‚å¬èµ·æ¥å¾ˆç»•ã€‚å¾ˆå®ç”¨ï¼Œå› ä¸ºä¸€èˆ¬æ¥è®²ï¼Œæˆ‘ä»¬æ˜¯æ— æ³•åœ¨å‡½æ•°çš„å¤–éƒ¨å»ä¿®æ”¹ä¸€ä¸ªå‡½æ•°å†…éƒ¨çš„ç§æœ‰å˜é‡çš„ï¼Œä½† closure å´å¯ä»¥ã€‚æˆ–è€…æ¢å¥è¯ï¼Œé€šè¿‡ã€Œåœ¨å‡½æ•° A ä¸­è¿”å›ä¸€ä¸ªå­å‡½æ•°ã€è¿™æ ·çš„æ“ä½œï¼Œå¯ä»¥å»ä¿®æ”¹å‡½æ•° A çš„ç§æœ‰å˜é‡ã€‚</p><p>è¿™é‡Œå…³äº closureï¼Œä¸»è¦æƒ³æåŠå‡ ä¸ªç‚¹ï¼š</p><p>ä¸€ã€<code>fibonacciSeq()()</code> å’Œ <code>seq()</code> åŒºåˆ«</p><p>äºŒè€…å‡½æ•°çš„è°ƒç”¨å’Œæ‰§è¡Œéƒ½ä¸åŒã€‚<code>fibonacciSeq()()</code> åˆ™æ˜¯å…ˆè°ƒç”¨å‡½æ•° <code>fibonacciSeq()</code>ï¼Œè¯¥å‡½æ•°è¿”å›ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œå†ç»§ç»­è°ƒç”¨è¯¥åŒ¿åå‡½æ•°ï¼Œå¾—åˆ°åŒ¿åå‡½æ•°çš„è¿”å›å€¼ã€‚æ‰€ä»¥æ˜¯è¿ç»­è°ƒç”¨äº†ä¸¤ä¸ªå‡½æ•°ï¼Œå¤–å±‚å‡½æ•°å’Œå†…å±‚å‡½æ•°ï¼Œæ•´ä¸ª <code>fibonacciSeq()</code> å‡½æ•°ä¸­çš„è¯­å¥éƒ½è¢«æ‰§è¡Œäº†ã€‚</p><p>è€Œä½¿ç”¨ closureï¼Œé¦–å…ˆå®šä¹‰å˜é‡ <code>var seq = fibonacciSeq()</code>ï¼Œç„¶ååœ¨è°ƒç”¨ <code>seq()</code> çš„è¿‡ç¨‹ä¸­ï¼Œä»…ä»…è°ƒç”¨æ‰§è¡Œäº† <code>fibonacciSeq()</code> é‡Œå†…éƒ¨è¿”å›çš„çš„åŒ¿åå‡½æ•°ï¼Œæ¢å¥è¯è¯´ï¼Œåœ¨æ‰§è¡Œ <code>seq()</code> çš„è¿‡ç¨‹ä¸­ï¼Œ <code>fibonacciSeq()</code>  å‡½æ•°å¹¶æ²¡æœ‰è¢«è°ƒç”¨æ‰§è¡Œï¼Œæ•´ä¸ªè¿‡ç¨‹çœŸæ­£è°ƒç”¨æ‰§è¡Œçš„<strong>åªæœ‰</strong>è¢«åµŒå¥—çš„å†…å±‚å­å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¿”å›çš„åŒ¿åå‡½æ•°ï¼Œanonymous functionã€‚</p><p>è¿™ä¹ˆä¸€ä¸ªç®€å•åŒºåˆ«å°±é€ æˆäº†ï¼Œå‰è€… <code>fibonacciSeq()()</code> å³ä¾¿è°ƒç”¨æ— æ•°æ¬¡ï¼Œè¾“å‡ºç»“æœéƒ½æ˜¯ç›¸åŒçš„ï¼Œéƒ½æ˜¯ <code>1</code>ã€‚è€Œåè€…è°ƒç”¨å¤šæ¬¡ï¼Œå´èƒ½å¤Ÿå¾—åˆ° Fibonacci æ•°åˆ— <code>1,1,2,3,5â€¦</code>ã€‚åŸå› å°±åœ¨äº closureï¼Œè™½ç„¶ä»…ä»…æ‰§è¡Œäº†åŒ¿åå‡½æ•°ï¼Œä½†å› ä¸ºåŒ¿åå‡½æ•°æ˜¯ä½œä¸ºå­å‡½æ•°å­˜åœ¨äº  <code>fibonacciSeq()</code>  å‡½æ•°å†…ï¼Œæ‰€ä»¥æ ¹æ® Lexical scope çš„è§„åˆ™ï¼Œå†…å±‚å‡½æ•°æ˜¯å¯ä»¥ access åˆ°å¤–å±‚å‡½æ•°çš„å˜é‡çš„ã€‚æ‰€ä»¥åœ¨æ‰§è¡Œ <code>seq()</code> çš„è¿‡ç¨‹ä¸­ï¼Œç¨‹åºä»å†…åˆ°å¤–å¯»æ‰¾å˜é‡  <code>prev</code>, <code>current</code>ï¼Œ ä¸ä»…åœ¨ <code>fibonacciSeq()</code>  æ‰¾åˆ°äº†å®ƒçš„ç§æœ‰å˜é‡  <code>prev</code>, <code>current</code> ï¼Œè€Œä¸”è¿˜ä¿®æ”¹äº†å®ƒä»¬çš„å€¼ï¼è¢«ä¿®æ”¹äº†å€¼çš„ç§æœ‰å˜é‡ä¾æ—§ä¿æŒåœ¨åŸæ¥ä½ç½®ï¼Œå³ä»ç„¶ä½œä¸ºå‡½æ•°çš„ç§æœ‰å˜é‡å­˜åœ¨ã€‚è¿™ä¸€ç‚¹åœ¨æ–‡ç«  <a href="https://javascript.info/closure" target="_blank" rel="noopener">Closure - The Modern JavaScript Tutorial</a> ä¸­æœ‰æ¢—è¯¦ç»†çš„è§£é‡Šï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚</p><p>äºŒã€å…¶ä»–ä¸€äº›ç»†èŠ‚</p><p>åœ¨ <code>generator()</code> ä¸­ä½¿ç”¨çš„ <code>call()</code> <code>apply()</code> æ–¹æ³•ï¼Œä¸»è¦æ˜¯ä¸ºäº†å‡½æ•°ä¼ å‚ã€‚ </p><ul><li><code>Array.prototype.slice.call(arguments, 1)</code> </li></ul><p>å› ä¸º <code>arguments</code> æ˜¯ä¸€ä¸ª array-like objectï¼Œè€Œä¸æ˜¯çœŸæ­£çš„ arrayï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨ array çš„è¯¸å¤šæ–¹æ³•ï¼ŒåŒ…æ‹¬ sliceã€‚<code>call()</code> çš„ä½œç”¨å°±æ˜¯è®© <code>arguments</code> ç”¨ä¸Š slice æ–¹æ³•ã€‚åœ¨è¿™é‡Œå»æ‰äº†  <code>arguments</code> é‡Œçš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå‰©ä¸‹å…ƒç´ ä½œä¸ºä¸€ä¸ªæ–°çš„ array å­˜å‚¨åˆ° <code>args</code> ä¸­ã€‚</p><ul><li><code>sequencer.apply(this,args)</code></li></ul><p>ç»‘å®š this åˆ° <code>sequencer</code> å¹¶å°†å‚æ•° <code>args</code> ä¼ é€’åˆ°å‡½æ•°ä¸­ã€‚</p><p>å‚è€ƒï¼š</p><ul><li><a href="https://www.quora.com/What-are-the-reasons-to-use-return-function-in-JavaScript" target="_blank" rel="noopener">What are the reasons to use â€˜return functionâ€™ in JavaScript? - Quora</a></li><li><a href="https://javascript.info/closure" target="_blank" rel="noopener">Closure - The Modern JavaScript Tutorial</a> âœª</li><li>You Donâ€™t Know JS: Scope &amp; Closures - Kyle Simpson</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Kata&quot;&gt;&lt;a href=&quot;#Kata&quot; class=&quot;headerlink&quot; title=&quot;Kata&quot;&gt;&lt;/a&gt;Kata&lt;/h2&gt;&lt;p&gt;Description:&lt;/p&gt;
&lt;p&gt;This is the first part of three (&lt;a href=&quot;http://www.codewars.com/kata/es5-generators-ii&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;part2&lt;/a&gt;, &lt;a href=&quot;http://www.codewars.com/kata/es5-generators-iii&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;part3&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;Generators and Iterators are new ES6 features that will allow things like this:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;javascript&quot;&gt;function* fibonacci() {
    let [prev, curr] = [0, 1];
    for (;;) {
        [prev, curr] = [curr, prev + curr];
        yield curr;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Using them in this way, we can do amazing things:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;javascript&quot;&gt;let seq = fibonacci();
print(seq.next()); // 1
print(seq.next()); // 2
print(seq.next()); // 3
print(seq.next()); // 5
print(seq.next()); // 8
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This is powerful, but until a few months later, ES6 will not be born.&lt;/p&gt;
&lt;p&gt;The goal of this kata is to implement pseudo-generators with ES5.&lt;/p&gt;
    
    </summary>
    
      <category term="Coding" scheme="http://reyshawn.com/categories/Coding/"/>
    
    
      <category term="Algorithm" scheme="http://reyshawn.com/tags/Algorithm/"/>
    
      <category term="codewars" scheme="http://reyshawn.com/tags/codewars/"/>
    
      <category term="JavaScript" scheme="http://reyshawn.com/tags/JavaScript/"/>
    
  </entry>
  
</feed>
